<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Creating a simulated data set</title>
  <meta name="description" content="Creating a simulated data set" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Creating a simulated data set" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Creating a simulated data set" />
  
  
  

<meta name="author" content="Ryan Schneider" />


<meta name="date" content="2021-12-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Creating a simulated data set</h1>
<p class="author"><em>Ryan Schneider</em></p>
<p class="date"><em>2021-12-30</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#a-monument-to-my-madness"><span class="toc-section-number">1</span> A Monument to my Madness</a>
<ul>
<li><a href="#what-this-book-is-and-what-it-is-not"><span class="toc-section-number">1.1</span> What this book is, and what it is not</a></li>
</ul></li>
<li><a href="#introduction-r-basics"><span class="toc-section-number">2</span> Introduction: R Basics</a>
<ul>
<li><a href="#importing-data"><span class="toc-section-number">2.1</span> Importing Data</a>
<ul>
<li><a href="#spreadsheets"><span class="toc-section-number">2.1.1</span> Spreadsheets</a></li>
</ul></li>
<li><a href="#exporting-i.e.-saving-data-and-output"><span class="toc-section-number">2.2</span> Exporting (i.e., saving) Data and Output</a>
<ul>
<li><a href="#exporting-to-.csv"><span class="toc-section-number">2.2.1</span> Exporting to .CSV</a></li>
<li><a href="#export-to-.rdata-and-load-the-data-again-later"><span class="toc-section-number">2.2.2</span> Export to .RData (and load the data again later)</a></li>
<li><a href="#export-to-excel"><span class="toc-section-number">2.2.3</span> Export to Excel</a></li>
<li><a href="#accessedit-specific-cell-number-values"><span class="toc-section-number">2.2.4</span> Access/edit specific cell number values</a></li>
</ul></li>
</ul></li>
<li><a href="#wrangle-data"><span class="toc-section-number">3</span> Wrangle Data</a>
<ul>
<li><a href="#joining-or-splitting"><span class="toc-section-number">3.1</span> Joining or Splitting</a>
<ul>
<li><a href="#whole-data-sets"><span class="toc-section-number">3.1.1</span> Whole Data Sets</a></li>
<li><a href="#individual-columnsvariables"><span class="toc-section-number">3.1.2</span> Individual Columns/Variables</a></li>
</ul></li>
<li><a href="#selectingextracting-specific-variables"><span class="toc-section-number">3.2</span> Selecting/extracting specific variables</a></li>
<li><a href="#if-then-and-case-when"><span class="toc-section-number">3.3</span> If-then and Case-when</a>
<ul>
<li><a href="#if-then"><span class="toc-section-number">3.3.1</span> If-then</a></li>
<li><a href="#case-when"><span class="toc-section-number">3.3.2</span> Case-when</a></li>
</ul></li>
<li><a href="#conditional-replacement-of-values"><span class="toc-section-number">3.4</span> Conditional replacement of values</a></li>
<li><a href="#merging-variables"><span class="toc-section-number">3.5</span> Merging variables</a></li>
<li><a href="#apply-a-function-to-multiple-variables-at-once"><span class="toc-section-number">3.6</span> Apply a function to multiple variables at once</a></li>
<li><a href="#pivoting-i.e.-transposing-data"><span class="toc-section-number">3.7</span> Pivoting (i.e., transposing) data</a>
<ul>
<li><a href="#condense-multiple-rows-into-a-single-column-pivot-wide-to-long"><span class="toc-section-number">3.7.1</span> Condense multiple rows into a single column (pivot wide to long)</a></li>
</ul></li>
<li><a href="#managing-many-models"><span class="toc-section-number">3.8</span> Managing Many Models</a></li>
<li><a href="#turn-row-names-into-a-columnvariable"><span class="toc-section-number">3.9</span> Turn row names into a column/variable</a></li>
<li><a href="#how-to-editchange-column-names"><span class="toc-section-number">3.10</span> How to edit/change column names</a></li>
<li><a href="#re-order-columns-in-a-data-set"><span class="toc-section-number">3.11</span> Re-order columns in a data set</a></li>
<li><a href="#working-with-date-and-time-variables"><span class="toc-section-number">3.12</span> Working with date and time variables</a>
<ul>
<li><a href="#format-date-and-time-variables-appropriate-as-date-objects-in-r"><span class="toc-section-number">3.12.1</span> Format date-and-time variables appropriate as date objects in R</a></li>
<li><a href="#find-the-difference-between-two-datestimes"><span class="toc-section-number">3.12.2</span> Find the difference between two dates/times</a></li>
</ul></li>
<li><a href="#reverse-code-a-variable"><span class="toc-section-number">3.13</span> Reverse-code a variable</a></li>
<li><a href="#create-a-relative-ranking-among-several-variables"><span class="toc-section-number">3.14</span> Create a relative ranking among several variables</a></li>
</ul></li>
<li><a href="#clean-data"><span class="toc-section-number">4</span> Clean Data</a>
<ul>
<li><a href="#replace-a-value-with-na"><span class="toc-section-number">4.1</span> Replace a value with NA</a></li>
<li><a href="#replace-nas-with-a-value"><span class="toc-section-number">4.2</span> Replace NA’s with a value</a></li>
<li><a href="#identify-columns-or-rows-with-missing-values"><span class="toc-section-number">4.3</span> Identify columns or rows with Missing values</a></li>
<li><a href="#find-the-percentage-of-a-variable-that-is-missing"><span class="toc-section-number">4.4</span> Find the percentage of a variable that is missing</a></li>
<li><a href="#exclude-missing-values-from-analysis"><span class="toc-section-number">4.5</span> Exclude Missing values from analysis</a></li>
</ul></li>
<li><a href="#dropping-missing-values-from-the-data-set"><span class="toc-section-number">5</span> Dropping Missing values from the data set</a></li>
<li><a href="#working-with-factors"><span class="toc-section-number">6</span> Working with Factors</a>
<ul>
<li><a href="#manually-recodechange-a-factors-levels"><span class="toc-section-number">6.1</span> Manually recode/change a factor’s levels</a></li>
<li><a href="#collapse-factor-levels"><span class="toc-section-number">6.2</span> Collapse factor levels</a></li>
<li><a href="#add-levels-to-a-factor"><span class="toc-section-number">6.3</span> Add levels to a factor</a></li>
<li><a href="#drop-unused-levels"><span class="toc-section-number">6.4</span> Drop unused levels</a></li>
<li><a href="#change-the-order-of-a-factors-levels"><span class="toc-section-number">6.5</span> Change the order of a factor’s levels</a></li>
</ul></li>
<li><a href="#working-with-strings"><span class="toc-section-number">7</span> Working with Strings</a>
<ul>
<li><a href="#remove-a-pattern-from-a-string"><span class="toc-section-number">7.1</span> Remove a pattern from a string</a></li>
<li><a href="#replace-one-pattern-in-a-string-with-another"><span class="toc-section-number">7.2</span> Replace one pattern in a string with another</a></li>
<li><a href="#find-i.e.-filter-for-all-instances-of-a-string"><span class="toc-section-number">7.3</span> Find (i.e., filter for) all instances of a string</a></li>
<li><a href="#force-all-letters-to-lower-case"><span class="toc-section-number">7.4</span> Force all letters to lower case</a></li>
</ul></li>
<li><a href="#figures-and-graphs-with-the-ggplot-and-see-packages"><span class="toc-section-number">8</span> Figures and Graphs with the ggplot and see packages</a>
<ul>
<li><a href="#commands-for-ggplot-graph-types"><span class="toc-section-number">8.1</span> Commands for ggplot graph types</a></li>
<li><a href="#specific-commands-for-specific-types-of-analysis"><span class="toc-section-number">8.2</span> Specific Commands for Specific Types of Analysis</a>
<ul>
<li><a href="#lavaan-stuff"><span class="toc-section-number">8.2.1</span> lavaan stuff</a></li>
<li><a href="#bayes-stuff"><span class="toc-section-number">8.2.2</span> Bayes stuff</a></li>
<li><a href="#histograms-and-density-curves"><span class="toc-section-number">8.2.3</span> Histograms and density curves</a></li>
</ul></li>
<li><a href="#highlight-specific-points"><span class="toc-section-number">8.3</span> Highlight specific points</a></li>
<li><a href="#add-labels-to-data-points"><span class="toc-section-number">8.4</span> Add labels to data points</a></li>
<li><a href="#plotting-multiple-graphs-at-once"><span class="toc-section-number">8.5</span> Plotting multiple graphs at once</a></li>
<li><a href="#change-the-colors-bars-columns-dots-etc."><span class="toc-section-number">8.6</span> Change the colors (bars; columns; dots; etc.)</a>
<ul>
<li><a href="#fine-tuning-colors"><span class="toc-section-number">8.6.1</span> Fine-tuning colors</a></li>
<li><a href="#more-options-with-the-see-package"><span class="toc-section-number">8.6.2</span> More options with the see package</a></li>
</ul></li>
<li><a href="#other-aesthetic-mappings"><span class="toc-section-number">8.7</span> Other aesthetic mappings</a></li>
<li><a href="#adding-and-customizing-text"><span class="toc-section-number">8.8</span> Adding and Customizing Text</a>
<ul>
<li><a href="#add-a-title-axis-labels-and-captions"><span class="toc-section-number">8.8.1</span> Add a title, axis labels, and captions</a></li>
<li><a href="#center-graph-title"><span class="toc-section-number">8.8.2</span> Center graph title</a></li>
<li><a href="#use-different-fonts"><span class="toc-section-number">8.8.3</span> Use different fonts</a></li>
</ul></li>
<li><a href="#remove-gridlines"><span class="toc-section-number">8.9</span> Remove gridlines</a></li>
<li><a href="#faceting"><span class="toc-section-number">8.10</span> Faceting</a></li>
<li><a href="#log-transformations"><span class="toc-section-number">8.11</span> Log transformations</a></li>
<li><a href="#changing-the-scale-of-the-axis"><span class="toc-section-number">8.12</span> Changing the scale of the axis</a></li>
<li><a href="#add-a-regression-line"><span class="toc-section-number">8.13</span> Add a regression line</a></li>
</ul></li>
<li><a href="#making-tables-with-flextable"><span class="toc-section-number">9</span> Making Tables with flextable</a>
<ul>
<li><a href="#apa-table-components"><span class="toc-section-number">9.1</span> APA Table Components</a></li>
<li><a href="#indent-values"><span class="toc-section-number">9.2</span> Indent values</a></li>
<li><a href="#add-a-horizontal-border-aka-horizontal-spanner"><span class="toc-section-number">9.3</span> Add a Horizontal border (AKA horizontal “spanner”)</a></li>
<li><a href="#change-font-and-font-size"><span class="toc-section-number">9.4</span> Change font and font size</a></li>
<li><a href="#grouped-table"><span class="toc-section-number">9.5</span> Grouped table</a></li>
<li><a href="#complete-example"><span class="toc-section-number">9.6</span> Complete Example</a></li>
</ul></li>
<li><a href="#misc.-stuff"><span class="toc-section-number">10</span> Misc. Stuff</a>
<ul>
<li><a href="#scrape-web-pages-for-data-tables"><span class="toc-section-number">10.1</span> Scrape web pages for data tables</a></li>
<li><a href="#read-spss-files-into-r"><span class="toc-section-number">10.2</span> Read SPSS files into R</a></li>
<li><a href="#turn-numbers-into-percentages"><span class="toc-section-number">10.3</span> Turn numbers into percentages</a></li>
<li><a href="#find-all-possible-combindations-of-items-in-a-vector"><span class="toc-section-number">10.4</span> Find all possible combindations of items in a vector</a></li>
<li><a href="#download-files-from-the-internet"><span class="toc-section-number">10.5</span> Download files from the internet</a></li>
<li><a href="#print-multiple-things-in-one-statement"><span class="toc-section-number">10.6</span> Print multiple things in one statement</a></li>
</ul></li>
<li><a href="#intermediate-r-functions-loops-and-iterative-programming"><span class="toc-section-number">11</span> Intermediate R: Functions, Loops, and Iterative Programming</a>
<ul>
<li><a href="#functions"><span class="toc-section-number">11.1</span> Functions</a></li>
<li><a href="#for-loops"><span class="toc-section-number">11.2</span> For-loops</a></li>
</ul></li>
<li><a href="#purrr-and-iterative-functions"><span class="toc-section-number">12</span> purrr and Iterative Functions</a>
<ul>
<li><a href="#reproducible-example"><span class="toc-section-number">12.1</span> Reproducible example</a></li>
<li><a href="#non-reproducible-example-juvenile-life-without-parole-study"><span class="toc-section-number">12.2</span> Non-reproducible example (Juvenile Life Without Parole study)</a></li>
<li><a href="#example-3-readimport-several-files-at-once-with-map"><span class="toc-section-number">12.3</span> Example 3: Read/Import several files at once with <code>map()</code></a></li>
<li><a href="#other-purrr-commands"><span class="toc-section-number">12.4</span> Other purrr commands</a>
<ul>
<li><a href="#the-walk-and-walk2-commands"><span class="toc-section-number">12.4.1</span> The <code>walk</code> and <code>walk2</code> commands</a></li>
<li><a href="#map2-and-walk2"><span class="toc-section-number">12.4.2</span> <code>map2</code> (and <code>walk2</code>)</a></li>
<li><a href="#pmap-for-when-you-have-a-bunch-of-shit"><span class="toc-section-number">12.4.3</span> <code>pmap</code> for when you have a bunch of shit</a></li>
</ul></li>
</ul></li>
<li><a href="#intro-to-r-markdown"><span class="toc-section-number">13</span> Intro to R Markdown</a>
<ul>
<li><a href="#important-code-chunk-options"><span class="toc-section-number">13.1</span> Important code chunk options</a></li>
<li><a href="#writing-math-equations-and-symbols"><span class="toc-section-number">13.2</span> Writing math equations and symbols</a>
<ul>
<li><a href="#greek-symbols"><span class="toc-section-number">13.2.1</span> Greek symbols</a></li>
<li><a href="#math-notation"><span class="toc-section-number">13.2.2</span> Math notation</a></li>
<li><a href="#statistics-notation"><span class="toc-section-number">13.2.3</span> Statistics notation</a></li>
<li><a href="#writing-in-line-code"><span class="toc-section-number">13.2.4</span> Writing in-line code</a></li>
</ul></li>
<li><a href="#including-graphicsinserting-pictures"><span class="toc-section-number">13.3</span> Including graphics/inserting pictures</a></li>
<li><a href="#footnotes"><span class="toc-section-number">13.4</span> Footnotes</a></li>
<li><a href="#change-the-color-of-your-text"><span class="toc-section-number">13.5</span> Change the color of your text</a></li>
</ul></li>
<li><a href="#statistics-and-psych-specific-stuff"><span class="toc-section-number">14</span> Statistics and Psych-specific Stuff</a>
<ul>
<li><a href="#create-or-sample-from-a-distribution"><span class="toc-section-number">14.1</span> Create or sample from a distribution</a></li>
<li><a href="#find-cohens-kappa-interrater-reliability"><span class="toc-section-number">14.2</span> Find Cohen’s Kappa (Interrater reliability)</a></li>
<li><a href="#statistical-tests-and-modeling-with-easystats"><span class="toc-section-number">14.3</span> Statistical tests and modeling with <code>easystats</code></a>
<ul>
<li><a href="#getting-parameter-estimates-from-model-objects"><span class="toc-section-number">14.3.1</span> Getting parameter estimates from model objects</a></li>
<li><a href="#getting-model-information-and-performance-metrics"><span class="toc-section-number">14.3.2</span> Getting model information and performance metrics</a></li>
<li><a href="#effect-size-info-with-effectsize"><span class="toc-section-number">14.3.3</span> Effect size info with <code>effectsize</code></a></li>
<li><a href="#quick-detailed-and-automated-reporting-with-report"><span class="toc-section-number">14.3.4</span> Quick, detailed, and automated reporting with <code>report</code></a></li>
<li><a href="#running-correlations-with-correlation"><span class="toc-section-number">14.3.5</span> Running correlations with <code>correlation</code></a></li>
</ul></li>
</ul></li>
<li><a href="#coding-tips-and-tricks"><span class="toc-section-number">15</span> Coding Tips and Tricks</a>
<ul>
<li><a href="#grammar-stuff-in-base-r"><span class="toc-section-number">15.1</span> Grammar stuff in base R</a>
<ul>
<li><a href="#regex-expressions-and-symbols"><span class="toc-section-number">15.1.1</span> Regex expressions and symbols</a></li>
<li><a href="#the-new-pipe-base-r"><span class="toc-section-number">15.1.2</span> The new pipe (Base R)</a></li>
</ul></li>
<li><a href="#tidyverse-stuff"><span class="toc-section-number">15.2</span> Tidyverse stuff</a>
<ul>
<li><a href="#sometimes-when-making-a-function-you-need-to-use-the-colon-equals-operator-rather-than-just-the-normal---or-assignment-operators"><span class="toc-section-number">15.2.1</span> Sometimes when making a function you need to use the colon-equals operator, rather than just the normal &lt;- or = assignment operators</a></li>
</ul></li>
<li><a href="#function-related-stuff"><span class="toc-section-number">15.3</span> Function-related stuff</a>
<ul>
<li><a href="#user-supplied-expressions-or-named-columns-in-functions"><span class="toc-section-number">15.3.1</span> User-supplied expressions or named columns in functions</a></li>
<li><a href="#when-a-command-requires-a-named-column-or-data-set-but-youve-already-supplied-it-and-its-required-a-second-time"><span class="toc-section-number">15.3.2</span> When a command requires a named column or data set, but you’ve already supplied it and it’s required a second time</a></li>
<li><a href="#formulas-within-functions"><span class="toc-section-number">15.3.3</span> Formulas within functions</a></li>
</ul></li>
<li><a href="#creating-a-package"><span class="toc-section-number">15.4</span> Creating a package</a>
<ul>
<li><a href="#documenting-pacakge-meta-data"><span class="toc-section-number">15.4.1</span> Documenting pacakge meta-data</a></li>
<li><a href="#connecting-to-other-packages"><span class="toc-section-number">15.4.2</span> Connecting to other packages</a></li>
<li><a href="#linking-git-and-github"><span class="toc-section-number">15.4.3</span> Linking Git and Github</a></li>
</ul></li>
<li><a href="#creating-a-bookdown"><span class="toc-section-number">15.5</span> Creating a bookdown</a>
<ul>
<li><a href="#rendering-the-book-once-its-done"><span class="toc-section-number">15.5.1</span> Rendering the book once it’s done</a></li>
</ul></li>
</ul></li>
<li><a href="#creating-a-simulated-data-set"><span class="toc-section-number">16</span> Creating a simulated data set</a>
<ul>
<li><a href="#part-1-independent-samples-from-a-normal-distribution"><span class="toc-section-number">16.1</span> Part 1: Independent samples from a normal distribution</a></li>
<li><a href="#part-2-creating-data-sets-with-quantitative-and-categorical-variables"><span class="toc-section-number">16.2</span> Part 2: Creating data sets with quantitative and categorical variables</a>
<ul>
<li><a href="#a.-data-with-no-difference-among-groups"><span class="toc-section-number">16.2.1</span> 2.a. DATA WITH <strong>NO DIFFERENCE</strong> AMONG GROUPS</a></li>
<li><a href="#b.-data-with-a-difference-among-groups"><span class="toc-section-number">16.2.2</span> 2.b. Data <strong>WITH A DIFFERENCE</strong> among groups</a></li>
<li><a href="#c.-data-with-multiple-quantitative-variables-with-groups"><span class="toc-section-number">16.2.3</span> 2.c. Data with <strong>MULTIPLE QUANTITATIVE VARIABLES</strong> with groups</a></li>
</ul></li>
<li><a href="#part-3-repeatedly-simulate-samples-with-replicate"><span class="toc-section-number">16.3</span> Part 3: Repeatedly simulate samples with replicate()</a></li>
<li><a href="#part-4-repeatedly-making-whole-data-sets"><span class="toc-section-number">16.4</span> Part 4: repeatedly making whole data sets</a></li>
<li><a href="#part-5-using-purrr"><span class="toc-section-number">16.5</span> Part 5: Using purrr</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating a simulated data set</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="a-monument-to-my-madness" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> A Monument to my Madness</h1>
<p>This book contains all my personal coding notes from the last two years. Why am I doing this? Probably because I’m a glutton for punishment, and I’d rather procrastinate than write my dissertation proposal.
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
<div id="what-this-book-is-and-what-it-is-not" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> What this book is, and what it is not</h2>
<p>You know those absolutely amazing, comprehensive guides where you can learn everything you need to know about R? This is is not one of those guides.</p>
<p>This book is designed as a <strong><em>quick reference guide</em></strong> for many of the most common things you’ll need to do in everyday data analysis and research. Think of it like a coding <em>dictionary</em>, as opposed to a manual or comprehensive text.</p>
<p><strong>If you want (or need) to learn R in-depth and/or from the ground up (i.e., you’re a novice user)</strong>, then you should go read <a href="https://r4ds.had.co.nz/">Hadley Wickham’s book</a> and <a href="https://www.tidyverse.org/packages/">the tidyverse websites</a>. Also, <a href="https://oliviergimenez.github.io/intro_tidyverse/#1">these slides</a> might be a good high-level overview if you’ve never used the tidyverse before.</p>
<p>That said, if you’re already familiar with R and the tidyverse and just need a quick reference for <em>“what command do I need to accomplish XYZ”</em>, you’ve come to the right place.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="introduction-r-basics" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Introduction: R Basics</h1>
<p>For the love of God before you do anything, familiarize yourself with R Projects and the <code>here</code> package. These make R so much more user friendly and less of a nightmare. If you need an overview, go here: <a href="http://jenrichmond.rbind.io/post/how-to-use-the-here-package/" class="uri">http://jenrichmond.rbind.io/post/how-to-use-the-here-package/</a></p>
<p>Now lets get stuck in.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="importing-data" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Importing Data</h2>
<div id="spreadsheets" class="section level3" number="2.1.1">
<h3 number="2.1.1"><span class="header-section-number">2.1.1</span> Spreadsheets</h3>
<p>See <a href="https://nacnudus.github.io/spreadsheet-munging-strategies/index.html" class="uri">https://nacnudus.github.io/spreadsheet-munging-strategies/index.html</a> for more detailed and in-depth tutorials (if you need that kind of thing)</p>
</div>
</div>
<div id="exporting-i.e.-saving-data-and-output" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Exporting (i.e., saving) Data and Output</h2>
<div id="exporting-to-.csv" class="section level3" number="2.2.1">
<h3 number="2.2.1"><span class="header-section-number">2.2.1</span> Exporting to .CSV</h3>
<p>Generally speaking, unless you have a specific reason to, don’t. But if you must: <code>write_csv()</code></p>
</div>
<div id="export-to-.rdata-and-load-the-data-again-later" class="section level3" number="2.2.2">
<h3 number="2.2.2"><span class="header-section-number">2.2.2</span> Export to .RData (and load the data again later)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(obj_name, <span class="at">file=</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;subfolder&quot;</span>, <span class="st">&quot;save_file_name&quot;</span>), <span class="at">compress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;folder&quot;</span>, <span class="st">&quot;save_name.RData&quot;</span>))</span></code></pre></div>
</div>
<div id="export-to-excel" class="section level3" number="2.2.3">
<h3 number="2.2.3"><span class="header-section-number">2.2.3</span> Export to Excel</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Method 1: If you only want to export 1 thing, and/or only need output document</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#write as object, with no formatting:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.xlsx</span>(objectname,<span class="at">file =</span> <span class="st">&quot;filenamehere.xlsx&quot;</span>,<span class="at">colnames=</span><span class="cn">TRUE</span>, <span class="at">borders=</span><span class="st">&quot;columns&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#write as table:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.xlsx</span>(objectname,<span class="st">&quot;filename.xlsx&quot;</span>,<span class="at">asTable =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Method 2: If you want to do the above, but add multiple objects or tables to one workbook/file:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## first Create Workbook object</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  wb <span class="ot">&lt;-</span> <span class="fu">createWorkbook</span>(<span class="st">&quot;AuthorName&quot;</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#then add worksheets (as many as desired)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addWorksheet</span>(wb, <span class="st">&quot;worksheetnamehere&quot;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#then write the object to the worksheet  </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="st">&quot;test&quot;</span>, nameofobjectordataframe, <span class="at">startCol =</span> <span class="dv">2</span>, <span class="at">startRow =</span> <span class="dv">3</span>, <span class="at">rowNames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#save excel file</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWorkbook</span>(wb, <span class="st">&quot;filenamehere.xlsx&quot;</span>, <span class="at">overwrite =</span><span class="cn">TRUE</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Method 3: exact same as method 2, but creating a more fancy tables</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">createWorkbook</span>(<span class="st">&quot;Ryan&quot;</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">&quot;worksheetnamehere&quot;</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">writeDataTable</span>(wb, sheetName, objectName, <span class="at">startCol =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">1</span>, <span class="at">colNames =</span> <span class="cn">TRUE</span>, <span class="at">rowNames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">tableStyle=</span><span class="st">&quot;TableStyleLight2&quot;</span>,<span class="at">tableName=</span><span class="cn">NULL</span>, <span class="at">headerStyle =</span> <span class="cn">NULL</span>,<span class="at">withFilter=</span><span class="cn">FALSE</span>,<span class="at">keepNA=</span><span class="cn">TRUE</span>,<span class="at">sep=</span><span class="st">&quot;, &quot;</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">stack =</span> <span class="cn">FALSE</span>, <span class="at">firstColumn =</span> <span class="cn">FALSE</span>, <span class="at">lastColumn =</span> <span class="cn">FALSE</span>,<span class="at">bandedRows =</span> <span class="cn">TRUE</span>,<span class="at">bandedCols =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWorkbook</span>(wb, <span class="st">&quot;filenamehere.xlsx&quot;</span>, <span class="at">overwrite =</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="accessedit-specific-cell-number-values" class="section level3" number="2.2.4">
<h3 number="2.2.4"><span class="header-section-number">2.2.4</span> Access/edit specific cell number values</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>rainbow<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>Color,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;red&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;black&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;green&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>rainbow<span class="sc">$</span>Color[<span class="dv">3</span>] <span class="co"># access, but can&#39;t overwrite this way</span></span></code></pre></div>
<pre><code>## [1] &quot;black&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rainbow[<span class="dv">3</span>,<span class="st">&quot;Color&quot;</span>] <span class="co"># access and can overwrite</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   Color
##   &lt;chr&gt;
## 1 black</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rainbow[<span class="dv">3</span>, <span class="st">&quot;Color&quot;</span>]<span class="ot">=</span> <span class="st">&quot;yellow&quot;</span> <span class="co"># save this value to row 3 in column &quot;Color&quot;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>rainbow</span></code></pre></div>
<pre><code>## # A tibble: 6 x 1
##   Color 
##   &lt;chr&gt; 
## 1 red   
## 2 orange
## 3 yellow
## 4 green 
## 5 blue  
## 6 purple</code></pre>
<!--chapter:end:02-basics.Rmd-->
</div>
</div>
</div>
<div id="wrangle-data" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Wrangle Data</h1>
<p>This chapter contains useful tips on wrangling (i.e., manipulating) data. If you need to know to do to things like create new variables, split one variable into multiple variables, pivot a data set from wide to long, etc., look no further.</p>
<p>If you want a pretty good intro tutorial to the <code>dplyr</code> package, click <a href="https://www-r--bloggers-com.cdn.ampproject.org/v/s/www.r-bloggers.com/2021/01/how-to-analyze-data-with-r-a-complete-beginner-guide-to-dplyr/amp/?amp_js_v=a6&amp;gsa=1&amp;usqp=mq331AQFKAGwASA%3D#csi=0&amp;referrer=https%3A%2F%2Fwww.google.com&amp;tf=From%20%251%24s&amp;ampshare=https%3A%2F%2Fwww.r-bloggers.com%2F2021%2F01%2Fhow-to-analyze-data-with-r-a-complete-beginner-guide-to-dplyr%2F">here</a></p>
<div id="joining-or-splitting" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Joining or Splitting</h2>
<p>Joining and splitting data is pretty straightforward….</p>
<div id="whole-data-sets" class="section level3" number="3.1.1">
<h3 number="3.1.1"><span class="header-section-number">3.1.1</span> Whole Data Sets</h3>
<p>The code below is from <a href="https://www.youtube.com/watch?v=SCdmyyoudb8&amp;t=23s">this excellent tutorial</a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2018</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">customer_id=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">product=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;toaster&#39;</span>,<span class="st">&#39;TV&#39;</span>,<span class="st">&#39;Dishwasher&#39;</span>),<span class="dv">10</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">customer_id=</span><span class="fu">c</span>(<span class="fu">sample</span>(df1<span class="sc">$</span>customer_id, <span class="dv">5</span>)),<span class="at">state=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;New York&#39;</span>,<span class="st">&#39;California&#39;</span>),<span class="dv">5</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>df1<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(df1)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(df2)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 =left table</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># df2= right table</span></span></code></pre></div>
<p>Inner join - retains only rows with values that appear in both tables, and matches by keys.</p>
<p><em>If you’re joining two Qualtrics surveys together, this is most likely the one you want to use (e.g. matching by participant name, and only keeping rows in the joined data set for participants that have responses logged in both survey 1 and survey 2</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(df2,<span class="at">by=</span><span class="st">&#39;customer_id&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   customer_id product    state   
##         &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;   
## 1           1 Dishwasher New York
## 2           3 Dishwasher New York
## 3           6 toaster    New York
## 4           8 Dishwasher New York
## 5           9 Dishwasher New York</code></pre>
<p>Left join - returns everything in the left, and rows with matching keys in the right</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2,<span class="at">by=</span><span class="st">&#39;customer_id&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    customer_id product    state   
##          &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;   
##  1           1 Dishwasher New York
##  2           2 Dishwasher &lt;NA&gt;    
##  3           3 Dishwasher New York
##  4           4 toaster    &lt;NA&gt;    
##  5           5 TV         &lt;NA&gt;    
##  6           6 toaster    New York
##  7           7 toaster    &lt;NA&gt;    
##  8           8 Dishwasher New York
##  9           9 Dishwasher New York
## 10          10 TV         &lt;NA&gt;</code></pre>
<p>Right join - returns everything in the right, and rows with matching keys in the left</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(df2,<span class="at">by=</span><span class="st">&#39;customer_id&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   customer_id product    state   
##         &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;   
## 1           1 Dishwasher New York
## 2           3 Dishwasher New York
## 3           6 toaster    New York
## 4           8 Dishwasher New York
## 5           9 Dishwasher New York</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note: example if the customer id column was named something different in the second df</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#df1 %&gt;% left_join(df2,by=c(&#39;customer_id&#39;=&#39;name2&#39;))</span></span></code></pre></div>
<p>Full join - retain all rows from both tables, and join matching keys in both right and left</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(df2,<span class="at">by=</span><span class="st">&#39;customer_id&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    customer_id product    state   
##          &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;   
##  1           1 Dishwasher New York
##  2           2 Dishwasher &lt;NA&gt;    
##  3           3 Dishwasher New York
##  4           4 toaster    &lt;NA&gt;    
##  5           5 TV         &lt;NA&gt;    
##  6           6 toaster    New York
##  7           7 toaster    &lt;NA&gt;    
##  8           8 Dishwasher New York
##  9           9 Dishwasher New York
## 10          10 TV         &lt;NA&gt;</code></pre>
<p>Anti join - returns all rows in the left that do not have matching keys in the right</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">anti_join</span>(df2,<span class="at">by=</span><span class="st">&#39;customer_id&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   customer_id product   
##         &lt;int&gt; &lt;chr&gt;     
## 1           2 Dishwasher
## 2           4 toaster   
## 3           5 TV        
## 4           7 toaster   
## 5          10 TV</code></pre>
</div>
<div id="individual-columnsvariables" class="section level3" number="3.1.2">
<h3 number="3.1.2"><span class="header-section-number">3.1.2</span> Individual Columns/Variables</h3>
<p>Splitting or joining columns is much easier than doing it to whole data sets. You can use <code>dplyr::separate()</code> to accomplish the former, and <code>dplyr::unite()</code> for the latter.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;hello&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;hello&quot;</code></pre>
</div>
</div>
<div id="selectingextracting-specific-variables" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Selecting/extracting specific variables</h2>
<p>Sometimes when working with a data set, you want to work with a few <em>specific</em> variables. For instance, maybe you want to view a graph of only reverse-coded variables (which start with the prefix “r”); or maybe you want to create a subset of your data that has a few specific variables removed. For this you can use <code>dplyr::select()</code> and its associated helper commands</p>
<p><code>select()</code> can be thought of as “extract”; it tells R to identify and “extract” a specific variable (or variables)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cars<span class="ot">=</span>mtcars</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># select one column</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(mpg)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># select multiple columns, if they are all next to one another</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(mpg<span class="sc">:</span>hp)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># select multiple columns by name (when not next to one another) by defining them in a vector</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(mpg, hp, wt))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># select only variables that start with a certain prefix/character/pattern/etc.</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;d&quot;</span>))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ...or columns that end with a certain prefix/etc.</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;t&quot;</span>))</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ...or contains a certain pattern or string</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;se&quot;</span>))</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># select ALL OF the variables in a data set that match those of a pre-defined vector</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># first define the names in a vector</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  vars<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;drat&quot;</span>, <span class="st">&quot;gear&quot;</span>, <span class="st">&quot;carb&quot;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#now use helper</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(vars))</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># select ANY OF the variables in a pre-defined vector</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  vars_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>, <span class="st">&quot;drat&quot;</span>, <span class="st">&quot;watermelon&quot;</span>, <span class="st">&quot;grilled_cheese&quot;</span>) <span class="co"># only the first two will be in the data</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">any_of</span>(vars_2)) <span class="co"># only (and all of) the variables actually PRESENT in the data are pulled</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># select only variables of a certain class or type</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  cars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.character))</span></code></pre></div>
<p>Other examples can be seen on <a href="https://tidyselect.r-lib.org/reference/language.html">THIS LINK</a> for a simple but detailed guide.</p>
</div>
<div id="if-then-and-case-when" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> If-then and Case-when</h2>
<div id="if-then" class="section level3" number="3.3.1">
<h3 number="3.3.1"><span class="header-section-number">3.3.1</span> If-then</h3>
<p>The premise of an if/then or if/else statement is simple: “If condition 1 is satisfied, perform x operation; if not, then do y”</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">power_level=</span><span class="fu">ifelse</span>(mtcars<span class="sc">$</span>hp<span class="sc">&lt;</span><span class="dv">350</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb power_level
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4         Low
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4         Low
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1         Low
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1         Low
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2         Low
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1         Low</code></pre>
<p>This line of code effectively says: if the length in Sepal.Length is &gt;5, set new variable = to “short”; else, set it to “long”</p>
</div>
<div id="case-when" class="section level3" number="3.3.2">
<h3 number="3.3.2"><span class="header-section-number">3.3.2</span> Case-when</h3>
<p>When you have 3+ conditions, it’s easier to use case-when. This is a more simple and straightforward approach than nesting multiple if-else commands</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>My_vector<span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    Condition1 <span class="sc">~</span> value1,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    Condition2 <span class="sc">~</span> value2,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    Condition3 <span class="sc">~</span> value3</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> valueForEverythingElse <span class="co">#catch all for things that don&#39;t meet the above conditions</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>Example:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">size=</span> <span class="fu">case_when</span>(cyl<span class="sc">==</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;small&quot;</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                                  cyl<span class="sc">==</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;medium&quot;</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                                  cyl<span class="sc">==</span><span class="dv">8</span> <span class="sc">~</span> <span class="st">&quot;large&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(cyl,size)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                   cyl   size
## Mazda RX4           6 medium
## Mazda RX4 Wag       6 medium
## Datsun 710          4  small
## Hornet 4 Drive      6 medium
## Hornet Sportabout   8  large
## Valiant             6 medium</code></pre>
</div>
</div>
<div id="conditional-replacement-of-values" class="section level2" number="3.4">
<h2 number="3.4"><span class="header-section-number">3.4</span> Conditional replacement of values</h2>
<p>The following code is useful if you want to replace a value in one column, and the replacement is conditional upon the value in another column.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(displ, cty, hwy),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">case_when</span>(cyl <span class="sc">==</span> 4L <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x))))</span></code></pre></div>
<pre><code>## # A tibble: 234 x 11
##    manufacturer model      displ  year   cyl trans      drv     cty   hwy fl    class  
##    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
##  1 audi         a4          NA    1999     4 auto(l5)   f        NA    NA p     compact
##  2 audi         a4          NA    1999     4 manual(m5) f        NA    NA p     compact
##  3 audi         a4          NA    2008     4 manual(m6) f        NA    NA p     compact
##  4 audi         a4          NA    2008     4 auto(av)   f        NA    NA p     compact
##  5 audi         a4           2.8  1999     6 auto(l5)   f        16    26 p     compact
##  6 audi         a4           2.8  1999     6 manual(m5) f        18    26 p     compact
##  7 audi         a4           3.1  2008     6 auto(av)   f        18    27 p     compact
##  8 audi         a4 quattro  NA    1999     4 manual(m5) 4        NA    NA p     compact
##  9 audi         a4 quattro  NA    1999     4 auto(l5)   4        NA    NA p     compact
## 10 audi         a4 quattro  NA    2008     4 manual(m6) 4        NA    NA p     compact
## # ... with 224 more rows</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>test <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(rank),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(participant_score) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x))))</span></code></pre></div>
</div>
<div id="merging-variables" class="section level2" number="3.5">
<h2 number="3.5"><span class="header-section-number">3.5</span> Merging variables</h2>
<p>Sometimes you’ll have multiple variables and you want to collapse them into a single variable. The <code>pmin()</code> command is useful for this.</p>
<pre class="{r3.14}"><code>example_data=tribble(~A,~B,~C,
                     1,NA,NA,
                     2,NA,NA,
                     3,NA,NA,
                     NA,4,NA,
                     NA,5,NA,
                     NA,6,NA,
                     NA,NA,7,
                     NA,NA,8,
                     NA,NA,9)

example_data %&gt;%
  mutate(accept_reject = 
           pmin(A,B,C,na.rm = TRUE))</code></pre>
</div>
<div id="apply-a-function-to-multiple-variables-at-once" class="section level2" number="3.6">
<h2 number="3.6"><span class="header-section-number">3.6</span> Apply a function to multiple variables at once</h2>
<p>You can either specify each column individually, like above, or tell R to identify columns for you based on their type or their name. This requires adding in one additional verb–either contains() or where() depending on what you want to do.</p>
<p>Two simple examples:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># turn multiple variables into factors</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>ex_data<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>color, <span class="sc">~</span>car,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;red&quot;</span>, <span class="st">&quot;corvette&quot;</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;chevelle&quot;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;green&quot;</span>, <span class="st">&quot;camaro&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;red&quot;</span>, <span class="st">&quot;corvette&quot;</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;green&quot;</span>, <span class="st">&quot;chevelle&quot;</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;gto&quot;</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(ex_data)</span></code></pre></div>
<pre><code>## Rows: 6
## Columns: 2
## $ color &lt;chr&gt; &quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;red&quot;, &quot;green&quot;, &quot;yellow&quot;
## $ car   &lt;chr&gt; &quot;corvette&quot;, &quot;chevelle&quot;, &quot;camaro&quot;, &quot;corvette&quot;, &quot;chevelle&quot;, &quot;gto&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ex_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(color, car),factor))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   color  car     
##   &lt;fct&gt;  &lt;fct&gt;   
## 1 red    corvette
## 2 blue   chevelle
## 3 green  camaro  
## 4 red    corvette
## 5 green  chevelle
## 6 yellow gto</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># round multiple columns to 1 decimal place</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(disp<span class="sc">:</span>qsec),round,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat  wt qsec vs am gear carb
## Mazda RX4         21.0   6  160 110  3.9 2.6 16.5  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110  3.9 2.9 17.0  0  1    4    4
## Datsun 710        22.8   4  108  93  3.9 2.3 18.6  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110  3.1 3.2 19.4  1  0    3    1
## Hornet Sportabout 18.7   8  360 175  3.1 3.4 17.0  0  0    3    2
## Valiant           18.1   6  225 105  2.8 3.5 20.2  1  0    3    1</code></pre>
</div>
<div id="pivoting-i.e.-transposing-data" class="section level2" number="3.7">
<h2 number="3.7"><span class="header-section-number">3.7</span> Pivoting (i.e., transposing) data</h2>
<div id="condense-multiple-rows-into-a-single-column-pivot-wide-to-long" class="section level3" number="3.7.1">
<h3 number="3.7.1"><span class="header-section-number">3.7.1</span> Condense multiple rows into a single column (pivot wide to long)</h3>
<p>Rearranging data like this can make it easier to work with and analyze. Example below from my gradebook for stats (exported from Canvas), with fake names.</p>
<p>The command structure is as follows:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_longer</span>( <span class="co"># Transpose LENGTHWISE by....</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(), <span class="co"># Taking ALL variable names...</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to=</span><span class="st">&quot;variable&quot;</span>, <span class="co"># ...and dumping them into this new variable/column</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to=</span><span class="st">&quot;missing_count&quot;</span>) <span class="co">#...and placing their values in this other new column</span></span></code></pre></div>
<p><strong>NOTE!!!</strong> Pivoting data from wide to long like this expands the number of rows to make a matrix so that (for example, each student now has as a row for each assignment). Therefore, you can only pivot longways (or wide) <strong>ONCE</strong>, otherwise you will make duplicates.</p>
<p><em>If you need to pivot multiple columns, just include all of the columns in one single pivot; do not use two separate, back to back pivot commands.</em></p>
<p>Example:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gradebook<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Student, <span class="sc">~</span>Homework<span class="fl">.1</span>, <span class="sc">~</span>Homework<span class="fl">.2</span>, <span class="sc">~</span>Homework<span class="fl">.3</span>, <span class="sc">~</span>Homework<span class="fl">.4</span>, <span class="sc">~</span>Homework<span class="fl">.5</span>, <span class="sc">~</span>Quiz<span class="fl">.1</span>, <span class="sc">~</span>Quiz<span class="fl">.2</span>, <span class="sc">~</span>Quiz<span class="fl">.3</span>, <span class="sc">~</span>Quiz<span class="fl">.4</span>, <span class="sc">~</span>Final,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;Bob&quot;</span>,         19L,          0L,          <span class="dv">13</span>,          <span class="dv">16</span>,          0L,      <span class="dv">21</span>,      7L,      <span class="dv">15</span>,    <span class="fl">17.5</span>,     <span class="dv">33</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Jane&quot;</span>,         17L,         19L,          <span class="dv">16</span>,        <span class="fl">16.5</span>,         25L,    <span class="fl">21.5</span>,     19L,   <span class="fl">14.75</span>,     <span class="fl">9.5</span>,   <span class="fl">39.5</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;John&quot;</span>,         19L,         19L,        <span class="fl">14.5</span>,        <span class="fl">19.5</span>,         25L,      <span class="dv">21</span>,     21L,    <span class="fl">18.5</span>,      <span class="dv">17</span>,   <span class="fl">46.5</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gradebook)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 11
##   Student Homework.1 Homework.2 Homework.3 Homework.4 Homework.5 Quiz.1 Quiz.2 Quiz.3 Quiz.4 Final
##   &lt;chr&gt;        &lt;int&gt;      &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;int&gt;  &lt;dbl&gt;  &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 Bob             19          0       13         16            0   21        7   15     17.5  33  
## 2 Jane            17         19       16         16.5         25   21.5     19   14.8    9.5  39.5
## 3 John            19         19       14.5       19.5         25   21       21   18.5   17    46.5</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gradebook<span class="ot">=</span>gradebook <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pivot_longer</span>( <span class="co"># Transpose lengthwise by:</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> Homework<span class="fl">.1</span><span class="sc">:</span>Final, <span class="co"># Taking these variables</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to=</span><span class="st">&quot;Assignment&quot;</span>, <span class="co"># ...and dumping them into this new variable, storing them lengthwise</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to=</span><span class="st">&quot;Points&quot;</span>) <span class="co">#...then place their values in this new column</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>gradebook <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   Student Assignment Points
##   &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;
## 1 Bob     Homework.1     19
## 2 Bob     Homework.2      0
## 3 Bob     Homework.3     13
## 4 Bob     Homework.4     16
## 5 Bob     Homework.5      0
## 6 Bob     Quiz.1         21</code></pre>
</div>
</div>
<div id="managing-many-models" class="section level2" number="3.8">
<h2 number="3.8"><span class="header-section-number">3.8</span> Managing Many Models</h2>
<p>Imagine the concept of Russian Dolls, applied to data sets. You can manage data sets more effectively my collapsing them into a single tiny, mini data frame, and stuffing that inside of another one.</p>
<p>This is done via “nesting”…</p>
<p>Effectively, you smush/collapse everything down so it fits inside one column. You can unnest to expand this data back out later when you need it, and keep it collapsed when you don’t. Code works like this:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>by_country<span class="ot">=</span>gapminder<span class="sc">::</span>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent,country) <span class="sc">%&gt;%</span> <span class="co"># indicate the variables to keep at the top level</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="co"># smush the rest into a list-column</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>country_model<span class="ot">=</span><span class="cf">function</span>(df){</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(lifExp<span class="sc">~</span>year1950,<span class="at">data =</span> df)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform a list of models into a df</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span>by_country <span class="sc">%&gt;%</span> </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mod=</span><span class="fu">map</span>(data,country_model))</span></code></pre></div>
<ul>
<li>You can store anything in a data frame. You can keep the df connected to the model, which makes it very easy to manage a whole slew of related models</li>
<li>You can use functional programming (i.e., iterative functions) to map functions or combinations of functions in new ways.</li>
<li>Converting data into tidy data sets gives you a whole new way (and easier way) to manage lots of information</li>
</ul>
<p>Below is the full script I copied from Hadley Wickham’s lecture, which you can watch <a href="https://www.youtube.com/watch?v=rz3_FDVt9eg">here</a></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyverse,gapminder)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### Workflow for managing many models in R ####</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Nest data with {tidyr}</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use {purrr} to map a modeling function</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Use {broom} to inspect your tidy data</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>gapminder<span class="ot">=</span>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year1950=</span> year<span class="dv">-1950</span>) <span class="co">#the number of years it&#39;s been since 1950</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------------------</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 1. Nest the data. ####</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A nested data frame has one column per country. You&#39;re essentially </span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a Russian doll; a data frame inside of a larger data frame.</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>by_country<span class="ot">=</span>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent,country) <span class="sc">%&gt;%</span> <span class="co"># variables to keep at the top level</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="co"># smush everything else into a df, and store this mini-df in its own column</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># with this, you can have an entire table per row; a whole data frame for each country</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Essentially condensing a list into a table</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>by_country<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------------------</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 2. Use purrr to map stuff. ####</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 12:50</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>country_model<span class="ot">=</span><span class="cf">function</span>(df){</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year1950, <span class="at">data =</span> df)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span> by_country <span class="sc">%&gt;%</span> </span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod=</span><span class="fu">map</span>(data,country_model)</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent,country) <span class="sc">%&gt;%</span> </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod=</span> data <span class="sc">%&gt;%</span> <span class="fu">map</span>(country_model)</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 27:11</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------------------</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="do">##### Step 3. ####</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates another nested df inside of your main data frame that has the summary stats of each model</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span>models <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy=</span><span class="fu">map</span>(mod, broom<span class="sc">::</span>tidy), <span class="co"># tidy() gives model estimates</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">glance=</span><span class="fu">map</span>(mod,broom<span class="sc">::</span>glance), <span class="co"># glance() gives model summaries</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">augment=</span><span class="fu">map</span>(mod,broom<span class="sc">::</span>augment) <span class="co"># model coefficients</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="co"># What can you do with this nest of data frames? </span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a><span class="co"># The reverse of step 1; un-nest it to unpack everything!</span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 34:40</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Keeps a massive list of related information neatly organized!</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,data) <span class="co"># back to where we started</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,glance, <span class="at">.drop =</span> <span class="cn">TRUE</span>) </span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,tidy) </span></code></pre></div>
<p>…and here is a version I made of the above to manage many Bayesian models. Admittedly, I’m not really sure how useful this is though.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONDENSED MASTER TABLE VERSION -----------------------------------------------------------------------------</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Models table that has all models condensed</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span><span class="fu">tribble</span>(<span class="sc">~</span>Model_name, <span class="sc">~</span>model_descrip, <span class="sc">~</span>model,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Thesis_Model&quot;</span>, <span class="st">&quot;Discount and PTS&quot;</span>, Thesis_Model,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;discount_model&quot;</span>, <span class="st">&quot;Discount variable only&quot;</span>, discount_model,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;PTS_model&quot;</span>, <span class="st">&quot;PTS variable only&quot;</span>, PTS_model</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up work space</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(DiscountPrior,Priors_MEmodel,Priors_Interactionmodel)</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab and store all model info </span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span>models <span class="sc">%&gt;%</span> </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_info=</span><span class="fu">map</span>(model,describe_prior),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior_info=</span><span class="fu">map</span>(model, describe_posterior_fancy),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_performance=</span><span class="fu">map</span>(model,performance<span class="sc">::</span>performance)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co"># DO NOT TRY AND VIEW THE TABLE IN A WINDOW!!!! RStan objects are so large they cause R to lock up</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the model in the console instead</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="do">#### summon individual model stats ####</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_prior</span>(models<span class="sc">$</span>model[[<span class="dv">1</span>]]) <span class="co">#by specific model</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(models<span class="sc">$</span>model,describe_prior) <span class="co"># do for all models at once</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co"># or all info for all models at once</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,posterior_info) <span class="sc">%&gt;%</span> </span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(model,prior_info,model_descrip))</span></code></pre></div>
</div>
<div id="turn-row-names-into-a-columnvariable" class="section level2" number="3.9">
<h2 number="3.9"><span class="header-section-number">3.9</span> Turn row names into a column/variable</h2>
<p>Use the <code>rownames()</code> command to turn row names into a variable</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cars<span class="ot">=</span><span class="fu">rownames_to_column</span>(mtcars, <span class="at">var =</span> <span class="st">&quot;car&quot;</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(cars) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 12
##   car                 mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Mazda RX4          21       6   160   110  3.9   2.62  16.5     0     1     4     4
## 2 Mazda RX4 Wag      21       6   160   110  3.9   2.88  17.0     0     1     4     4
## 3 Datsun 710         22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
## 4 Hornet 4 Drive     21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
## 5 Hornet Sportabout  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2
## 6 Valiant            18.1     6   225   105  2.76  3.46  20.2     1     0     3     1</code></pre>
</div>
<div id="how-to-editchange-column-names" class="section level2" number="3.10">
<h2 number="3.10"><span class="header-section-number">3.10</span> How to edit/change column names</h2>
<p>TWO WAYS TO DO THIS: Use <code>colnames()</code> (for base R) or <code>rename()</code> (for tidyverse)</p>
<p><code>colnames()</code> pulls up all the column/variable names as a vector. If you want to actually change them, you’ll need to combine this command with something like the sub() or gsub() commands (for base R). I’m going to skip this because…its base R.</p>
<p>To access and change the names faster via tidyverse, run use <code>rename()</code></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear R&#39;s memory</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">&quot;hurr&quot;</span><span class="ot">=</span><span class="st">&quot;Sepal.Length&quot;</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;durr&quot;</span><span class="ot">=</span><span class="st">&quot;Sepal.Width&quot;</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;abcdefgh&quot;</span><span class="ot">=</span><span class="st">&quot;Species&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   hurr durr Petal.Length Petal.Width abcdefgh
## 1  5.1  3.5          1.4         0.2   setosa
## 2  4.9  3.0          1.4         0.2   setosa
## 3  4.7  3.2          1.3         0.2   setosa
## 4  4.6  3.1          1.5         0.2   setosa
## 5  5.0  3.6          1.4         0.2   setosa
## 6  5.4  3.9          1.7         0.4   setosa</code></pre>
<p>If you need to do some really fancy conditional renaming (e.g., changing all variables that start with “r” to start with “rf” instead, to make it more clear that the prefix actually stands for “risk factor” rather than “reverse coded”), you’ll need to use <code>rename_with()</code>.</p>
<p>This command has two parts to it: the data set, and the function you wish to apply to it (which you put after the <code>~</code>)</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename_with</span>(iris, <span class="sc">~</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;.&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;_&quot;</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   Sepal_Length Sepal_Width Petal_Length Petal_Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>The gsub() function from Base R identifies matching patterns in the data and substitutes them with what you want instead. Think of it like R’s version of Find/Replace from Microsoft Word.</p>
<p>The above line of code thus does the following:
1. First, it checks the column names of the supplied data set (<code>iris</code>) for a specific pattern (specified in <code>pattern=</code> )
2. Then it replaces that pattern with your input in <code>replacement=</code></p>
<p>The great thing about rename_with() is that the .fn (or <code>~</code> for short) can take <em>ANY</em> function as input. For example, if you want to <strong>add</strong> an element to the column names rather than replace something, (e.g., a prefix or suffix), you can change the function to:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename_with</span>( iris, <span class="sc">~</span> <span class="fu">paste0</span>(.x,  <span class="st">&quot;_text&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   Sepal.Length_text Sepal.Width_text Petal.Length_text Petal.Width_text Species_text
## 1               5.1              3.5               1.4              0.2       setosa
## 2               4.9              3.0               1.4              0.2       setosa
## 3               4.7              3.2               1.3              0.2       setosa
## 4               4.6              3.1               1.5              0.2       setosa
## 5               5.0              3.6               1.4              0.2       setosa
## 6               5.4              3.9               1.7              0.4       setosa</code></pre>
<p>The above line adds a suffix. You can also add a prefix in the exact same way, just by switching the order of the string and the pattern in the paste0 command.</p>
<p><strong><em>Alternative method to the above</em></strong>
This is a second way to do the above. It may appear more simple, but it’s also probably not as theoretically consistent with how the packages were made…..it uses the <code>stringr</code> package to rename the column names, and <code>stringr</code> is typically used for editing vectors of strings in a data set.</p>
<p>…so it works, but it’s a little unconventional because you call and edit the column names like you would a variable in your data set.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(iris)<span class="ot">=</span><span class="fu">str_replace</span>(<span class="fu">colnames</span>(iris), <span class="at">pattern =</span> <span class="st">&quot;.&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<p>In short: <code>rename()</code> and <code>rename_with()</code> are for <em>renaming</em> variables, as their names imply. The <code>str_</code> verbs from the stringr package are for editing string-based variabels in your data set. Either works though with a little ingenuity.</p>
</div>
<div id="re-order-columns-in-a-data-set" class="section level2" number="3.11">
<h2 number="3.11"><span class="header-section-number">3.11</span> Re-order columns in a data set</h2>
<p>Use <code>relocate()</code> to change column positions. If you need to move multiple columns at once, this command uses the same syntax as <code>select()</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="co"># notice the column order</span></span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(hp<span class="sc">:</span>wt, <span class="at">.after=</span> am) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                    mpg cyl disp  qsec vs am  hp drat    wt gear carb
## Mazda RX4         21.0   6  160 16.46  0  1 110 3.90 2.620    4    4
## Mazda RX4 Wag     21.0   6  160 17.02  0  1 110 3.90 2.875    4    4
## Datsun 710        22.8   4  108 18.61  1  1  93 3.85 2.320    4    1
## Hornet 4 Drive    21.4   6  258 19.44  1  0 110 3.08 3.215    3    1
## Hornet Sportabout 18.7   8  360 17.02  0  0 175 3.15 3.440    3    2
## Valiant           18.1   6  225 20.22  1  0 105 2.76 3.460    3    1</code></pre>
</div>
<div id="working-with-date-and-time-variables" class="section level2" number="3.12">
<h2 number="3.12"><span class="header-section-number">3.12</span> Working with date and time variables</h2>
<div id="format-date-and-time-variables-appropriate-as-date-objects-in-r" class="section level3" number="3.12.1">
<h3 number="3.12.1"><span class="header-section-number">3.12.1</span> Format date-and-time variables appropriate as date objects in R</h3>
<p>Formatting a column of dates can be extremely helpful if you need to work with time data, but also an extreme pain in the ass. It requires things to be done in two stages, and very precisely. Particularly in the first stage.</p>
<p>First, assuming your data is already imported and is being stored as a vector of character strings, you have to tell R to adjust the formatting of dates. You cannot change it from a character-based object into a Date or DateTime one until it recognizes the correct formatting.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>example_date_data<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>X1,     <span class="sc">~</span>X2,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/4/2021&quot;</span>,  <span class="sc">-</span><span class="fl">49.87</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/4/2021&quot;</span>,  <span class="sc">-</span><span class="fl">13.85</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/3/2021&quot;</span>,   <span class="sc">-</span><span class="fl">7.45</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/3/2021&quot;</span>, <span class="sc">-</span><span class="fl">172.71</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,   <span class="sc">-</span><span class="fl">6.37</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,     <span class="sc">-</span><span class="dv">25</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>, <span class="sc">-</span><span class="fl">219.68</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,  <span class="sc">-</span><span class="fl">53.75</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,  <span class="sc">-</span><span class="fl">29.83</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,  <span class="sc">-</span><span class="fl">77.06</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,  <span class="sc">-</span><span class="fl">16.16</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>, <span class="sc">-</span><span class="fl">114.78</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>,     <span class="sc">-</span><span class="dv">50</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;8/2/2021&quot;</span>, <span class="sc">-</span><span class="fl">157.64</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct formatting</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>example_date_data<span class="sc">$</span>X1<span class="ot">=</span><span class="fu">format</span>(<span class="fu">as.POSIXct</span>(example_date_data<span class="sc">$</span>X1,<span class="at">format=</span><span class="st">&#39;%m/%d/%Y&#39;</span>),<span class="at">format=</span><span class="st">&#39;%Y-%m-%d&#39;</span>)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as_tibble</span>(example_date_data))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   X1              X2
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 2021-08-04  -49.9 
## 2 2021-08-04  -13.8 
## 3 2021-08-03   -7.45
## 4 2021-08-03 -173.  
## 5 2021-08-02   -6.37
## 6 2021-08-02  -25</code></pre>
<p>In the code above, note that there are two <code>format</code> commands: The first one tells R how the date data is <strong>currently being stored</strong>, while the second at the end tells it how <strong>you want it to be stored.</strong> In this case, we are changing it from the way we would usually hand write a date (e.g., 10/26/1993) to a format commonly recognized and used in Excel and stats software (1993-10-26). <em>If your column also has times in it, you also need to include that too!</em></p>
<p>Second, you can now correct the object’s structure. You can do this with base R’s <code>as.Date()</code> or tidyverse’s <code>date()</code> verbs.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct structure</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>example_date_data<span class="sc">$</span>X1<span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">date</span>(example_date_data<span class="sc">$</span>X1) <span class="co"># tidyverse</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R version</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># example_date_data$X1=as.Date(example_date_data$X1)</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as_tibble</span>(example_date_data))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   X1              X2
##   &lt;date&gt;       &lt;dbl&gt;
## 1 2021-08-04  -49.9 
## 2 2021-08-04  -13.8 
## 3 2021-08-03   -7.45
## 4 2021-08-03 -173.  
## 5 2021-08-02   -6.37
## 6 2021-08-02  -25</code></pre>
<p>Notice how the object is now stored as the correct type in the table above.</p>
<p><strong><em>NOTE!</em></strong> This entire process has been included in the <code>tidy_date()</code> command in my package, <code>legaldmlab</code>.</p>
</div>
<div id="find-the-difference-between-two-datestimes" class="section level3" number="3.12.2">
<h3 number="3.12.2"><span class="header-section-number">3.12.2</span> Find the difference between two dates/times</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(part_1<span class="sc">$</span>end_date[<span class="dv">1</span>], part_2<span class="sc">$</span>end_date[<span class="dv">1</span>], <span class="at">units=</span><span class="st">&quot;days&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="reverse-code-a-variable" class="section level2" number="3.13">
<h2 number="3.13"><span class="header-section-number">3.13</span> Reverse-code a variable</h2>
<p>To reverse-score a variable, you should use <code>car::recode()</code>
Can be done a few different ways, depending on how many variables you’re looking to recode:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode just one variable</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>column<span class="ot">=</span><span class="fu">recode</span>(df<span class="sc">$</span>column,<span class="st">&quot;1 = 7 ; 2 = 6 ; 3 = 5 ; 5 = 3 ; 6 = 2 ; 7 = 1&quot;</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode a select bunch of variables</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span>df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(family_close <span class="sc">:</span> family_feelings), recode, <span class="st">&quot;1 = 7 ; 2 = 6 ; 3 = 5 ; 5 = 3 ; 6 = 2 ; 7 = 1&quot;</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode the whole damn thing. All columns.</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span>df <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(recode, <span class="st">&quot;1 = 7 ; 2 = 6 ; 3 = 5 ; 5 = 3 ; 6 = 2 ; 7 = 1&quot;</span>)</span></code></pre></div>
</div>
<div id="create-a-relative-ranking-among-several-variables" class="section level2" number="3.14">
<h2 number="3.14"><span class="header-section-number">3.14</span> Create a relative ranking among several variables</h2>
<p>If you want to create a variable that is an ordinal ranking of other variables, first you need to make sure your data is long-wise. Then, depending on the type of ranking system you want, you’ll might need a different ranking command….</p>
<ul>
<li><p>The <code>min_rank</code> command from dplyr works in a manner similar to base R’s <code>rank</code> command. It ranks things like you see in sporting events. For example, if there is a clear winner in a game but 3 people tie for second place, the ranks would look like this: 1,2,2,2,4,5. Notice that the positions are independent from the counts.</p></li>
<li><p>Using the same example from above, if you want the ranks to have no gaps (i.e. 1,2,2,2,3,4), you need to use dplyr’s <code>dense_rank</code> command.</p></li>
<li><p>In either case, the ranks are generated from lowest to highest, so if you want to flip them around you’ll need to include <code>desc()</code> in the command.</p></li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>name, <span class="sc">~</span>score,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;bob&quot;</span>, <span class="dv">0</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;bob&quot;</span>, <span class="dv">5</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;bob&quot;</span>, <span class="dv">50</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;bob&quot;</span>, <span class="dv">50</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;bob&quot;</span>, <span class="dv">50</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;bob&quot;</span>, <span class="cn">NA</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;alice&quot;</span>, <span class="dv">70</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;alice&quot;</span>, <span class="dv">80</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;alice&quot;</span>, <span class="dv">90</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;alice&quot;</span>, <span class="dv">20</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;alice&quot;</span>, <span class="dv">20</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;alice&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ranked =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(score)))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    name  score ranked
##    &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt;
##  1 bob       0      8
##  2 bob       5      6
##  3 bob      50      4
##  4 bob      50      4
##  5 bob      50      4
##  6 bob      NA     NA
##  7 alice    70      3
##  8 alice    80      2
##  9 alice    90      1
## 10 alice    20      5
## 11 alice    20      5
## 12 alice     1      7</code></pre>
<!--chapter:end:03-wrangle.Rmd-->
</div>
</div>
<div id="clean-data" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Clean Data</h1>
<div id="replace-a-value-with-na" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Replace a value with NA</h2>
<p>Use <code>dplyr::na_if()</code> if you have a value coded in your data (e.g., 999) that you want to convert to NA</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>example_data<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>name, <span class="sc">~</span>bday_month,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Ryan&quot;</span>, <span class="dv">10</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Z&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Jen&quot;</span>, <span class="dv">999</span>, </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Tristin&quot;</span>, <span class="dv">999</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Cassidy&quot;</span>, <span class="dv">6</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>example_data</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   name    bday_month
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 Ryan            10
## 2 Z                3
## 3 Jen            999
## 4 Tristin        999
## 5 Cassidy          6</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>example_data<span class="sc">$</span>bday_month<span class="ot">=</span><span class="fu">na_if</span>(example_data<span class="sc">$</span>bday_month, <span class="dv">999</span>) <span class="co">#example doing one column at a time </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>example_data</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   name    bday_month
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 Ryan            10
## 2 Z                3
## 3 Jen             NA
## 4 Tristin         NA
## 5 Cassidy          6</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>example_data <span class="sc">%&gt;%</span> <span class="co"># can also pass the data to mutate and do it the tidyverse way</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bday_month=</span><span class="fu">na_if</span>(bday_month, <span class="dv">999</span>)) </span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   name    bday_month
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 Ryan            10
## 2 Z                3
## 3 Jen             NA
## 4 Tristin         NA
## 5 Cassidy          6</code></pre>
</div>
<div id="replace-nas-with-a-value" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Replace NA’s with a value</h2>
<p><code>tidyr::replace_na()</code> is very useful if you have some NA’s in your data and you want to fill them in with some value.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>example_data<span class="ot">=</span>tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>name, <span class="sc">~</span>fav_color, <span class="sc">~</span>fav_food,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Ryan&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;Mexican&quot;</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Cassidy&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="cn">NA</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Z&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Tristin&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="cn">NA</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Tarika&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Jen&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Italian&quot;</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>example_data</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   name    fav_color fav_food
##   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   
## 1 Ryan    green     Mexican 
## 2 Cassidy blue      &lt;NA&gt;    
## 3 Z       &lt;NA&gt;      &lt;NA&gt;    
## 4 Tristin purple    &lt;NA&gt;    
## 5 Tarika  &lt;NA&gt;      &lt;NA&gt;    
## 6 Jen     &lt;NA&gt;      Italian</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA&#39;s in one col</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>tidyr<span class="sc">::</span><span class="fu">replace_na</span>(example_data<span class="sc">$</span>fav_food, <span class="st">&quot;MISSING&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Mexican&quot; &quot;MISSING&quot; &quot;MISSING&quot; &quot;MISSING&quot; &quot;MISSING&quot; &quot;Italian&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace in multiple columns</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>example_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(fav_color, fav_food), replace_na, <span class="st">&quot;MISSING&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   name    fav_color fav_food
##   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   
## 1 Ryan    green     Mexican 
## 2 Cassidy blue      MISSING 
## 3 Z       MISSING   MISSING 
## 4 Tristin purple    MISSING 
## 5 Tarika  MISSING   MISSING 
## 6 Jen     MISSING   Italian</code></pre>
</div>
<div id="identify-columns-or-rows-with-missing-values" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Identify columns or rows with Missing values</h2>
<p><code>is.na()</code> is the base R way to identify, in a TRUE/FALSE manner, whether or not there are missing values in a vector</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="cn">NA</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(y) <span class="co"># returns a vector (F F F T)</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE</code></pre>
</div>
<div id="find-the-percentage-of-a-variable-that-is-missing" class="section level2" number="4.4">
<h2 number="4.4"><span class="header-section-number">4.4</span> Find the percentage of a variable that is missing</h2>
<p>Sometimes necessary to check before conducting an analysis. <em>This requires my package</em>, <code>legaldmlab</code></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>?legaldmlab<span class="sc">::</span>count_missing</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(hp<span class="sc">:</span>drat) <span class="sc">%&gt;%</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  legaldmlab<span class="sc">::</span><span class="fu">count_missing</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   variable missing_count percent_missing
##   &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;          
## 1 hp                   0 0.0%           
## 2 drat                 0 0.0%</code></pre>
</div>
<div id="exclude-missing-values-from-analysis" class="section level2" number="4.5">
<h2 number="4.5"><span class="header-section-number">4.5</span> Exclude Missing values from analysis</h2>
</div>
</div>
<div id="dropping-missing-values-from-the-data-set" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Dropping Missing values from the data set</h1>
<p><code>tidyr::drop_na()</code></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>example_data<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>name, <span class="sc">~</span>bday_month, <span class="sc">~</span>car,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Ryan&quot;</span>, <span class="dv">10</span>, <span class="st">&quot;kia&quot;</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Z&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;toyota&quot;</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Jen&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Tristin&quot;</span>, <span class="dv">999</span>, <span class="cn">NA</span>,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Cassidy&quot;</span>, <span class="dv">6</span>, <span class="st">&quot;honda&quot;</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>example_data</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   name    bday_month car   
##   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; 
## 1 Ryan            10 kia   
## 2 Z               NA toyota
## 3 Jen             NA &lt;NA&gt;  
## 4 Tristin        999 &lt;NA&gt;  
## 5 Cassidy          6 honda</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>example_data <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="co"># with nothing specified, it drops ALL variables that have &gt;=1 missing value</span></span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   name    bday_month car  
##   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;
## 1 Ryan            10 kia  
## 2 Cassidy          6 honda</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>example_data <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(car) <span class="co"># drops only rows with values missing in the specified column</span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   name    bday_month car   
##   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; 
## 1 Ryan            10 kia   
## 2 Z               NA toyota
## 3 Cassidy          6 honda</code></pre>
<!--chapter:end:04-clean.Rmd-->
</div>
<div id="working-with-factors" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Working with Factors</h1>
<div id="manually-recodechange-a-factors-levels" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Manually recode/change a factor’s levels</h2>
<p>Use <code>forcats::fct_recode()</code></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>diamonds<span class="ot">=</span>diamonds <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>diamonds<span class="sc">$</span>cut<span class="ot">=</span><span class="fu">fct_recode</span>(diamonds<span class="sc">$</span>cut, <span class="st">&quot;meh&quot;</span><span class="ot">=</span><span class="st">&quot;Fair&quot;</span>, <span class="st">&quot;Wow&quot;</span><span class="ot">=</span><span class="st">&quot;Premium&quot;</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diamonds<span class="sc">$</span>cut)</span></code></pre></div>
<pre><code>##       meh      Good Very Good       Wow     Ideal 
##      1610      4906     12082     13791     21551</code></pre>
</div>
<div id="collapse-factor-levels" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Collapse factor levels</h2>
<p>Extremely useful command for when you have infrequent cases in one factor and need to combine it with another.</p>
<p>Works by specifying a series of new level names, each of which contains the information from the old variables. Format is as follows:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_collapse</span>(dataset<span class="sc">$</span>variable,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">NewLevelA=</span><span class="fu">c</span>(<span class="st">&quot;OldLevel1&quot;</span>,<span class="st">&quot;Oldlevel2&quot;</span>), <span class="co"># NewLevelA is the new variable that contains both variables 1 and 2</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">NewLevelB=</span><span class="fu">c</span>(<span class="st">&quot;OldLevel3&quot;</span>))</span></code></pre></div>
</div>
<div id="add-levels-to-a-factor" class="section level2" number="6.3">
<h2 number="6.3"><span class="header-section-number">6.3</span> Add levels to a factor</h2>
<p>use <code>fct_expand()</code></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;temp&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;temp&quot;</code></pre>
</div>
<div id="drop-unused-levels" class="section level2" number="6.4">
<h2 number="6.4"><span class="header-section-number">6.4</span> Drop unused levels</h2>
<p>Use <code>fct_drop()</code></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;temp&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;temp&quot;</code></pre>
</div>
<div id="change-the-order-of-a-factors-levels" class="section level2" number="6.5">
<h2 number="6.5"><span class="header-section-number">6.5</span> Change the order of a factor’s levels</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>example_data<span class="ot">=</span><span class="fu">tribble</span>(<span class="sc">~</span>person, <span class="sc">~</span>condition,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;bob&quot;</span>, <span class="st">&quot;25 years&quot;</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;jane&quot;</span>, <span class="st">&quot;5 years&quot;</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;jim&quot;</span>, <span class="st">&quot;5 years&quot;</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;john&quot;</span>, <span class="st">&quot;25 years&quot;</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>example_data<span class="sc">$</span>condition<span class="ot">=</span><span class="fu">factor</span>(example_data<span class="sc">$</span>condition)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(example_data<span class="sc">$</span>condition)</span></code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;25 years&quot;,&quot;5 years&quot;: 1 2 2 1</code></pre>
<p>Notice that R thinks these are nominal factors, and that 25 comes before 5. To fix this and correct the level order…</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>example_data<span class="sc">$</span>condition <span class="ot">=</span><span class="fu">fct_relevel</span>(example_data<span class="sc">$</span>condition, <span class="fu">c</span>(<span class="st">&quot;5 years&quot;</span>, <span class="st">&quot;25 years&quot;</span>)) <span class="co"># specify level order</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(example_data<span class="sc">$</span>condition)</span></code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;5 years&quot;,&quot;25 years&quot;: 2 1 1 2</code></pre>
<!--chapter:end:05-factors.Rmd-->
</div>
</div>
<div id="working-with-strings" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Working with Strings</h1>
<div id="remove-a-pattern-from-a-string" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> Remove a pattern from a string</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>price_table<span class="ot">=</span><span class="fu">tribble</span>(<span class="sc">~</span>car, <span class="sc">~</span>price,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Corvette&quot;</span>, <span class="st">&quot;$65,000&quot;</span>,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Mustang GT&quot;</span>, <span class="st">&quot;$40,000&quot;</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co"># BASE R METHOD (sub by replacing something with nothing)</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">$&quot;</span>, <span class="st">&quot;&quot;</span>,price_table<span class="sc">$</span>price) <span class="co"># (pattern, replace with, object$column)</span></span></code></pre></div>
<pre><code>## [1] &quot;65,000&quot; &quot;40,000&quot;</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TIDYVERSE METHOD</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_remove</span>(price_table<span class="sc">$</span>price, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">$&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;65,000&quot; &quot;40,000&quot;</code></pre>
</div>
<div id="replace-one-pattern-in-a-string-with-another" class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> Replace one pattern in a string with another</h2>
<p>Tidyverse command: <code>str_replace()</code>
Base R command: <code>gsub()</code></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base R</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(mtcars, <span class="at">replacement =</span> )</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tidyverse</span></span></code></pre></div>
</div>
<div id="find-i.e.-filter-for-all-instances-of-a-string" class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> Find (i.e., filter for) all instances of a string</h2>
<p>Useful for finding very specific things inside a column (e.g., one particular person’s name in a roster of names; everyone with a particular last name)</p>
<p>Tidyverse command: <code>str_detect()</code>
Base R command: <code>grepl()</code></p>
<p>Note both must be nested inside of <code>filter()</code></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>cars_df<span class="ot">=</span><span class="fu">rownames_to_column</span>(mtcars, <span class="at">var =</span> <span class="st">&quot;car&quot;</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># base R</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>cars_df <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;Firebird&quot;</span>, car))</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>cars_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(car,<span class="st">&quot;Firebird&quot;</span>))</span></code></pre></div>
<p>You can also search for <strong>multiple strings simultaneously</strong> by including the “or” logical operator <em>inside</em> the quotes.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>cars_df <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(car, <span class="st">&quot;Firebird|Fiat&quot;</span>))</span></code></pre></div>
<p>You can also include the negation logical operator to filter for all instances <em>except</em> those with the specified string.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base R</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>cars_df <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">grepl</span>(<span class="st">&quot;Pontiac&quot;</span>, car)))</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>cars_df <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">str_detect</span>(car, <span class="st">&quot;Pontiac&quot;</span>)))</span></code></pre></div>
</div>
<div id="force-all-letters-to-lower-case" class="section level2" number="7.4">
<h2 number="7.4"><span class="header-section-number">7.4</span> Force all letters to lower case</h2>
<p>Use <code>str_to_lower()</code></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>blah<span class="ot">=</span><span class="fu">tribble</span>(<span class="sc">~</span>A, <span class="sc">~</span>B,</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;A&quot;</span>,<span class="st">&quot;X&quot;</span>,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;A&quot;</span>,<span class="st">&quot;X&quot;</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>blah</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   A     B    
##   &lt;chr&gt; &lt;chr&gt;
## 1 A     X    
## 2 A     X</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>blah<span class="sc">$</span>A<span class="ot">=</span><span class="fu">str_to_lower</span>(blah<span class="sc">$</span>A)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>blah</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   A     B    
##   &lt;chr&gt; &lt;chr&gt;
## 1 a     X    
## 2 a     X</code></pre>
<!--chapter:end:06-strings.Rmd-->
</div>
</div>
<div id="figures-and-graphs-with-the-ggplot-and-see-packages" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Figures and Graphs with the ggplot and see packages</h1>
<p>There are three parts to a ggplot2 call: 1. data 2. aesthetic mapping 3. Layer</p>
<p>There is no piping involved in ggplot. You simply invoke ggplot, and tell it what they dataset is. Then you specify the aesthetics, and then the mapping. Lastly, include other optional stuff (e.g. expanded y-axis scale; titles and legends; etc.)</p>
<p>Every single plot has the exact same layout that ONLY USES the above three points:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dataframe, <span class="fu">aes</span>(graph dimensions and variables used)) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_GraphType</span>(specific graph controls)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="do">## OR ##</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dataframe) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_GraphType</span>(<span class="fu">aes</span>(graph dimensions and variables used), specific graph controls)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mapping= aes() can go in either spot</span></span></code></pre></div>
<p>Then if you have other stuff you want to add on top of this, like axis labels, annotations, highlights, etc., you keep adding those in separate lines</p>
<div id="commands-for-ggplot-graph-types" class="section level2" number="8.1">
<h2 number="8.1"><span class="header-section-number">8.1</span> Commands for ggplot graph types</h2>
<table>
<thead>
<tr class="header">
<th>Graph Type</th>
<th>Geom command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Scatter</td>
<td><code>geom_point()</code></td>
</tr>
<tr class="even">
<td>Line</td>
<td><code>geom_line()</code></td>
</tr>
<tr class="odd">
<td>Box</td>
<td><code>geom_boxplot()</code></td>
</tr>
<tr class="even">
<td>Bar</td>
<td><code>geom_bar()</code></td>
</tr>
<tr class="odd">
<td>Column</td>
<td><code>geom_col()</code></td>
</tr>
<tr class="even">
<td>Histogram</td>
<td><code>geom_histogram()</code></td>
</tr>
<tr class="odd">
<td>Density curve</td>
<td><code>geom_density()</code></td>
</tr>
</tbody>
</table>
<p>Note that bar and column graphs look identical at first glance, but they serve two different purposes.</p>
<p><em>Bar graphs are for frequency counts, and thus only take an X-axis variable; Column graphs are for showing the relationship between two variables X and Y, and display the values in the data</em></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BAR GRAPH</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># height of bars is a frequency count of each level of the X variable cut</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>bar_plot<span class="ot">=</span><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x=</span>cut)) <span class="sc">+</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># COLUMN GRAPH</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># height of bars represents relationship between price and cut</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>col_plot<span class="ot">=</span><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">y=</span>price)) <span class="sc">+</span> </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>see<span class="sc">::</span><span class="fu">plots</span>(bar_plot, col_plot, <span class="at">n_columns =</span> <span class="dv">2</span>, <span class="at">tags =</span> <span class="fu">c</span>(<span class="st">&quot;Bar&quot;</span>, <span class="st">&quot;Column&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.2-1.png" width="672" /></p>
</div>
<div id="specific-commands-for-specific-types-of-analysis" class="section level2" number="8.2">
<h2 number="8.2"><span class="header-section-number">8.2</span> Specific Commands for Specific Types of Analysis</h2>
<div id="lavaan-stuff" class="section level3" number="8.2.1">
<h3 number="8.2.1"><span class="header-section-number">8.2.1</span> lavaan stuff</h3>
<div id="plotting-an-sem-or-cfa-model" class="section level4" number="8.2.1.1">
<h4 number="8.2.1.1"><span class="header-section-number">8.2.1.1</span> Plotting an SEM or CFA model</h4>
<p>First lets set up a model to use.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>HS.model <span class="ot">&lt;-</span> <span class="st">&#39; visual  =~ x1 + x2 + x3 </span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="st">              textual =~ x4 + x5 + x6</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="st">              speed   =~ x7 + x8 + x9&#39;</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(HS.model, <span class="at">data=</span>HolzingerSwineford1939)</span></code></pre></div>
<p>Two options for graphing it. Option 1 is <code>graph_sem()</code> from the tidySEM package.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>tidySEM<span class="sc">::</span><span class="fu">graph_sem</span>(fit1)</span></code></pre></div>
<p>Option 2 is from the easystats suite</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(parameters<span class="sc">::</span><span class="fu">parameters</span>(fit1))</span></code></pre></div>
<pre><code>## Using `sugiyama` as default layout</code></pre>
<p><img src="bookdownproj_files/figure-html/7_paramplot-1.png" width="672" /></p>
</div>
</div>
<div id="bayes-stuff" class="section level3" number="8.2.2">
<h3 number="8.2.2"><span class="header-section-number">8.2.2</span> Bayes stuff</h3>
<p>Quick highlights here of my favorite functions from this package. See (ha) the full package overview at <a href="https://easystats.github.io/see/">this link</a></p>
<p>You can adjust the colors of the figures by setting them yourself (with scale_fill_manual), or by using the appropriate scale_fill command</p>
<div id="probability-of-direction-pd-figure" class="section level4" number="8.2.2.1">
<h4 number="8.2.2.1"><span class="header-section-number">8.2.2.1</span> Probability of Direction (<em>Pd</em>) figure</h4>
<p>Use <code>plot(pd())</code> to visualize the Probability of Direction index.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bayestestR<span class="sc">::</span><span class="fu">pd</span>(fit1))<span class="sc">+</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFC107&quot;</span>, <span class="st">&quot;#E91E63&quot;</span>))<span class="sc">+</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>))</span></code></pre></div>
</div>
<div id="rope-figure" class="section level4" number="8.2.2.2">
<h4 number="8.2.2.2"><span class="header-section-number">8.2.2.2</span> ROPE figure</h4>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit1, <span class="at">rope_color =</span> <span class="st">&quot;grey70&quot;</span>)<span class="sc">+</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  gameofthrones<span class="sc">::</span><span class="fu">scale_fill_got_d</span>(<span class="at">option =</span> <span class="st">&quot;white_walkers&quot;</span>) </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_fill_manual(values = c(&quot;gray75&quot;,&quot;red&quot;)</span></span></code></pre></div>
<p>ROPE tests are plots of distributions, and therefore use scale_fill_xyz_d commands. (the ‘d’ stands for ‘discrete’). You can use any scale theme color set from any package, as long as it ends in _d</p>
<p>values=c(“#FFC107”, “#E91E63”) is the default bayestestR theme colors from their website</p>
</div>
<div id="bayes-factor-models-comparison-figure" class="section level4" number="8.2.2.3">
<h4 number="8.2.2.3"><span class="header-section-number">8.2.2.3</span> Bayes factor models comparison figure</h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">bayesfactor_models</span>(Thesis_Model,discount_model))<span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_flat</span>(<span class="at">palette =</span> <span class="st">&quot;complement&quot;</span> , <span class="at">reverse =</span> <span class="cn">TRUE</span>)<span class="sc">+</span> <span class="co"># scale color adjustment</span></span></code></pre></div>
</div>
</div>
<div id="histograms-and-density-curves" class="section level3" number="8.2.3">
<h3 number="8.2.3"><span class="header-section-number">8.2.3</span> Histograms and density curves</h3>
<p>Since I use these so often I figure they deserve their own special section.</p>
<p>Basic histograms can be built with the following code:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x=</span>cyl)) <span class="sc">+</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> .<span class="dv">5</span>, <span class="at">colour=</span><span class="st">&quot;Black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;green&quot;</span>) <span class="sc">+</span> <span class="co"># histogram</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.3_histogram-1.png" width="672" /></p>
<p>and your basic density curve with the following:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">3</span>)<span class="sc">+</span> <span class="co"># density plot. Alpha sets the transparency level of the fill.</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.4-1.png" width="672" /></p>
<p>You can also use the following code from <code>bayestestR</code> to build a really quick and nice density curve</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bayestestR<span class="sc">::</span><span class="fu">point_estimate</span>(diamonds, <span class="at">centrality=</span><span class="fu">c</span>(<span class="st">&quot;median&quot;</span>,<span class="st">&quot;mean&quot;</span>)))<span class="sc">+</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Mean and Median&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.5-1.png" width="672" /></p>
</div>
</div>
<div id="highlight-specific-points" class="section level2" number="8.3">
<h2 number="8.3"><span class="header-section-number">8.3</span> Highlight specific points</h2>
<p>The <code>gghighlight</code> package is great for this</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example 1</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp))<span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">label =</span> hp))<span class="sc">+</span> <span class="co"># add data labels (optional)</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  gghighlight<span class="sc">::</span><span class="fu">gghighlight</span>(hp <span class="sc">&gt;</span> <span class="dv">200</span>) <span class="co"># add highlights, according to some criteria</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.6-1.png" width="672" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example 2</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>diamonds_abr<span class="ot">=</span>diamonds <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds_abr, <span class="fu">aes</span>(<span class="at">x=</span> cut, <span class="at">y=</span> price, <span class="at">colour=</span>price))<span class="sc">+</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> diamonds_abr, <span class="fu">aes</span>(<span class="at">label =</span> price))<span class="sc">+</span> <span class="co"># this line labels</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  gghighlight<span class="sc">::</span><span class="fu">gghighlight</span>(cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Very Good&quot;</span>, <span class="st">&quot;Ideal&quot;</span>)) <span class="co">#this line highlights</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.6-2.png" width="672" /></p>
</div>
<div id="add-labels-to-data-points" class="section level2" number="8.4">
<h2 number="8.4"><span class="header-section-number">8.4</span> Add labels to data points</h2>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp))<span class="sc">+</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">label =</span> hp))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.7-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp))<span class="sc">+</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>hp, <span class="at">hjust=</span><span class="fl">2.5</span>, <span class="at">vjust=</span><span class="fl">2.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.7-2.png" width="672" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#geom_label(aes(label = scales::comma(n)), size = 2.5, nudge_y = 6)</span></span></code></pre></div>
</div>
<div id="plotting-multiple-graphs-at-once" class="section level2" number="8.5">
<h2 number="8.5"><span class="header-section-number">8.5</span> Plotting multiple graphs at once</h2>
<p><code>see::plots()</code> is good for this.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;temp&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;temp&quot;</code></pre>
</div>
<div id="change-the-colors-bars-columns-dots-etc." class="section level2" number="8.6">
<h2 number="8.6"><span class="header-section-number">8.6</span> Change the colors (bars; columns; dots; etc.)</h2>
<p>This can be done in at least two different ways, depending on your goal.</p>
<p>To change the fill color by factor or group, add <code>fill = ___</code> within the <code>aes()</code> command. If you want to add color and/or fill to a <em>continuous</em> variable, do that within the <code>geom_density()</code> command.</p>
<p>If you want to <em>add color and make all of the (bars; dots; lines; etc.) the same color</em>, than that is a graph-wide control and needs to be put in <code>geom_point()</code>. This manually sets the color for the whole graph.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a color scale to the dots</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp))<span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.9-1.png" width="672" /></p>
<p>If you want to add color that changes according to a variable (e.g., by factor level), then the color needs to be specified <strong>as a variable name</strong>, in the aes mapping with the other variables.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp, <span class="at">color=</span>cyl))<span class="sc">+</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.10-1.png" width="672" /></p>
<div id="fine-tuning-colors" class="section level3" number="8.6.1">
<h3 number="8.6.1"><span class="header-section-number">8.6.1</span> Fine-tuning colors</h3>
<p>You can change the spectrum of colors to specific colors if you want. Useful for example, when making graphs for APLS presentations; you can change the colors to be Montclair State University themed.</p>
<p>When changing the color scale of graphs, note that <code>scale_fill</code> commands are used for representing <em>nominal data</em>, while <code>scale_color</code> commands are for representing <em>continuous data</em>. As such, you use <code>scale_fill</code> to <em>fill in</em> area on a graph that shows a whole category or distinct things; and <code>scale_color</code> to use <em>gradients of color</em> to show changes in continuous data.</p>
<ul>
<li>For figures that have solid area (e.g., density; box; bar; violin plots; etc.), use <code>scale_fill</code></li>
<li>For figures that have continuous changes (e.g., line and scatter plots), use <code>scale_color</code></li>
</ul>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colors manually</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(gear), <span class="at">fill=</span><span class="fu">factor</span>(carb)))<span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.11-1.png" width="672" /></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg, <span class="at">color=</span><span class="fu">as.factor</span>(cyl)))<span class="sc">+</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.11-2.png" width="672" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use color scales from a package</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gameofthrones)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTICE</span><span class="co"> THAT scale_fill AND scale_color STILL APPLY TO THEIR RESPECTIVE GRAPH TYPES</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graphs</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(gear), <span class="at">fill=</span><span class="fu">factor</span>(carb)))<span class="sc">+</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_got</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">option =</span> <span class="st">&quot;Tully&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.11-3.png" width="672" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), <span class="at">fill=</span><span class="fu">factor</span>(vs)))<span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_got</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">option =</span> <span class="st">&quot;Daenerys&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.11-4.png" width="672" /></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> mpg, <span class="at">y =</span> disp, <span class="at">colour =</span> hp))<span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_got</span>(<span class="at">option =</span> <span class="st">&quot;Lannister&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.11-5.png" width="672" /></p>
<p>“Fill” graphs also come with an extra option: Setting the outline color. You can change the outline of the bar/column/etc. by specifying the color inside <code>geom_x()</code></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change only the fill of the bars</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(gear), <span class="at">fill=</span><span class="fu">factor</span>(carb)))<span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.12-1.png" width="672" /></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the outline of the bars by adding color inside the geom_bar() command</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(gear), <span class="at">fill=</span><span class="fu">factor</span>(carb)))<span class="sc">+</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.12-2.png" width="672" /></p>
</div>
<div id="more-options-with-the-see-package" class="section level3" number="8.6.2">
<h3 number="8.6.2"><span class="header-section-number">8.6.2</span> More options with the see package</h3>
<p>See <a href="http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually">this link</a> for setting color gradients for continuous variables, or using other custom color palattes like the <code>gameofthrones</code> package.</p>
<p>Check out the <a href="https://easystats.github.io/see/articles/seecolorscales.html#overview-of-palette-colors-1">see package</a> for some good color scales; the commands for which are <a href="https://easystats.github.io/see/reference/index.html#section-geoms">here</a>.</p>
<p>Incidentally, see is great not only for regular ggplot graphs, but also Bayesian stats graphs <a href="https://easystats.github.io/see/articles/bayestestR.html#introduction-1">link</a>; effect size graphs <a href="https://easystats.github.io/see/articles/effectsize.html">link</a>; correlation graphs <a href="https://easystats.github.io/see/articles/correlation.html">link</a>; and more.</p>
</div>
</div>
<div id="other-aesthetic-mappings" class="section level2" number="8.7">
<h2 number="8.7"><span class="header-section-number">8.7</span> Other aesthetic mappings</h2>
<p><code>shape()</code> controls the shapes on the graph
<code>alpha()</code> controls transparency
<code>size()</code> controls size</p>
<p>Note again that if you want it to change by variable, it goes <strong>INSIDE</strong> <code>aes()</code>; but if you want to set it manually for the whole graph, it goes in <code>geom_x()</code></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># shape</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp, <span class="at">shape=</span><span class="fu">as.factor</span>(cyl)))<span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp))<span class="sc">+</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">23</span>)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co"># transparency</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp, <span class="at">alpha=</span>hp))<span class="sc">+</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co"># size</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp, <span class="at">size=</span>cyl))<span class="sc">+</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</div>
<div id="adding-and-customizing-text" class="section level2" number="8.8">
<h2 number="8.8"><span class="header-section-number">8.8</span> Adding and Customizing Text</h2>
<div id="add-a-title-axis-labels-and-captions" class="section level3" number="8.8.1">
<h3 number="8.8.1"><span class="header-section-number">8.8.1</span> Add a title, axis labels, and captions</h3>
<p>All three can be added with <code>labs()</code>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>cyl))<span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">colour=</span><span class="st">&quot;gray&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ages of Survey Respondants by Group&quot;</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Age Group&quot;</span>,</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Note. Younger= ages 11-29; Older= ages 30-86.&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.17-1.png" width="672" /></p>
</div>
<div id="center-graph-title" class="section level3" number="8.8.2">
<h3 number="8.8.2"><span class="header-section-number">8.8.2</span> Center graph title</h3>
<p>Add the line <code>theme(plot.title = element_text(hjust = 0.5))</code></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>cyl))<span class="sc">+</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">colour=</span><span class="st">&quot;gray&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ages of Survey Respondants by Group&quot;</span>,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Age Group&quot;</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Note. Younger= ages 11-29; Older= ages 30-86.&quot;</span>)<span class="sc">+</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.18-1.png" width="672" /></p>
</div>
<div id="use-different-fonts" class="section level3" number="8.8.3">
<h3 number="8.8.3"><span class="header-section-number">8.8.3</span> Use different fonts</h3>
<p>See tutorial on <a href="https://www-r--bloggers-com.cdn.ampproject.org/v/s/www.r-bloggers.com/2021/07/using-different-fonts-with-ggplot2/amp/?amp_gsa=1&amp;amp_js_v=a6&amp;usqp=mq331AQIKAGwASCAAgM%3D#amp_tf=From%20%251%24s&amp;aoh=16259111950507&amp;csi=0&amp;referrer=https%3A%2F%2Fwww.google.com&amp;ampshare=https%3A%2F%2Fwww.r-bloggers.com%2F2021%2F07%2Fusing-different-fonts-with-ggplot2%2F">this web page</a></p>
<p>Or, use the <code>extrafont</code> package, and set everything using the <code>theme()</code> command.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize new groups</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device=</span><span class="st">&quot;win&quot;</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>cyl))<span class="sc">+</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">colour=</span><span class="st">&quot;gray&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ages of Survey Respondants by Group&quot;</span>,</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Age Group&quot;</span>,</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Note. Younger= ages 11-29; Older= ages 30-86.&quot;</span>)<span class="sc">+</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">family =</span> <span class="st">&quot;Courier New&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">family =</span> <span class="st">&quot;Calibri&quot;</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">&quot;Courier New&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.19-1.png" width="672" /></p>
</div>
</div>
<div id="remove-gridlines" class="section level2" number="8.9">
<h2 number="8.9"><span class="header-section-number">8.9</span> Remove gridlines</h2>
<p>Add <code>theme(panel.grid = element_blank())</code></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>cyl))<span class="sc">+</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">colour=</span><span class="st">&quot;gray&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ages of Survey Respondants by Group&quot;</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Age Group&quot;</span>,</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">&quot;Note. Younger= ages 11-29; Older= ages 30-86.&quot;</span>)<span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">family =</span> <span class="st">&quot;Courier New&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">family =</span> <span class="st">&quot;Calibri&quot;</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,<span class="at">size =</span> <span class="dv">14</span>, <span class="at">family =</span> <span class="st">&quot;Courier New&quot;</span>))<span class="sc">+</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/7.20-1.png" width="672" /></p>
</div>
<div id="faceting" class="section level2" number="8.10">
<h2 number="8.10"><span class="header-section-number">8.10</span> Faceting</h2>
<p>This is dividing one plot into subplots, in order to communicate relationships better.
Again, this is just a single extra command, this time at the end of the code: facet_wrap(~columnhead)
The tilde sign in R means “by”, as in “divide (something) by this”</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;temp&quot;</span>)</span></code></pre></div>
<p>This line produces a graph of population and life expectency, breaking it down to make a separate graph per each continent</p>
</div>
<div id="log-transformations" class="section level2" number="8.11">
<h2 number="8.11"><span class="header-section-number">8.11</span> Log transformations</h2>
<p>Sometimes when your data is really squished together on a graph it is hard to read. In this case, log transformations are really helpful, to change the scale of the data.</p>
<p>For example, by multiplying all your points by 10x</p>
<p>To create a log transformation of the same scatter plot above, add one extra bit: scale_x_log10()</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;temp&quot;</span>)</span></code></pre></div>
<p>You can also make both axis be logged by adding +scale again for y</p>
</div>
<div id="changing-the-scale-of-the-axis" class="section level2" number="8.12">
<h2 number="8.12"><span class="header-section-number">8.12</span> Changing the scale of the axis</h2>
<p>Add <code>coord_cartesian(xlim = c(lower,upper))</code></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;temp&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;temp&quot;</code></pre>
</div>
<div id="add-a-regression-line" class="section level2" number="8.13">
<h2 number="8.13"><span class="header-section-number">8.13</span> Add a regression line</h2>
<p>Add the line <code>geom_smooth(method = "lm", formula = y ~ x)</code></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span> mpg, <span class="at">y=</span>hp, <span class="at">color=</span>mpg))<span class="sc">+</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/chapter_7_end-1.png" width="672" /></p>
<!--chapter:end:07-ggplot.Rmd-->
</div>
</div>
<div id="making-tables-with-flextable" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> Making Tables with flextable</h1>
<p>NOTES:
- <strong>j</strong> refers to the column
- <strong>i</strong> refers to the row number</p>
<div id="apa-table-components" class="section level2" number="9.1">
<h2 number="9.1"><span class="header-section-number">9.1</span> APA Table Components</h2>
</div>
<div id="indent-values" class="section level2" number="9.2">
<h2 number="9.2"><span class="header-section-number">9.2</span> Indent values</h2>
<p><a href="https://davidgohel.github.io/flextable/reference/padding.html" class="uri">https://davidgohel.github.io/flextable/reference/padding.html</a>
<a href="https://stackoverflow.com/questions/64134725/indentation-in-the-first-column-of-a-flextable-object" class="uri">https://stackoverflow.com/questions/64134725/indentation-in-the-first-column-of-a-flextable-object</a></p>
<p>Use the <code>padding</code> function:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">padding</span>(ft, <span class="at">i=</span><span class="dv">2</span>, <span class="at">j=</span><span class="dv">1</span>, <span class="at">padding.left=</span><span class="dv">20</span>)</span></code></pre></div>
</div>
<div id="add-a-horizontal-border-aka-horizontal-spanner" class="section level2" number="9.3">
<h2 number="9.3"><span class="header-section-number">9.3</span> Add a Horizontal border (AKA horizontal “spanner”)</h2>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hline</span>(., <span class="at">i=</span><span class="dv">4</span>, <span class="at">j=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>)</span></code></pre></div>
</div>
<div id="change-font-and-font-size" class="section level2" number="9.4">
<h2 number="9.4"><span class="header-section-number">9.4</span> Change font and font size</h2>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>  glm_table<span class="ot">&lt;-</span>flextable<span class="sc">::</span><span class="fu">font</span>(glm_table, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>, <span class="at">fontname =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># Font</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">fontsize</span>(., <span class="at">size =</span> <span class="dv">11</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="co"># Font size</span></span></code></pre></div>
</div>
<div id="grouped-table" class="section level2" number="9.5">
<h2 number="9.5"><span class="header-section-number">9.5</span> Grouped table</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>cars<span class="ot">=</span><span class="fu">rownames_to_column</span>(mtcars, <span class="at">var =</span> <span class="st">&quot;Model&quot;</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span>flextable<span class="sc">::</span><span class="fu">as_grouped_data</span>(<span class="at">x=</span>cars, <span class="at">groups =</span> <span class="fu">c</span>(<span class="st">&quot;cyl&quot;</span>))</span></code></pre></div>
</div>
<div id="complete-example" class="section level2" number="9.6">
<h2 number="9.6"><span class="header-section-number">9.6</span> Complete Example</h2>
<!--chapter:end:08-tables.Rmd-->
</div>
</div>
<div id="misc.-stuff" class="section level1" number="10">
<h1 number="10"><span class="header-section-number">10</span> Misc. Stuff</h1>
<div id="scrape-web-pages-for-data-tables" class="section level2" number="10.1">
<h2 number="10.1"><span class="header-section-number">10.1</span> Scrape web pages for data tables</h2>
<p><em>Note. See Chapter 10’s example <code>purrr</code> walk through for a guide on how to scrape multiple web tables simultaneously</em></p>
<p><em>Simple example.</em></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>html<span class="ot">=</span><span class="fu">read_html</span>(<span class="st">&#39;https://shop.tcgplayer.com/price-guide/pokemon/base-set&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>html</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 101 x 6
##    PRODUCT   Rarity    Number `Market Price` `Listed Median` ``   
##    &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;           &lt;chr&gt;
##  1 Abra      Common        43 $0.54          $0.70           View 
##  2 Alakazam  Holo Rare      1 $26.98         —               View 
##  3 Arcanine  Uncommon      23 $1.99          $2.09           View 
##  4 Beedrill  Rare          17 $2.92          $2.72           View 
##  5 Bill      Common        91 $0.49          $0.49           View 
##  6 Blastoise Holo Rare      2 $101.89        —               View 
##  7 Bulbasaur Common        44 $1.92          $2.68           View 
##  8 Caterpie  Common        45 $0.50          $0.60           View 
##  9 Chansey   Holo Rare      3 $15.84         —               View 
## 10 Charizard Holo Rare      4 $351.09        —               View 
## # ... with 91 more rows</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saved as a list by default. Now extract your table from said list</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>html<span class="ot">=</span><span class="fu">as_tibble</span>(html[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="co"># find out which number it is in the list</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">select</span>(<span class="st">&#39;PRODUCT&#39;</span>,<span class="st">&#39;Rarity&#39;</span>,<span class="st">&#39;Number&#39;</span>,<span class="st">&#39;Market Price&#39;</span>)) <span class="co"># if needed, specify which columns you want too</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>html</span></code></pre></div>
<pre><code>## # A tibble: 101 x 4
##    PRODUCT   Rarity    Number `Market Price`
##    &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;         
##  1 Abra      Common        43 $0.54         
##  2 Alakazam  Holo Rare      1 $26.98        
##  3 Arcanine  Uncommon      23 $1.99         
##  4 Beedrill  Rare          17 $2.92         
##  5 Bill      Common        91 $0.49         
##  6 Blastoise Holo Rare      2 $101.89       
##  7 Bulbasaur Common        44 $1.92         
##  8 Caterpie  Common        45 $0.50         
##  9 Chansey   Holo Rare      3 $15.84        
## 10 Charizard Holo Rare      4 $351.09       
## # ... with 91 more rows</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove $ symbol in Price column to make it easier to work with</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>html<span class="sc">$</span><span class="st">`</span><span class="at">Market Price</span><span class="st">`</span><span class="ot">=</span><span class="fu">str_remove</span>(html<span class="sc">$</span><span class="st">`</span><span class="at">Market Price</span><span class="st">`</span>, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">$&quot;</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>html<span class="ot">=</span>html <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Market Price</span><span class="st">`</span><span class="ot">=</span><span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Market Price</span><span class="st">`</span>)) <span class="co"># convert from string to numeric</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co"># view finished table</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(html)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   PRODUCT   Rarity    Number `Market Price`
##   &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt;          &lt;dbl&gt;
## 1 Abra      Common        43           0.54
## 2 Alakazam  Holo Rare      1          27.0 
## 3 Arcanine  Uncommon      23           1.99
## 4 Beedrill  Rare          17           2.92
## 5 Bill      Common        91           0.49
## 6 Blastoise Holo Rare      2         102.</code></pre>
<p><strong><em>Slightly more complicated example</em></strong></p>
<p>Reading a table into R takes a few steps.</p>
<p>Step 1 is to copy and paste the URL into the <code>read_html()</code> verb like below:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rvest, tidyverse)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>exonerations_table<span class="ot">=</span><span class="fu">read_html</span>(<span class="st">&quot;https://www.law.umich.edu/special/exoneration/Pages/detaillist.aspx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table.ms-listviewtable&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Sometimes if the web page is extremely basic and pretty much the only thing on it is a table, you can stop there. Most of the time though, there will be tons of other stuff on the website and you need to get more specific so R can find the table. This is the <code>html_nodes()</code> part of the above command; in there you specify the exact part of the web page where the table is located/what object file it is.</p>
<p>To find this you will need to use the Developer mode in your browser. See this screenshot for an example…</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;scrape.png&quot;</span>))</span></code></pre></div>
<p>In Firefox you open this by going to Settings &gt; More Tools &gt; Web Developer Tools (or CNTRL + Shift + I).</p>
Begin by looking through the console in the center bottom for names that look like they would be related to your table. A good place to start might be "
<body>
<p>", which contains the main body of the web page. Click on a name to expand it and see all the elements on the page contained there.</p>
<p>Ultimately what you’re looking for is what you see above: an element that, when selected, highlights ONLY the area of the web page you’re looking for. To get at this you will need to keep expanding, highlighting, and clicking repeatedly….it can take some digging.</p>
<p>Keep drilling down through page elements until you find the one that highlights the table and just the table. When you find this, look for the <strong>.ms file</strong> in that name; you should also see this in the smaller console box on the right. That is the file you’ll need. Write that name in the <code>html_node</code> command and read it into R.</p>
<p>That’s stage 1. From here you now need to clean up the table.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>exonerations_table<span class="ot">=</span><span class="fu">as.data.frame</span>(exonerations_table) <span class="co"># convert into a df</span></span></code></pre></div>
<p>Your table might be different, but this one’s names were messed up when read in, so lets fix those first and then fix the rows and columns.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the names to a vector</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>table_names<span class="ot">=</span>exonerations_table<span class="sc">$</span>Last.Name[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim out the garbage rows and columns</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>exonerations_table<span class="ot">=</span>exonerations_table <span class="sc">%&gt;%</span> </span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Last.Name<span class="sc">:</span>Tags<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">22</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co"># over-write incorrect col names with the vector of correct ones we saved above</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(exonerations_table)<span class="ot">=</span>table_names</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up names</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>exonerations_table<span class="ot">=</span>exonerations_table <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="co"># verify structure of columns is correct</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse(exonerations_table)</span></span></code></pre></div>
<p>Yikes, a lot of stuff is stored incorrectly, and as a result there’s some missing values that need to be addressed and other data that needs to be corrected.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>exonerations_table<span class="ot">=</span><span class="fu">as_tibble</span>(exonerations_table) <span class="sc">%&gt;%</span> <span class="co"># convert to tibble</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(dna,mwid<span class="sc">:</span>ild), na_if,<span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># turn missing values into NA&#39;s</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(dna,mwid<span class="sc">:</span>ild), replace_na, <span class="st">&quot;derp&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># replace NA&#39;s with a string (required for the next lines to work)</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dna=</span><span class="fu">ifelse</span>(dna<span class="sc">==</span><span class="st">&quot;DNA&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co"># change these variables from text to numeric to better facilitate analysis</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mwid=</span><span class="fu">ifelse</span>(mwid<span class="sc">==</span><span class="st">&quot;MWID&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fc=</span><span class="fu">ifelse</span>(fc<span class="sc">==</span><span class="st">&quot;FC&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_fa=</span><span class="fu">ifelse</span>(p_fa<span class="sc">==</span><span class="st">&quot;P/FA&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_mfe=</span><span class="fu">ifelse</span>(f_mfe<span class="sc">==</span><span class="st">&quot;F/MFE&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(st, crime, dna<span class="sc">:</span>f_mfe),factor)) <span class="co"># correct form by converting to factors</span></span></code></pre></div>
<p>And that’s it! Check out final result!</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(exonerations_table)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 20
##   last_name first_name   age race  st    county_of_crime tags  om_tags crime sentence convicted exonerated dna   x     mwid 
##   &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt; &lt;chr&gt; &lt;fct&gt; &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;   &lt;fct&gt; &lt;chr&gt;        &lt;int&gt;      &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Abbitt    Joseph        31 Black NC    Forsyth         CV, ~ &quot;&quot;      Chil~ Life          1995       2009 1     &quot;&quot;    1    
## 2 Abdal     Warith Ha~    43 Black NY    Erie            IO, ~ &quot;OF, W~ Sexu~ 20 to L~      1983       1999 1     &quot;&quot;    1    
## 3 Abernathy Christoph~    17 White IL    Cook            CIU,~ &quot;OF, W~ Murd~ Life wi~      1987       2015 1     &quot;&quot;    0    
## 4 Abney     Quentin       32 Black NY    New York        CV    &quot;&quot;      Robb~ 20 to L~      2006       2012 0     &quot;&quot;    1    
## 5 Acero     Longino       35 Hisp~ CA    Santa Clara     NC, P &quot;&quot;      Sex ~ 2 years~      1994       2006 0     &quot;&quot;    0    
## 6 Adams     Anthony       26 Hisp~ CA    Los Angeles     H, P  &quot;OF, W~ Mans~ 12 years      1996       2001 0     &quot;&quot;    0    
## # ... with 5 more variables: fc &lt;fct&gt;, p_fa &lt;fct&gt;, f_mfe &lt;fct&gt;, om &lt;chr&gt;, ild &lt;chr&gt;</code></pre>
<p>Check out <a href="https://www.dataquest.io/blog/web-scraping-in-r-rvest/">this page</a> for a quick overview.</p>
</div>
<div id="read-spss-files-into-r" class="section level2" number="10.2">
<h2 number="10.2"><span class="header-section-number">10.2</span> Read SPSS files into R</h2>
<p>Use <code>foreign::read.spss</code></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>spss_version<span class="ot">=</span>foreign<span class="sc">::</span><span class="fu">read.spss</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;JLWOP&quot;</span>, <span class="st">&quot;Data and Models&quot;</span>, <span class="st">&quot;JLWOP_RYAN.sav&quot;</span>), <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Might also want to add <code>as_tibble()</code> on the end.</p>
</div>
<div id="turn-numbers-into-percentages" class="section level2" number="10.3">
<h2 number="10.3"><span class="header-section-number">10.3</span> Turn numbers into percentages</h2>
<p>Use <code>scales::percent()</code>, which converts normal numbers into percentages and includes the percent sign (%) afterwards</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>simple_table<span class="ot">=</span><span class="fu">tribble</span>(<span class="sc">~</span>n_people, <span class="sc">~</span>votes_in_favor,</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">25</span>, <span class="dv">14</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>simple_table<span class="ot">=</span>simple_table <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">percent_voted_for=</span>scales<span class="sc">::</span><span class="fu">percent</span>(votes_in_favor<span class="sc">/</span>n_people, <span class="at">accuracy =</span> <span class="fl">0.1</span>, <span class="at">scale =</span> <span class="dv">100</span>))</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>simple_table</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   n_people votes_in_favor percent_voted_for
##      &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;            
## 1       25             14 56.0%</code></pre>
<p>Scale is what to multiple the original number by (e.g., convert 0.05 to 5% by x100) Accuracy controls how many places out the decimal goes</p>
</div>
<div id="find-all-possible-combindations-of-items-in-a-vector" class="section level2" number="10.4">
<h2 number="10.4"><span class="header-section-number">10.4</span> Find all possible combindations of items in a vector</h2>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">combn</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>),<span class="dv">2</span>) <span class="co"># find all possible combinations of these numbers, drawn two at a time</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    2    2    2    4    4    6
## [2,]    4    6    8    6    8    8</code></pre>
</div>
<div id="download-files-from-the-internet" class="section level2" number="10.5">
<h2 number="10.5"><span class="header-section-number">10.5</span> Download files from the internet</h2>
</div>
<div id="print-multiple-things-in-one-statement" class="section level2" number="10.6">
<h2 number="10.6"><span class="header-section-number">10.6</span> Print multiple things in one statement</h2>
<p>Use <code>cat()</code> from base R</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The p-value dropped below 0.05 for the first time as sample size&quot;</span>, <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## The p-value dropped below 0.05 for the first time as sample size 100</code></pre>
<!--chapter:end:09-misc.Rmd-->
</div>
</div>
<div id="intermediate-r-functions-loops-and-iterative-programming" class="section level1" number="11">
<h1 number="11"><span class="header-section-number">11</span> Intermediate R: Functions, Loops, and Iterative Programming</h1>
<div id="functions" class="section level2" number="11.1">
<h2 number="11.1"><span class="header-section-number">11.1</span> Functions</h2>
<p>A function is a command that performs a specified operation and returns
an output in accordance with that operation. You can literally make a
function to do anything you want.</p>
<p><em>General structure of a basic function:</em></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example structure</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>Function_name<span class="ot">=</span><span class="cf">function</span>(argument){</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  Expressions</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><em>Argument</em> is your input. It is the thing you want to perform the
operation on.</li>
<li><em>Expressions</em> is the actual operation (or operations) you want to
perform on the supplied argument</li>
<li><em>return</em> tells R to return the result of the Expression to you when
done.</li>
</ul>
<p>This example function takes an input of numbers in the form of a vector
and subtracts two from each.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>numbers<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">80</span>)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>sub_2<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  result<span class="ot">=</span> x <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sub_2</span>(numbers)</span></code></pre></div>
<pre><code>## [1]  0  8 10 78</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sub_2</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<p>One of the primary advantages of functions are that they can reduce a
complex process or a process that involves many steps down into a single
line of code; thus, creating your own functions is a fast way to make
your life easier down the line either at some point in the far future or
even in just a few minutes, if you know you will be writing the code for
some process two or more times.</p>
<p>Take this script for instance. You can see from the circled parts that I
needed to transform three different data sets in a similar way:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;repeat_process.jpg&quot;</span>))</span></code></pre></div>
<p><img src="pics/repeat_process.jpg" width="413" /></p>
<p>Copying and pasting the code and tweaking it originally worked….but
this method can make the script needlessly long and harder to read
later, and more tedious to write or for coauthors/collaborators to sift
through, and importantly, increases your chances of making an error.
Better to write a single function that could be applied to all three….</p>
<p><strong><em>In short, use functions to reduce a multi-step process or a process
that you’re implementing &gt;=2 times in a single script into one command.
This saves you space and makes the script shorter; it saves you the
trouble and effort of re-writing or adapting code from earlier sections;
and importantly, reduces the chances of you making a coding error by
proxy of the former two.</em></strong> As a quick example, I replaced each of the
circled paragraphs of code above with a custom function that ran
everything in one simple line. Instead of 3 paragraphs, I now had 3
lines that looked like this:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>na_zero_helpreint<span class="ot">=</span><span class="fu">rotate_data</span>(<span class="at">data =</span> na_zero_helpreint, <span class="at">variable_prefix =</span> <span class="st">&quot;reintegrate_&quot;</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>na_blank<span class="ot">=</span><span class="fu">rotate_data</span>(<span class="at">data =</span> na_zero_helpreint, <span class="at">variable_prefix =</span> <span class="st">&quot;barrier_&quot;</span>)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>na_zero<span class="ot">=</span><span class="fu">rotate_data</span>(<span class="at">data =</span> na_zero_helpreint, <span class="at">variable_prefix =</span> <span class="st">&quot;barrier_&quot;</span>)</span></code></pre></div>
<p><strong>Limitations to your average, everyday functions.</strong> While reducing a
whole <em>process or sequence</em> of commands is extremely useful, it still
leaves a limitation. For instance, while we avoided copying and pasting
whole paragraphs or processes, I still had to copy-paste the same
function three times. This still leaves chances for error on the table,
and it still leaves us with wasted lines that make the script longer.</p>
<p>In general, when you want to perform some function or process <strong>multiple
times on multiple items (as above where the same command is used three
times on three different data frames)</strong>, you need to use a for-loop or
iterating function. These can reduce further unwanted redundancies by
applying the function or process iteratively. Read on for more info.</p>
</div>
<div id="for-loops" class="section level2" number="11.2">
<h2 number="11.2"><span class="header-section-number">11.2</span> For-loops</h2>
<p>A for loop is essentially a function that applies a function or given
set of operations to multiple things at once, and returns an output of
many items.</p>
<p>For example, this code finds the means of every vector/column in a
dataset by repeatedly applying the same code over and over to element
“i” in the given list:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">ncol</span>(df))  <span class="co"># 1.Output. Create the object you want the results of the loop stored in.</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df)) {            <span class="co"># 2.Sequence of operations. &quot;For each item &#39;i&#39; along data frame…&quot;</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>  output[[i]] <span class="ot">&lt;-</span> <span class="fu">median</span>(df[[i]])      <span class="co"># 3.Body:&quot;every individual item in &#39;output&#39; = the median of each col in df</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>## [1]  0.3771802 -0.5176346  0.4171879  0.5704655</code></pre>
<p>Check out <a href="https://r4ds.had.co.nz/iteration.html#mapping-over-multiple-arguments">this book
chapter</a>
for a great and detailed explanation of for-loops and functional coding.</p>
<p>Although for loops are nice, they are unwieldy. R programmers typically
use iterating functions instead. Examples of iterating functions are the
<code>lapply</code>, <code>vapply</code>, <code>sapply</code>, etc. family of base R commands. But these can
also be confusing and the commands are not great.</p>
<p>The purrr package offers a better way to do iterating functions over
base R; it’s the tidyverse way to make efficient and understandable for
loops! <strong>If you have a need for a for-loop for something, see the next
section instead on how to use purrr to make an iterative function.
Important to understand conceptually what a for-loop is, but using them
is impractical when you have purrr</strong></p>
</div>
</div>
<div id="purrr-and-iterative-functions" class="section level1" number="12">
<h1 number="12"><span class="header-section-number">12</span> purrr and Iterative Functions</h1>
<p><em>All notes here come from Charlotte Wickham’s lecture tutorial below</em></p>
<ul>
<li>Part 1: <a href="https://www.youtube.com/watch?v=7UlWJWfZO9M" class="uri">https://www.youtube.com/watch?v=7UlWJWfZO9M</a></li>
<li>Part 2: <a href="https://www.youtube.com/watch?v=b0ozKTUho0A&amp;t=1210s" class="uri">https://www.youtube.com/watch?v=b0ozKTUho0A&amp;t=1210s</a></li>
</ul>
<p>purrr’s <code>map()</code> series of functions offer a way to apply any existing
function (even functions you’ve made) to multiple things at once, be it
lists, data frame columns, individual items in vector, etc. In short,
they are for doing the same type of task repeatedly in a very quick and
efficient manner. They work in much the same way as for-loops, but are
far simpler to write, and can be applied in the same way to solve the
same problems.</p>
<p><strong><em>How to use purrr</em></strong></p>
<p>The structure of <code>map()</code> commands is the same as the others in the
tidyverse:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#option 1</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(data, <span class="cf">function</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># option 2</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="cf">function</span>)</span></code></pre></div>
<p>As a quick example and to highlight why purrr is so much more efficient
and easier to use than for-loops, look at the same example from before,
now using <code>map()</code> instead of a <code>for</code>:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(median)</span></code></pre></div>
<pre><code>##          a          b          c          d 
##  0.3771802 -0.5176346  0.4171879  0.5704655</code></pre>
<p>A single line is all it took to get the same results! And, it follows
tidyverse grammar structure.</p>
<p>Now lets get into how it works….</p>
<p><em>map() commands work like this:</em> For each element of x, do f.</p>
<p>So if you pass it object <code>x</code> and object <code>x</code> is….
- A vector, it will perform function f on every item in the vector
- A data frame, it will perform function f on every <em>column</em> in the data frame
- A list, it will perform function f on every <em>level in the list</em></p>
<p>Etc., etc.; the point is it applies a function repeatedly to every
element in the object you supply it with.</p>
<p>So lets walk through a case example.</p>
<div id="reproducible-example" class="section level2" number="12.1">
<h2 number="12.1"><span class="header-section-number">12.1</span> Reproducible example</h2>
<p>This is an example walk through showing how we can use <code>purrr</code> to speed
things up dramatically and/or reduce the use of unwanted, extra code in
our scripts. In this guide I’ll be building a table of LPGA Tour
statistics from multiple webpages.</p>
<p>The workflow for purrr goes like this:</p>
<p>First, you want to figure out how to do each step of your process
line-by-line, for a single item. The idea is to try and walk through
each step of the process and see exactly what will need to be done each
each step and what the code will like, before trying to code it all at
once at a higher level.</p>
<p>Once you have each step for the first item figured out, then you make functions
for each step that condense that code down to one command.</p>
<p>Lastly, apply each function from your individual steps to all items in
your list by using <code>purr::map()</code>.</p>
<p><strong><em>Do for One</em></strong></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 1</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure out a line-by-line process for one item/one single web page</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>html1<span class="ot">=</span><span class="fu">read_html</span>(<span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=04&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table.shsTable.shsBorderTable&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">header=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(html1)</span></code></pre></div>
<pre><code>##   rank                 name distance
## 1    1         Anne van Dam  290.822
## 2    2   Bianca Pagdanganan  284.846
## 3    3          Maria Fassi  279.784
## 4    4        Lexi Thompson  278.353
## 5    5            A Lim Kim  276.762
## 6    6 Nanna Koerstz Madsen  276.580</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 2</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a custom function of the above to shorten and generalize the process</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>quick_read_html<span class="ot">=</span><span class="cf">function</span>(url){</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  web_page<span class="ot">=</span><span class="fu">read_html</span>(url) <span class="sc">|&gt;</span> </span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table.shsTable.shsBorderTable&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># fortunately this node works for all four pages so it can be baked into the function</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(web_page)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="co"># test to verify it works</span></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span><span class="fu">quick_read_html</span>(<span class="at">url=</span> <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=08&quot;</span>) </span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(test) <span class="co"># nice </span></span></code></pre></div>
<pre><code>##   rank          name putt_average
## 1    1      Lydia Ko        1.721
## 2    2    Inbee Park        1.724
## 3    3  Hannah Green        1.730
## 4    4     Yuka Saso        1.732
## 5    5 Jeong Eun Lee        1.740
## 6    6  Jin Young Ko        1.741</code></pre>
<p><strong><em>DO FOR ALL.</em></strong>
Now create the object that contains all the elements you want to iterate over, and then pass it to your generalized function with map.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3a</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create an object that contains ALL elements of interest</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>URLs<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=04&quot;</span>,</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=08&quot;</span>,</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=06&quot;</span>,</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=12&quot;</span>)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use the power of map and be amazed</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>lpga_data<span class="ot">=</span> URLs <span class="sc">|&gt;</span> <span class="fu">map</span>(quick_read_html)</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lpga_data)</span></code></pre></div>
<pre><code>## [[1]]
##     rank                   name distance
## 1      1           Anne van Dam  290.822
## 2      2     Bianca Pagdanganan  284.846
## 3      3            Maria Fassi  279.784
## 4      4          Lexi Thompson  278.353
## 5      5              A Lim Kim  276.762
## 6      6   Nanna Koerstz Madsen  276.580
## 7      7            Nelly Korda  275.121
## 8      8      Patty Tavatanakit  274.703
## 9      9       Brooke Henderson  274.280
## 10    10          Jessica Korda  273.857
## 11    11      Madelene Sagstrom  273.580
## 12    12              Yuka Saso  271.953
## 13    13             Gaby Lopez  270.925
## 14    14           Alana Uriell  269.473
## 15    15         Cydney Clanton  269.321
## 16    16         Nuria Iturrioz  268.773
## 17    17    Nicole Broch Larsen  268.267
## 18    18               Mel Reid  267.587
## 19    19        Carlota Ciganda  267.536
## 20    20       Elizabeth Szokol  267.504
## 21    21           Hannah Green  267.446
## 22    22          Sei Young Kim  267.424
## 23    23           Charley Hull  266.429
## 24    24           Linnea Strom  266.412
## 25    25            Alena Sharp  266.364
## 26    26        Jennifer Kupcho  265.866
## 27    27            Yealimi Noh  265.413
## 28    28             Ally Ewing  264.959
## 29    29           Georgia Hall  264.804
## 30    30        Elizabeth Nagel  264.353
## 31    31         Hee Young Park  264.314
## 32    32          Ryann O&#39;Toole  263.978
## 33    33             Alison Lee  263.908
## 34    34       Perrine Delacour  263.659
## 35    35        Daniela Darquea  263.577
## 36    36     Brittany Lincicome  263.343
## 37    37              Ana Belac  263.296
## 38    38         Sung Hyun Park  263.245
## 39    39       Jaye Marie Green  263.104
## 40    40         Katherine Kirk  262.783
## 41    41             Minjee Lee  262.707
## 42    42       Ariya Jutanugarn  262.356
## 43    43        Giulia Molinaro  261.807
## 44    44                 Yu Liu  261.793
## 45    45      Albane Valenzuela  261.788
## 46    46          Jeong Eun Lee  261.646
## 47    47   Pajaree Anannarukarn  261.642
## 48    48          Celine Herbin  261.566
## 49    49   Benyapa Niphatsophon  261.550
## 50    50           Mi Hyang Lee  261.420
## 51    51               Amy Yang  261.387
## 52    52               Xiyu Lin  261.192
## 53    53           Nasa Hataoka  260.675
## 54    54           Lindy Duncan  260.647
## 55    55         Maia Schechter  260.511
## 56    56          Jennifer Song  260.316
## 57    57           Austin Ernst  260.141
## 58    58           Sophia Popov  260.008
## 59    59             Jenny Shin  259.849
## 60    60           Maria Torres  259.629
## 61    61              Angel Yin  259.563
## 62    62             Jaclyn Lee  259.419
## 63    63            Haley Moore  259.316
## 64    64               Lydia Ko  259.208
## 65    65      Pernilla Lindberg  259.188
## 66    66             Paula Reto  259.157
## 67    67       Stephanie Meadow  258.912
## 68    68        Lauren Coughlin  258.819
## 69    69       Esther Henseleit  258.774
## 70    70          Brittany Lang  258.568
## 71    71           Jin Young Ko  258.403
## 72    72              Kelly Tan  258.403
## 73    73          Gerina Piller  258.367
## 74    74            Luna Sobron  258.183
## 75    75      Lauren Stephenson  258.129
## 76    76        Matilda Castren  257.798
## 77    77         Dani Holmqvist  257.354
## 78    78           Jeongeun Lee  256.698
## 79    79              Amy Olson  256.455
## 80    80           Laura Davies  256.055
## 81    81     Jodi Ewart Shadoff  255.875
## 82    82           Cristie Kerr  255.778
## 83    83                Min Lee  255.542
## 84    84          Leona Maguire  255.418
## 85    85            In Gee Chun  255.233
## 86    86       Wichanee Meechai  255.110
## 87    87             Su-Hyun Oh  254.980
## 88    88            Hyo Joo Kim  254.833
## 89    89         Celine Boutier  254.827
## 90    90          Sarah Burnham  254.773
## 91    91        Angela Stanford  254.630
## 92    92            Marina Alex  254.538
## 93    93            So Yeon Ryu  254.231
## 94    94       Pavarisa Yoktuan  254.215
## 95    95         Gemma Dryburgh  254.088
## 96    96        Sarah Schmelzel  253.866
## 97    97         Anna Nordqvist  253.551
## 98    98          Jenny Coleman  253.299
## 99    99             Eun-Hee Ji  252.993
## 100  100          Danielle Kang  252.905
## 101  101      Moriya Jutanugarn  252.899
## 102  102               Jing Yan  252.823
## 103  103         Jennifer Chang  252.709
## 104  104            Megan Khang  252.265
## 105  105           Tiffany Chan  252.000
## 106  106 Katherine Perry-Hamski  251.966
## 107  107       Sarah Jane Smith  251.826
## 108  108                Muni He  251.768
## 109  109             Annie Park  251.689
## 110  110        Caroline Masson  251.613
## 111  111         Ashleigh Buhai  251.472
## 112  112              Mirim Lee  251.352
## 113  113            Mi Jung Hur  251.268
## 114  114        Kristen Gillman  251.207
## 115  115          Azahara Munoz  250.869
## 116  116    Jasmine Suwannapura  250.846
## 117  117      Mariah Stackhouse  250.778
## 118  118           Na Yeon Choi  250.512
## 119  119        Caroline Inglis  250.324
## 120  120          Christina Kim  249.750
## 121  121         Lindsey Weaver  249.669
## 122  122       Suzuka Yamaguchi  249.543
## 123  123            Haru Nomura  249.535
## 124  124              Jane Park  249.392
## 125  125           Mina Harigae  248.986
## 126  126           Min Seo Kwak  248.649
## 127  127           Wei-Ling Hsu  248.594
## 128  128            Stacy Lewis  248.493
## 129  129            Emma Talley  248.484
## 130  130             Lauren Kim  248.424
## 131  131             Esther Lee  248.110
## 132  132      Pornanong Phatlum  248.110
## 133  133             Heaji Kang  247.520
## 134  134             Sarah Kemp  247.045
## 135  135        Cheyenne Knight  246.901
## 136  136         Ssu-Chia Cheng  246.517
## 137  137      Brittany Altomare  246.347
## 138  138             Bronte Law  246.220
## 139  139            Chella Choi  246.072
## 140  140             Brianna Do  244.776
## 141  141    Mind Muangkhumsakul  244.431
## 142  142          Lizette Salas  244.243
## 143  143     Louise Ridderstrom  243.920
## 144  144          Marissa Steen  243.843
## 145  145            Tiffany Joh  242.662
## 146  146              Lee Lopez  242.630
## 147  147       Kristy McPherson  241.942
## 148  148             Inbee Park  241.328
## 149  149             Andrea Lee  241.105
## 150  150       Jackie Stoelting  239.521
## 151  151          Dottie Ardina  237.654
## 152  152         Jillian Hollis  236.946
## 153  153            Aditi Ashok  236.945
## 154  154              Mo Martin  236.279
## 155  155       Dana Finkelstein  236.211
## 156  156           Ayako Uehara  232.250
## 
## [[2]]
##     rank                   name putt_average
## 1      1               Lydia Ko        1.721
## 2      2             Inbee Park        1.724
## 3      3           Hannah Green        1.730
## 4      4              Yuka Saso        1.732
## 5      5          Jeong Eun Lee        1.740
## 6      6           Jin Young Ko        1.741
## 7      7          Danielle Kang        1.749
## 8      8            So Yeon Ryu        1.753
## 9      9      Patty Tavatanakit        1.753
## 10    10              Angel Yin        1.757
## 11    11          Leona Maguire        1.757
## 12    12             Su-Hyun Oh        1.757
## 13    13       Ariya Jutanugarn        1.762
## 14    14            Nelly Korda        1.763
## 15    15          Jessica Korda        1.766
## 16    16           Mina Harigae        1.767
## 17    17             Alison Lee        1.769
## 18    18        Caroline Masson        1.771
## 19    19            In Gee Chun        1.771
## 20    20               Xiyu Lin        1.771
## 21    21          Sei Young Kim        1.771
## 22    22            Hyo Joo Kim        1.773
## 23    23           Charley Hull        1.773
## 24    24      Moriya Jutanugarn        1.774
## 25    25           Georgia Hall        1.775
## 26    26           Nasa Hataoka        1.778
## 27    27      Madelene Sagstrom        1.780
## 28    28             Gaby Lopez        1.783
## 29    29               Amy Yang        1.783
## 30    30         Celine Boutier        1.784
## 31    31         Gemma Dryburgh        1.785
## 32    32           Wei-Ling Hsu        1.786
## 33    33        Lauren Coughlin        1.786
## 34    34          Celine Herbin        1.789
## 35    35   Pajaree Anannarukarn        1.789
## 36    36      Brittany Altomare        1.789
## 37    37            Megan Khang        1.790
## 38    38    Nicole Broch Larsen        1.790
## 39    39            Chella Choi        1.791
## 40    40        Carlota Ciganda        1.791
## 41    41          Ryann O&#39;Toole        1.791
## 42    42       Esther Henseleit        1.792
## 43    43            Yealimi Noh        1.796
## 44    44             Paula Reto        1.797
## 45    45          Sarah Burnham        1.797
## 46    46              A Lim Kim        1.798
## 47    47         Lindsey Weaver        1.798
## 48    48            Stacy Lewis        1.798
## 49    49             Minjee Lee        1.799
## 50    50        Sarah Schmelzel        1.799
## 51    51              Ana Belac        1.800
## 52    52          Lizette Salas        1.800
## 53    53             Ally Ewing        1.801
## 54    54   Nanna Koerstz Madsen        1.801
## 55    55             Jenny Shin        1.807
## 56    56            Mi Jung Hur        1.807
## 57    57        Cheyenne Knight        1.807
## 58    58         Jillian Hollis        1.808
## 59    59           Cristie Kerr        1.809
## 60    60       Brooke Henderson        1.809
## 61    61            Aditi Ashok        1.809
## 62    62      Lauren Stephenson        1.810
## 63    63             Annie Park        1.811
## 64    64         Hee Young Park        1.812
## 65    65              Amy Olson        1.813
## 66    66            Marina Alex        1.814
## 67    67       Dana Finkelstein        1.814
## 68    68            Haru Nomura        1.815
## 69    69             Eun-Hee Ji        1.815
## 70    70         Sung Hyun Park        1.815
## 71    71       Wichanee Meechai        1.816
## 72    72         Nuria Iturrioz        1.816
## 73    73        Matilda Castren        1.817
## 74    74           Austin Ernst        1.817
## 75    75            Maria Fassi        1.818
## 76    76          Lexi Thompson        1.819
## 77    77       Elizabeth Szokol        1.820
## 78    78        Jennifer Kupcho        1.820
## 79    79           Lindy Duncan        1.821
## 80    80           Mi Hyang Lee        1.821
## 81    81          Azahara Munoz        1.822
## 82    82      Pernilla Lindberg        1.823
## 83    83                Min Lee        1.823
## 84    84    Jasmine Suwannapura        1.823
## 85    85             Sarah Kemp        1.824
## 86    86          Dottie Ardina        1.824
## 87    87             Andrea Lee        1.824
## 88    88             Heaji Kang        1.825
## 89    89              Mirim Lee        1.825
## 90    90      Albane Valenzuela        1.826
## 91    91          Jennifer Song        1.826
## 92    92         Katherine Kirk        1.826
## 93    93         Ssu-Chia Cheng        1.828
## 94    94         Ashleigh Buhai        1.829
## 95    95       Perrine Delacour        1.830
## 96    96     Bianca Pagdanganan        1.830
## 97    97            Emma Talley        1.831
## 98    98          Christina Kim        1.831
## 99    99         Anna Nordqvist        1.831
## 100  100       Kristy McPherson        1.832
## 101  101          Gerina Piller        1.832
## 102  102        Kristen Gillman        1.832
## 103  103     Brittany Lincicome        1.832
## 104  104           Min Seo Kwak        1.833
## 105  105        Caroline Inglis        1.834
## 106  106             Esther Lee        1.834
## 107  107           Tiffany Chan        1.834
## 108  108        Angela Stanford        1.837
## 109  109    Mind Muangkhumsakul        1.837
## 110  110            Luna Sobron        1.837
## 111  111     Louise Ridderstrom        1.838
## 112  112           Sophia Popov        1.838
## 113  113        Giulia Molinaro        1.838
## 114  114             Lauren Kim        1.840
## 115  115               Mel Reid        1.841
## 116  116       Stephanie Meadow        1.842
## 117  117              Lee Lopez        1.842
## 118  118       Jaye Marie Green        1.843
## 119  119      Pornanong Phatlum        1.845
## 120  120             Brianna Do        1.846
## 121  121                 Yu Liu        1.847
## 122  122           Jeongeun Lee        1.848
## 123  123               Jing Yan        1.849
## 124  124                Muni He        1.850
## 125  125           Linnea Strom        1.850
## 126  126        Elizabeth Nagel        1.851
## 127  127             Bronte Law        1.852
## 128  128         Jennifer Chang        1.852
## 129  129           Alana Uriell        1.852
## 130  130       Jackie Stoelting        1.853
## 131  131              Kelly Tan        1.854
## 132  132 Katherine Perry-Hamski        1.855
## 133  133       Sarah Jane Smith        1.856
## 134  134           Na Yeon Choi        1.857
## 135  135         Dani Holmqvist        1.859
## 136  136       Pavarisa Yoktuan        1.860
## 137  137            Alena Sharp        1.861
## 138  138              Mo Martin        1.864
## 139  139         Cydney Clanton        1.866
## 140  140          Jenny Coleman        1.866
## 141  141           Laura Davies        1.872
## 142  142          Marissa Steen        1.872
## 143  143           Ayako Uehara        1.874
## 144  144     Jodi Ewart Shadoff        1.880
## 145  145            Haley Moore        1.884
## 146  146       Suzuka Yamaguchi        1.885
## 147  147          Brittany Lang        1.888
## 148  148           Maria Torres        1.889
## 149  149           Anne van Dam        1.895
## 150  150            Tiffany Joh        1.896
## 151  151             Jaclyn Lee        1.905
## 152  152        Daniela Darquea        1.906
## 153  153      Mariah Stackhouse        1.908
## 154  154              Jane Park        1.913
## 155  155   Benyapa Niphatsophon        1.914
## 156  156         Maia Schechter        1.960
## 
## [[3]]
##     rank                   name greens_hit
## 1      1          Lexi Thompson       78.8
## 2      2           Jin Young Ko       78.8
## 3      3        Lauren Coughlin       78.0
## 4      4       Brooke Henderson       77.6
## 5      5            Nelly Korda       77.2
## 6      6     Brittany Lincicome       76.7
## 7      7        Matilda Castren       76.3
## 8      8        Jennifer Kupcho       76.3
## 9      9          Jessica Korda       76.0
## 10    10             Ally Ewing       75.8
## 11    11            In Gee Chun       75.7
## 12    12      Moriya Jutanugarn       75.5
## 13    13           Austin Ernst       75.4
## 14    14         Anna Nordqvist       75.4
## 15    15     Jodi Ewart Shadoff       74.9
## 16    16          Sei Young Kim       74.9
## 17    17             Minjee Lee       74.7
## 18    18          Gerina Piller       74.7
## 19    19          Lizette Salas       74.5
## 20    20               Xiyu Lin       74.4
## 21    21             Gaby Lopez       74.3
## 22    22         Celine Boutier       74.2
## 23    23          Leona Maguire       74.1
## 24    24              Amy Olson       73.9
## 25    25            Megan Khang       73.9
## 26    26            Chella Choi       73.7
## 27    27           Jeongeun Lee       73.7
## 28    28           Charley Hull       73.6
## 29    29                 Yu Liu       73.4
## 30    30         Cydney Clanton       73.4
## 31    31              A Lim Kim       73.2
## 32    32              Mo Martin       73.2
## 33    33   Pajaree Anannarukarn       73.2
## 34    34               Lydia Ko       73.1
## 35    35           Georgia Hall       73.0
## 36    36       Perrine Delacour       72.8
## 37    37      Brittany Altomare       72.6
## 38    38      Lauren Stephenson       72.6
## 39    39          Jenny Coleman       72.4
## 40    40         Katherine Kirk       72.4
## 41    41   Nanna Koerstz Madsen       72.2
## 42    42       Esther Henseleit       72.0
## 43    43          Danielle Kang       71.9
## 44    44            Marina Alex       71.8
## 45    45        Carlota Ciganda       71.7
## 46   46t            Stacy Lewis       71.7
## 47   46t          Ryann O&#39;Toole       71.7
## 48    48      Patty Tavatanakit       71.6
## 49   49t           Nasa Hataoka       71.6
## 50   49t        Caroline Masson       71.6
## 51    51              Yuka Saso       71.5
## 52    52      Madelene Sagstrom       71.5
## 53    53       Elizabeth Szokol       71.4
## 54   54t         Ashleigh Buhai       71.3
## 55   54t                Min Lee       71.3
## 56    56             Alison Lee       71.2
## 57    57             Inbee Park       71.2
## 58    58            So Yeon Ryu       71.1
## 59    59               Mel Reid       71.0
## 60    60        Sarah Schmelzel       71.0
## 61    61          Jeong Eun Lee       70.9
## 62    62            Yealimi Noh       70.9
## 63    63       Ariya Jutanugarn       70.8
## 64    64       Wichanee Meechai       70.7
## 65    65             Lauren Kim       70.7
## 66    66       Dana Finkelstein       70.7
## 67    67       Jaye Marie Green       70.6
## 68    68          Azahara Munoz       70.5
## 69    69           Hannah Green       70.4
## 70    70            Alena Sharp       70.2
## 71    71         Jennifer Chang       70.2
## 72    72       Stephanie Meadow       70.2
## 73    73            Hyo Joo Kim       70.2
## 74    74    Jasmine Suwannapura       70.1
## 75    75             Bronte Law       70.1
## 76   76t           Mina Harigae       70.1
## 77   76t          Christina Kim       70.1
## 78   78t             Paula Reto       70.0
## 79   78t               Amy Yang       70.0
## 80    80             Jenny Shin       69.9
## 81    81         Lindsey Weaver       69.9
## 82    82        Angela Stanford       69.7
## 83    83           Sophia Popov       69.7
## 84    84          Jennifer Song       69.6
## 85    85             Annie Park       69.5
## 86   86t           Mi Hyang Lee       69.4
## 87   86t      Pernilla Lindberg       69.4
## 88   86t     Bianca Pagdanganan       69.4
## 89    89      Pornanong Phatlum       69.4
## 90    90    Nicole Broch Larsen       69.2
## 91    91             Sarah Kemp       69.1
## 92   92t             Heaji Kang       69.1
## 93   92t      Mariah Stackhouse       69.1
## 94    94              Jane Park       69.0
## 95    95              Lee Lopez       69.0
## 96    96        Cheyenne Knight       68.9
## 97    97           Anne van Dam       68.8
## 98    98      Albane Valenzuela       68.8
## 99   99t            Maria Fassi       68.7
## 100  99t        Caroline Inglis       68.7
## 101  101          Marissa Steen       68.6
## 102  102             Brianna Do       68.6
## 103  103     Louise Ridderstrom       68.4
## 104  104             Su-Hyun Oh       68.4
## 105  105              Ana Belac       68.3
## 106  106           Wei-Ling Hsu       68.2
## 107  107         Gemma Dryburgh       68.1
## 108  108        Elizabeth Nagel       68.1
## 109  109           Na Yeon Choi       68.0
## 110  110                Muni He       68.0
## 111  111             Eun-Hee Ji       68.0
## 112  112          Sarah Burnham       67.9
## 113  113           Lindy Duncan       67.8
## 114  114        Giulia Molinaro       67.4
## 115  115           Alana Uriell       67.1
## 116  116          Dottie Ardina       67.1
## 117  117        Daniela Darquea       67.0
## 118 118t         Hee Young Park       66.7
## 119 118t            Emma Talley       66.7
## 120  120         Dani Holmqvist       66.6
## 121  121          Celine Herbin       66.4
## 122  122           Maria Torres       66.0
## 123  123              Mirim Lee       65.7
## 124  124        Kristen Gillman       65.6
## 125  125         Ssu-Chia Cheng       65.5
## 126  126           Cristie Kerr       65.4
## 127  127          Brittany Lang       65.4
## 128  128       Sarah Jane Smith       65.4
## 129  129            Luna Sobron       65.1
## 130  130               Jing Yan       65.0
## 131  131       Kristy McPherson       64.7
## 132  132           Linnea Strom       64.7
## 133  133           Tiffany Chan       64.6
## 134  134         Sung Hyun Park       64.5
## 135  135             Andrea Lee       64.4
## 136  136            Haley Moore       64.0
## 137  137       Pavarisa Yoktuan       63.6
## 138  138              Kelly Tan       63.6
## 139  139           Ayako Uehara       63.6
## 140  140         Maia Schechter       63.4
## 141  141 Katherine Perry-Hamski       63.2
## 142  142       Jackie Stoelting       63.2
## 143  143         Nuria Iturrioz       63.0
## 144  144             Esther Lee       62.9
## 145  145            Mi Jung Hur       62.3
## 146  146           Min Seo Kwak       61.9
## 147  147            Aditi Ashok       61.8
## 148  148   Benyapa Niphatsophon       61.7
## 149  149              Angel Yin       61.0
## 150  150             Jaclyn Lee       60.9
## 151  151            Tiffany Joh       60.1
## 152  152    Mind Muangkhumsakul       57.9
## 153  153            Haru Nomura       57.3
## 154  154         Jillian Hollis       56.9
## 155  155           Laura Davies       55.2
## 156  156       Suzuka Yamaguchi       45.7
## 
## [[4]]
##     rank                   name rounds score_average_actual
## 1      1            Nelly Korda     62               68.774
## 2      2           Jin Young Ko     67               68.866
## 3      3               Lydia Ko     73               69.329
## 4      4              Yuka Saso     33               69.364
## 5      5             Inbee Park     58               69.534
## 6      6          Lexi Thompson     70               69.629
## 7      7            In Gee Chun     76               69.632
## 8      8          Jessica Korda     63               69.794
## 9      9       Brooke Henderson     75               69.800
## 10    10          Danielle Kang     69               69.826
## 11    11      Patty Tavatanakit     65               69.831
## 12    12          Sei Young Kim     72               69.944
## 13    13          Leona Maguire     68               69.985
## 14    14            So Yeon Ryu     67               70.015
## 15    15       Ariya Jutanugarn     75               70.080
## 16    16             Gaby Lopez     74               70.081
## 17    17               Xiyu Lin     65               70.092
## 18    18         Celine Boutier     79               70.127
## 19    19      Moriya Jutanugarn     70               70.157
## 20    20            Hyo Joo Kim     54               70.185
## 21    21          Jeong Eun Lee     82               70.293
## 22    22             Minjee Lee     59               70.322
## 23    23             Ally Ewing     74               70.351
## 24    24           Hannah Green     62               70.452
## 25    25           Nasa Hataoka     63               70.460
## 26    26            Megan Khang     66               70.470
## 27    27       Esther Henseleit     63               70.476
## 28    28        Jennifer Kupcho     75               70.600
## 29    29           Georgia Hall     75               70.627
## 30    30        Lauren Coughlin     41               70.634
## 31    31          Lizette Salas     69               70.638
## 32    32        Matilda Castren     57               70.667
## 33    33      Madelene Sagstrom     70               70.714
## 34    34               Amy Yang     70               70.729
## 35    35           Charley Hull     71               70.732
## 36    36          Ryann O&#39;Toole     70               70.757
## 37    37           Mina Harigae     72               70.764
## 38    38   Nanna Koerstz Madsen     70               70.771
## 39    39   Pajaree Anannarukarn     82               70.780
## 40    40             Alison Lee     51               70.804
## 41    41         Anna Nordqvist     69               70.812
## 42    42     Brittany Lincicome     55               70.818
## 43    43      Brittany Altomare     73               70.849
## 44    44             Su-Hyun Oh     76               70.855
## 45    45       Perrine Delacour     64               70.922
## 46    46           Austin Ernst     65               70.923
## 47    47            Yealimi Noh     79               70.962
## 48    48              A Lim Kim     68               70.971
## 49    49            Stacy Lewis     69               70.986
## 50   50t            Chella Choi     71               71.000
## 51   50t      Lauren Stephenson     67               71.000
## 52    52              Amy Olson     68               71.029
## 53    53             Paula Reto     55               71.055
## 54    54        Caroline Masson     63               71.063
## 55    55                 Yu Liu     76               71.145
## 56    56        Carlota Ciganda     71               71.169
## 57    57             Eun-Hee Ji     69               71.188
## 58    58           Jeongeun Lee     54               71.204
## 59    59       Wichanee Meechai     78               71.205
## 60    60             Jenny Shin     74               71.216
## 61    61           Wei-Ling Hsu     67               71.239
## 62    62          Gerina Piller     61               71.262
## 63    63         Ashleigh Buhai     73               71.274
## 64    64        Angela Stanford     50               71.300
## 65    65           Sophia Popov     65               71.308
## 66    66        Sarah Schmelzel     72               71.319
## 67    67         Katherine Kirk     70               71.329
## 68    68               Mel Reid     53               71.358
## 69    69            Marina Alex     66               71.364
## 70    70           Lindy Duncan     58               71.379
## 71    71                Min Lee     36               71.389
## 72    72         Lindsey Weaver     60               71.417
## 73    73             Heaji Kang     63               71.444
## 74    74          Azahara Munoz     66               71.455
## 75    75    Jasmine Suwannapura     79               71.456
## 76    76          Jennifer Song     68               71.485
## 77    77          Dottie Ardina     39               71.487
## 78    78       Elizabeth Szokol     67               71.522
## 79    79      Albane Valenzuela     66               71.561
## 80    80             Annie Park     53               71.642
## 81    81     Jodi Ewart Shadoff     49               71.694
## 82    82          Celine Herbin     39               71.718
## 83    83     Bianca Pagdanganan     32               71.719
## 84    84      Pornanong Phatlum     74               71.770
## 85    85       Dana Finkelstein     58               71.776
## 86    86    Nicole Broch Larsen     59               71.797
## 87    87        Cheyenne Knight     77               71.805
## 88    88          Christina Kim     55               71.836
## 89    89             Sarah Kemp     56               71.893
## 90    90       Stephanie Meadow     57               71.965
## 91    91         Ssu-Chia Cheng     60               71.967
## 92    92       Jaye Marie Green     68               72.015
## 93    93              Ana Belac     42               72.024
## 94    94         Gemma Dryburgh     30               72.033
## 95    95           Cristie Kerr     36               72.056
## 96   96t            Maria Fassi     44               72.068
## 97   96t         Hee Young Park     44               72.068
## 98    98              Angel Yin     64               72.094
## 99    99        Kristen Gillman     70               72.100
## 100 100t            Aditi Ashok     56               72.125
## 101 100t      Pernilla Lindberg     64               72.125
## 102 100t              Lee Lopez     24               72.125
## 103  103        Caroline Inglis     55               72.145
## 104  104          Sarah Burnham     44               72.159
## 105  105              Mo Martin     34               72.206
## 106  106            Mi Jung Hur     42               72.214
## 107  107             Bronte Law     67               72.224
## 108  108             Esther Lee     41               72.244
## 109  109         Cydney Clanton     68               72.250
## 110  110          Jenny Coleman     68               72.279
## 111  111     Louise Ridderstrom     25               72.320
## 112  112            Alena Sharp     59               72.339
## 113  113        Giulia Molinaro     58               72.345
## 114  114          Marissa Steen     52               72.346
## 115  115         Jennifer Chang     53               72.358
## 116  116             Lauren Kim     33               72.364
## 117  117           Mi Hyang Lee     57               72.368
## 118  118         Sung Hyun Park     49               72.408
## 119  119            Emma Talley     63               72.429
## 120  120           Alana Uriell     37               72.432
## 121  121           Na Yeon Choi     41               72.439
## 122  122              Mirim Lee     46               72.587
## 123  123           Tiffany Chan     40               72.600
## 124  124                Muni He     56               72.607
## 125  125        Elizabeth Nagel     34               72.618
## 126  126         Dani Holmqvist     48               72.688
## 127  127         Nuria Iturrioz     23               72.696
## 128  128             Andrea Lee     47               72.787
## 129  129             Brianna Do     29               72.828
## 130  130           Ayako Uehara     34               72.882
## 131 131t       Kristy McPherson     26               73.000
## 132 131t              Kelly Tan     36               73.000
## 133  133          Brittany Lang     44               73.023
## 134  134       Sarah Jane Smith     43               73.023
## 135  135           Min Seo Kwak     37               73.027
## 136  136       Pavarisa Yoktuan     33               73.030
## 137  137            Luna Sobron     42               73.048
## 138  138           Anne van Dam     46               73.087
## 139  139               Jing Yan     63               73.222
## 140  140           Linnea Strom     52               73.231
## 141  141       Jackie Stoelting     24               73.375
## 142  142 Katherine Perry-Hamski     29               73.379
## 143  143    Mind Muangkhumsakul     36               73.417
## 144  144           Maria Torres     44               73.432
## 145 145t            Haley Moore     38               73.500
## 146 145t            Haru Nomura     22               73.500
## 147  147      Mariah Stackhouse     36               73.611
## 148 148t        Daniela Darquea     39               73.692
## 149 148t              Jane Park     26               73.692
## 150  150            Tiffany Joh     32               73.813
## 151  151   Benyapa Niphatsophon     20               73.850
## 152  152         Jillian Hollis     28               74.786
## 153  153             Jaclyn Lee     22               74.955
## 154  154         Maia Schechter     22               75.000
## 155  155           Laura Davies     29               75.241
## 156  156       Suzuka Yamaguchi     18               76.611</code></pre>
<p>All done!! And just like that, we’ve downloaded four different web
pages, extracted the tabled info, and formatted them without copying and
pasting any code. The same process for all four was only used one time
to write the initial function. Just apply some final formatting to clean
it up a bit and combine the separate data frames into a single, unified
one.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>lpga_data<span class="ot">=</span> lpga_data <span class="sc">%&gt;%</span> </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(left_join, <span class="at">by=</span><span class="st">&quot;name&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># Combine all list levels into a single tibble, matching by the &quot;Name&quot; column</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;rank.&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;score_average&quot;</span><span class="ot">=</span><span class="st">&quot;score_average_actual&quot;</span>)</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co"># VOILA! </span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lpga_data)</span></code></pre></div>
<pre><code>##                   name distance putt_average greens_hit rounds score_average
## 1         Anne van Dam  290.822        1.895       68.8     46        73.087
## 2   Bianca Pagdanganan  284.846        1.830       69.4     32        71.719
## 3          Maria Fassi  279.784        1.818       68.7     44        72.068
## 4        Lexi Thompson  278.353        1.819       78.8     70        69.629
## 5            A Lim Kim  276.762        1.798       73.2     68        70.971
## 6 Nanna Koerstz Madsen  276.580        1.801       72.2     70        70.771</code></pre>
</div>
<div id="non-reproducible-example-juvenile-life-without-parole-study" class="section level2" number="12.2">
<h2 number="12.2"><span class="header-section-number">12.2</span> Non-reproducible example (Juvenile Life Without Parole study)</h2>
<p>In the Juvenile Lifers study, there were a series of questions that
participants rated on a scale of 0-100 in terms of difficulty. Part of
our analysis involved taking the ratings on those variables and giving
them relative rankings, so that each of the 6 variables in the series
was rated from the least to most difficult, by participant.</p>
<p>Now if we only needed to compute these rankings once this wouldn’t have
been any big deal; however, we needed to do it <strong>three times</strong>.</p>
<p>Much of the same code and the same process would need to be copied and pasted,
resulting in a very long, messy, harder to read script. With purrr
however, we can reduce the redundancies to a minimum, saving time and reducing the chances of mistakes.</p>
<p><strong><em>Step 1.</em></strong>
Just like before, the first step is to find a line-by-line solution for a single item, and then to generalize this into a shortcut function that can be applied to the any item “i” in a series of items.</p>
<p>For the sake of brevity, I’m going to skip most of that and just include the functions below.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;C:/Github Repos/Studies/JLWOP/Data and Models/jlwop_reentry_survey.RData&quot;</span>)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### CREATE THE DATA SETS WE NEED####</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>na_blank<span class="ot">=</span>jlwop_reentry_survey <span class="co"># analysis 1 keeps the data as-is</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>na_zero<span class="ot">=</span>jlwop_reentry_survey <span class="sc">%&gt;%</span> <span class="co"># supplementary analysis replaces the NA&#39;s with 0</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(barrier_housing<span class="sc">:</span>barrier_identification), replace_na,<span class="dv">0</span>))</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(jlwop_reentry_survey) <span class="co"># remove old data set to avoid confusion</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="do">#### Functions ####</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="co"># transformation function to wrangle the data into proper formatting</span></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>rotate_data<span class="ot">=</span><span class="cf">function</span>(data, variable_prefix){</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols=</span> <span class="fu">starts_with</span>(variable_prefix), <span class="co"># collect all the desired variables (i.e., columns)....</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="co">#...and put them into a new categorical variable called &quot;variable&quot;</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;participant_score&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># ...and store their values in a new variable called &quot;participant_score&quot;</span></span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(unique,participant_score) <span class="sc">%&gt;%</span> </span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(unique, participant_score, variable)) <span class="sc">%&gt;%</span> <span class="co"># keep only these 3 variables</span></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(variable, <span class="at">.before =</span> participant_score) <span class="co"># put the newly created variable up front</span></span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(data)</span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a><span class="co"># creating the rankings for each variable; then transform data back to original structure</span></span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>rank_and_unpivot<span class="ot">=</span><span class="cf">function</span>(data){</span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>  data<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(unique) <span class="sc">%&gt;%</span> <span class="co"># group the scores so they can be ranked by participant</span></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank1=</span><span class="fu">dense_rank</span>(participant_score), <span class="co"># create ranking variable</span></span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">rank=</span><span class="fu">max</span>(rank1,<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> rank1) <span class="sc">%&gt;%</span> <span class="co"># fix ranks by flipping to ascending order</span></span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank=</span><span class="fu">factor</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># convert rank to factor structure</span></span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>rank1)</span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot back to wide</span></span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> rank<span class="sc">:</span>participant_score) <span class="sc">%&gt;%</span> </span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="co"># un-group the data and delete the generated names</span></span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(data)</span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>Step 2.</em></strong>
Again, like before, we want to combine all elements of interest into some object. Once we have that, we then pass said object to <code>map()</code> and supply the map call with our custom function.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>dfs<span class="ot">=</span><span class="fu">list</span>(<span class="at">na_blank=</span>na_blank, <span class="at">na_zero=</span>na_zero) <span class="sc">%&gt;%</span> <span class="co"># create lists</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="at">.f=</span>rotate_data, <span class="at">variable_prefix =</span> <span class="st">&quot;barrier&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># apply custom function along whole list</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(rank_and_unpivot) <span class="co"># again!!  DO IT AGAIN! With another function this time.</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract list elements to make them data frames again</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="fu">list2env</span>(dfs, <span class="fu">globalenv</span>())</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dfs) <span class="co">#discard list. It has fulfilled its purpose.</span></span></code></pre></div>
<p>And just like that, we’re done!</p>
</div>
<div id="example-3-readimport-several-files-at-once-with-map" class="section level2" number="12.3">
<h2 number="12.3"><span class="header-section-number">12.3</span> Example 3: Read/Import several files at once with <code>map()</code></h2>
<p><strong>Note.</strong> This reads many .csv files and combines them into a <em>SINGLE,
unified data frame</em>. If you want to import many files at once but keep
them separated, you’ll need a different command.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="do">######### Step-by-step version #########</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;JLWOP/Data and Models/&quot;</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. view all files; make sure you see everything you want/need</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>file_path <span class="sc">%&gt;%</span> <span class="fu">list.files</span>()</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. save only file names with the desired extension</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>csv_file_names<span class="ot">=</span>file_path <span class="sc">%&gt;%</span> </span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">str_detect</span>(., <span class="st">&quot;.csv&quot;</span>)]</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Load everything into the Global Environment</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>csv_file_names <span class="sc">%&gt;%</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(file_name){ <span class="co"># iterate through each file name</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="at">x =</span> <span class="fu">str_remove</span>(file_name, <span class="st">&quot;.csv&quot;</span>), <span class="co"># Remove file extension &quot;.csv&quot;</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(file_path, file_name)),</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a><span class="do">######### Combining all steps into a single, one-line function ##########</span></span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>read_all_excel<span class="ot">=</span><span class="cf">function</span>(path){</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> path</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># save only file names with the desired extension</span></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>  file_names<span class="ot">=</span>file_path <span class="sc">%&gt;%</span> </span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list.files</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>    .[<span class="fu">str_detect</span>(., <span class="st">&quot;.xlsx&quot;</span>)]</span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>  file_names <span class="sc">%&gt;%</span></span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(file_name){ <span class="co"># iterate through each file name</span></span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(<span class="at">x =</span> <span class="fu">str_remove</span>(file_name, <span class="st">&quot;.xlsx&quot;</span>), <span class="co"># Remove file extension &quot;.csv&quot;</span></span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">value =</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">paste0</span>(file_path, file_name)),</span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb198-37"><a href="#cb198-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb198-38"><a href="#cb198-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-39"><a href="#cb198-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-40"><a href="#cb198-40" aria-hidden="true" tabindex="-1"></a><span class="fu">read_all_excel</span>(<span class="at">path =</span> <span class="st">&quot;JLWOP/Data and Models/&quot;</span>)</span></code></pre></div>
</div>
<div id="other-purrr-commands" class="section level2" number="12.4">
<h2 number="12.4"><span class="header-section-number">12.4</span> Other purrr commands</h2>
<p>Note that <code>map()</code> always returns a list, and depending on the output
that you want, you may need to use a variation of <code>map()</code>. These
variations are as follows:</p>
<table>
<thead>
<tr class="header">
<th>Command</th>
<th>Return</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map_lgl()</code></td>
<td>logical vector</td>
</tr>
<tr class="even">
<td><code>map_int()</code></td>
<td>integer vector</td>
</tr>
<tr class="odd">
<td><code>map_dbl()</code></td>
<td>double vector</td>
</tr>
<tr class="even">
<td><code>map_chr()</code></td>
<td>character vector</td>
</tr>
<tr class="odd">
<td><code>walk()</code></td>
<td>only returns the side effects of a function</td>
</tr>
</tbody>
</table>
<div id="the-walk-and-walk2-commands" class="section level3" number="12.4.1">
<h3 number="12.4.1"><span class="header-section-number">12.4.1</span> The <code>walk</code> and <code>walk2</code> commands</h3>
<p>Walk() is useful for when you just want to plot something or write a
save file to your disk, etc. It does not give you any return to store
something in the environment. You use it to write/read files, open
graphics windows, and so on.</p>
<p><strong><em>Example: Exporting multiple .csv files at once</em></strong></p>
<p>Utilize <code>purrr::walk2()</code> to apply a function iteratively on TWO objects
simultaneously. To save multiple .csv files with <code>walk2</code>, we need two
distinct lists: 1. A list of data frames that we wish to export, 2. and
the file paths, complete with the file names and extensions, for each
file to be written</p>
<p>First create and define both list items. Then apply <code>walk2()</code> to pluck
an element from list 1 and its corresponding element from list 2, and
apply the <code>write_csv</code> function in for-loop fashion.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Custom function ####</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>bundle_paths<span class="ot">=</span><span class="cf">function</span>(df_list, folder_location){</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  names<span class="ot">=</span><span class="fu">names</span>(df_list)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  paths<span class="ot">=</span><span class="fu">rep</span>(here<span class="sc">::</span><span class="fu">here</span>(folder_location), <span class="fu">length</span>(names))</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  extension<span class="ot">=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;.csv&quot;</span>), <span class="fu">length</span>(names))</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  fixed_names<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;/&quot;</span>,names)</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>  path_bundle<span class="ot">=</span><span class="fu">list</span>(paths,fixed_names, extension) <span class="sc">%&gt;%</span> </span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pmap</span>(., paste0)</span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(path_bundle)</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="do">#### Exporting the .csv files for SPSS/JASP/etc. ####</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define list 1</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>dfs<span class="ot">=</span><span class="fu">list</span>(<span class="at">na_blank=</span>na_blank,</span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">na_zero=</span>na_zero,</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">na_zero_helpreint=</span>na_zero_helpreint)</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a><span class="co"># list 2</span></span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a>paths_csv<span class="ot">=</span><span class="fu">bundle_paths</span>(<span class="at">df_list =</span> dfs, <span class="at">folder_location =</span> <span class="st">&quot;JLWOP/Data and Models&quot;</span>)</span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over all elements in list 1 and corresponding element in list 2;</span></span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a><span class="co"># and apply the the write_csv function to each</span></span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a><span class="fu">walk2</span>(<span class="at">.x=</span>dfs, <span class="at">.y=</span> paths, <span class="at">.f=</span>write_csv)</span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a><span class="do">#### .RData file for R users ####</span></span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine multiple data frames into a single .RData file and export</span></span>
<span id="cb199-31"><a href="#cb199-31" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;na_blank&quot;</span>, <span class="st">&quot;na_zero&quot;</span>, <span class="st">&quot;na_zero_helpreint&quot;</span>), </span>
<span id="cb199-32"><a href="#cb199-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;JLWOP&quot;</span>, <span class="st">&quot;Data and Models&quot;</span>,<span class="st">&quot;ranking_data.RData&quot;</span>))</span></code></pre></div>
</div>
<div id="map2-and-walk2" class="section level3" number="12.4.2">
<h3 number="12.4.2"><span class="header-section-number">12.4.2</span> <code>map2</code> (and <code>walk2</code>)</h3>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;map2_b.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/map2_b.png" width="816" /></p>
</div>
<div id="pmap-for-when-you-have-a-bunch-of-shit" class="section level3" number="12.4.3">
<h3 number="12.4.3"><span class="header-section-number">12.4.3</span> <code>pmap</code> for when you have a bunch of shit</h3>
<p>This function is for iterating over <em>three or more</em> elements. As soon as you have &gt;2 items you have to iterate over, you need pmap().It works similar to to map and map2, but instead of iterating over a single object x or two objects x and y, it acts on <strong>a list object called .l</strong></p>
<p>The list is a list of all the objects you want to iterate over. If you
give it a list of 18 items, it iterates over all 18. If the list only
has two things, it only acts on those two.</p>
<p>She says its easiest to imagine the list as a data frame, and the
columns of the data frame like the elements of that list.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;pmap_2.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/pmap_2.png" width="600" /></p>
<!--chapter:end:10-functions.Rmd-->
</div>
</div>
</div>
<div id="intro-to-r-markdown" class="section level1" number="13">
<h1 number="13"><span class="header-section-number">13</span> Intro to R Markdown</h1>
<p>R Markdown is a better and more organized way to write scripts. Seriously, once you learn it, there’s no going back. New and don’t know where to start? Read <a href="https://bookdown.org/yihui/rmarkdown-cookbook/conceptual-overview.html">The R Markdown Cookbook</a>. Amazing overview with tons of neat tricks and how-to’s. <a href="https://rmd4sci.njtierney.com/using-rmarkdown.html#the-anatomy-of-an-rmarkdown-document">This other source</a> may also be of some help.</p>
<p>Below are some quick tips for common tasks; but be sure to read the Cookbook above.</p>
<div id="important-code-chunk-options" class="section level2" number="13.1">
<h2 number="13.1"><span class="header-section-number">13.1</span> Important code chunk options</h2>
<ul>
<li><code>cache</code>: TRUE or FALSE. Do you want to save the output of the chunk so it doesn’t have to run next time? Creates a cached folder in the directory.</li>
<li><code>eval</code>: Do you want to evaluate (i.e., run) the code in the chunk?</li>
<li><code>echo</code>: Do you want to <em>print</em> the code after it’s run?</li>
<li><code>include</code>: Do you want to include code output in the final output document? Setting to <code>FALSE</code> means the code does not appear in the output document, but it is still run.</li>
</ul>
</div>
<div id="writing-math-equations-and-symbols" class="section level2" number="13.2">
<h2 number="13.2"><span class="header-section-number">13.2</span> Writing math equations and symbols</h2>
<div id="greek-symbols" class="section level3" number="13.2.1">
<h3 number="13.2.1"><span class="header-section-number">13.2.1</span> Greek symbols</h3>
<p>A few notes first:
Math notation is done with dollar signs and forward slashes…</p>
<p>For Greek letters, just type the name of the letter:
<code>$\mu$</code> for <span class="math inline">\(\mu\)</span>
<code>$\sigma$</code> for <span class="math inline">\(\sigma\)</span>
<code>$\alpha$</code> for <span class="math inline">\(\alpha\)</span>
<code>$\pi$</code> for <span class="math inline">\(\pi\)</span>
<code>$\rho$</code> for <span class="math inline">\(\rho\)</span></p>
</div>
<div id="math-notation" class="section level3" number="13.2.2">
<h3 number="13.2.2"><span class="header-section-number">13.2.2</span> Math notation</h3>
<p><code>$\pm$</code> for ±
<code>$\ge$</code> for ≥
<code>$\le$</code> for ≤
<code>$\neq$</code> for ≠</p>
</div>
<div id="statistics-notation" class="section level3" number="13.2.3">
<h3 number="13.2.3"><span class="header-section-number">13.2.3</span> Statistics notation</h3>
</div>
<div id="writing-in-line-code" class="section level3" number="13.2.4">
<h3 number="13.2.4"><span class="header-section-number">13.2.4</span> Writing in-line code</h3>
<p>Use the funny looking symbol on the tilde key that looks like this: `
To write in line, code, put one of those symbols on either side of the code, like you would with quotation marks. Helps you write lines like:</p>
<p>I love <code>dplyr</code></p>
</div>
</div>
<div id="including-graphicsinserting-pictures" class="section level2" number="13.3">
<h2 number="13.3"><span class="header-section-number">13.3</span> Including graphics/inserting pictures</h2>
<p>The default method doesn’t work for me for some reason, but you can still insert images using a combination of the <code>here</code> package and <code>knitr</code>.</p>
<p>Use the <code>include_graphics()</code> command and specify both the file location and it’s name:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>,<span class="st">&quot;snapchat.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/snapchat.png" width="540" /></p>
<p>The <a href="https://bookdown.org/yihui/bookdown/figures.html">bookdown book</a> notes that:</p>
<p>The syntax for controlling the image attributes is the same as when images are generated from R
code. Chunk options <code>fig.cap</code>, <code>out.width</code>, and <code>fig.show</code> still have the same meanings.</p>
<p>and:
You can easily scale these images proportionally using the same ratio. This can be done via the
<code>dpi</code> argument (dots per inch), which takes the value from the chunk option <code>dpi</code> by default If it is a
numeric value and the chunk option <code>out.width</code> is not set, the output width of an image will be its
actual width (in pixels) divided by dpi , and the unit will be inches. For example, for an image with
the size 672 x 480, its output width will be 7 inches ( 7in ) when <code>dpi=96</code>.
This feature requires the package png and/or jpeg to be installed. You can always override the automatic calculation of
width in inches by providing a non-NULL value to the chunk option <code>out.width</code> , or use <code>include_graphics(dpi = NA)</code></p>
</div>
<div id="footnotes" class="section level2" number="13.4">
<h2 number="13.4"><span class="header-section-number">13.4</span> Footnotes</h2>
<p>To add a footnote, use the “^” symbol and put the note in brackets:</p>
<p>You can also write footnotes<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> like this.</p>
</div>
<div id="change-the-color-of-your-text" class="section level2" number="13.5">
<h2 number="13.5"><span class="header-section-number">13.5</span> Change the color of your text</h2>
<p><span style="color:blue"> YOUR TEXT HERE </span></p>
<!--chapter:end:11-markdown.Rmd-->
</div>
</div>
<div id="statistics-and-psych-specific-stuff" class="section level1" number="14">
<h1 number="14"><span class="header-section-number">14</span> Statistics and Psych-specific Stuff</h1>
<div id="create-or-sample-from-a-distribution" class="section level2" number="14.1">
<h2 number="14.1"><span class="header-section-number">14.1</span> Create or sample from a distribution</h2>
<p><em>Creating a binomial distribution</em></p>
<p>When you do this, you are setting the true population parameter; you are in control of the Data Generating Process and the true distribution</p>
<p>In a binomial distribution, the parameter is normally distributed, and can take any value from 0.0 to 1.0
But the data that this process generates is not normal</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n=</span> <span class="dv">1000</span>, <span class="at">size=</span> <span class="dv">1</span>, <span class="at">prob =</span>  <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##    [1] 0 1 0 1 1 0 1 0 0 1 0 0 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 1 1 1 0 1 0 0 1 0 1 0 0 1 0 0 1 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 1
##   [60] 0 0 1 0 0 0 0 0 1 1 1 1 1 0 0 1 0 1 0 1 1 1 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0 1 0 1 0 0 0 0 1 0 0 0 0 1 0 1 1 0 0 0 1 0
##  [119] 0 1 0 0 0 0 1 0 1 1 0 1 0 0 1 0 1 0 0 1 1 1 1 0 1 1 1 1 0 0 0 0 0 0 0 0 1 0 1 1 1 1 0 0 0 1 0 1 0 0 0 0 0 1 1 0 0 1 1
##  [178] 1 1 1 0 0 0 0 0 1 1 1 0 0 1 1 0 0 0 1 1 0 0 1 0 1 1 1 1 1 0 1 1 1 0 1 0 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 0 0 0 0 1 1 1
##  [237] 0 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 1 0 1 1 1 1 0 0 0 1 1 0 0 1 1 1 0 0 1 0 0 0 1 1 1 0 1 1 0 0 0 1 1 0 1 1 0 1 0 0 1 1 1
##  [296] 0 0 1 0 0 0 1 0 1 1 0 1 0 1 1 1 0 0 0 1 0 0 0 1 1 1 1 1 0 1 1 1 0 0 0 0 1 0 0 0 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 0
##  [355] 1 0 0 0 0 1 0 0 1 0 0 1 0 1 1 0 0 0 0 0 0 0 1 1 1 1 0 1 1 0 0 0 1 0 0 1 1 1 1 1 0 0 1 0 1 0 0 1 1 1 0 1 0 0 0 1 1 1 1
##  [414] 1 0 0 0 1 0 1 0 0 1 0 0 0 1 1 1 0 0 0 0 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 1 1 0 1 0 1 1 1 1 0 0 1 1 1 0 1 1 1 0 1 1 0 0 1
##  [473] 1 1 0 0 1 0 1 0 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 1 0 0 1 0 0 1 0 1 1 0 0 0 1 0 0 0 0 0 0 0 0
##  [532] 0 1 1 0 1 1 1 0 1 0 1 1 0 0 0 1 1 1 0 0 1 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 0 1 0 1 1 0 0 0 0 0 0 1 0 0 1 1 1 1 0 1 1 0 0
##  [591] 0 1 0 0 0 1 0 1 1 1 1 0 1 1 1 0 0 0 0 0 0 1 0 1 0 1 1 1 0 1 1 1 0 0 0 0 1 0 0 0 1 0 1 0 1 0 0 0 0 1 1 1 1 0 0 1 0 1 1
##  [650] 1 1 1 1 0 1 0 0 0 0 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 1 0 1 1 0 0 0 0 1 1 0 1 0 1 0 0 0 1 1 1 0 1 1 1 0 0 1 0 0 0 0 0 1 0
##  [709] 1 1 0 1 1 1 1 1 1 1 1 0 0 1 1 1 0 0 1 0 0 0 1 0 1 1 0 1 1 0 0 1 1 0 1 1 0 0 1 0 1 1 1 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0
##  [768] 1 1 1 0 0 1 1 0 0 1 1 0 1 0 0 0 0 0 1 1 1 1 0 0 0 1 0 1 1 1 0 1 0 1 0 0 1 0 1 0 0 0 0 1 0 1 1 0 0 0 1 0 1 0 0 0 0 1 1
##  [827] 0 1 0 0 1 1 0 1 0 1 1 0 1 0 1 1 0 1 0 1 0 1 1 0 1 1 0 1 0 0 1 1 0 1 0 0 0 0 1 0 1 0 0 1 1 0 0 1 0 0 1 1 1 1 1 1 0 1 1
##  [886] 0 1 1 0 1 1 1 1 0 0 1 1 1 0 0 1 1 0 1 1 1 1 1 0 0 0 1 1 1 0 0 0 0 0 1 1 0 0 0 0 1 1 0 1 1 1 0 1 1 0 1 1 0 1 0 1 1 1 0
##  [945] 1 1 0 1 1 1 0 0 0 0 0 0 1 0 0 0 0 1 1 1 0 1 1 1 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 0 0 0 1 1 1 0 0 0 0 0 1 1</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">2500</span>,<span class="at">mean=</span><span class="dv">500</span>, <span class="at">sd=</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>##    [1] 690.7642 503.0016 446.5626 484.7566 514.2144 558.1073 372.0421 486.2422 445.8801 507.1753 582.8456 556.2646 505.3560
##   [14] 457.7520 552.2014 443.2911 516.2216 507.5774 496.2267 700.0870 486.4038 544.2314 610.0555 490.9881 564.8317 588.5202
##   [27] 438.1985 365.3048 467.5639 521.1525 617.3123 554.5895 489.1160 512.8746 711.0196 692.8460 519.8707 324.4048 441.7998
##   [40] 534.3156 490.2324 585.4221 430.4960 460.9629 703.4337 510.0744 519.9681 468.5821 527.3318 413.0651 460.6879 664.7801
##   [53] 354.3382 370.0553 489.8274 326.0638 343.5181 669.8929 410.4743 259.5956 581.9515 479.6523 434.0253 461.1315 584.3208
##   [66] 423.5085 556.7683 466.5056 433.8107 588.9122 358.9104 296.3319 490.2643 374.4722 508.8257 550.2508 413.3520 491.6750
##   [79] 450.5777 637.9321 418.8566 530.1711 558.6032 531.9450 422.4871 509.5001 436.4969 609.5397 390.5833 573.7023 332.9137
##   [92] 355.7153 459.6057 416.6499 435.9233 393.1971 450.7034 370.8988 325.2500 560.9520 538.7495 596.3238 456.8505 378.8018
##  [105] 389.1940 546.0309 464.9669 437.3562 595.2106 358.9524 488.1387 577.6982 451.5795 555.9834 455.0614 424.9773 512.1967
##  [118] 333.4369 349.7942 497.6879 461.4079 579.9255 570.4377 496.8774 468.6098 553.1056 693.8511 668.4453 418.9909 571.5872
##  [131] 626.5654 682.8749 381.1959 380.5799 529.1706 495.0200 602.4397 488.4812 481.2003 480.3037 517.4619 430.3098 410.7283
##  [144] 383.9239 507.2224 677.0574 551.9872 743.8753 447.8830 553.9661 660.0133 426.8833 378.0482 586.2658 608.6438 414.7819
##  [157] 467.3578 443.9643 505.8476 582.4859 515.8577 579.6892 452.8202 320.2918 429.6083 496.7879 444.7553 546.7475 461.6923
##  [170] 495.1302 305.6665 481.9163 570.0053 411.7289 659.6989 319.8401 577.8611 325.9026 545.4157 460.2025 534.0228 406.5574
##  [183] 532.8106 611.0717 470.5804 470.7250 399.0586 376.7103 432.2565 510.2988 501.0330 311.5054 613.5306 491.6324 592.4899
##  [196] 497.2093 253.9098 540.8763 524.1655 570.1845 568.8148 649.2078 357.9979 505.1117 560.0656 488.2058 512.4326 429.8364
##  [209] 369.7317 562.7482 380.4301 691.9237 552.0891 642.8095 381.2714 610.1536 393.5623 353.8832 557.3873 478.6679 677.2078
##  [222] 493.7744 381.9982 534.3512 519.5267 354.7870 427.7809 492.3991 527.7539 236.7285 634.5613 611.5118 573.7486 494.7876
##  [235] 447.2701 450.1239 447.2279 528.8756 495.6735 432.1601 480.7788 407.7178 519.6089 533.9601 478.7551 535.1155 502.5280
##  [248] 342.3943 446.9967 523.1670 562.8475 462.3585 525.2291 523.7450 532.5428 435.9035 458.1338 661.8657 463.5148 520.1895
##  [261] 497.6584 427.7127 590.0779 563.6812 527.4667 580.2521 450.2358 609.7054 687.3053 315.5045 381.4677 354.9862 621.2616
##  [274] 445.6282 493.3062 557.0388 535.6489 391.4441 517.1641 643.9891 462.9767 456.7823 594.6212 679.8447 469.5304 585.8058
##  [287] 495.7101 515.8654 585.2954 475.4714 245.2662 573.7207 571.2908 510.1705 489.8945 427.6127 381.9606 549.0644 731.1598
##  [300] 624.7910 351.4736 516.0527 502.4989 575.3473 508.8300 598.5068 626.5723 394.5084 551.1109 481.5339 602.6052 490.7534
##  [313] 524.8933 594.8019 511.1983 451.8964 493.0614 628.4617 477.1235 576.7203 469.4596 528.6711 536.4981 466.4876 529.7832
##  [326] 514.9179 594.0735 475.0174 379.3909 551.3659 416.0800 653.6031 349.7248 498.9691 603.6682 541.4988 497.6942 419.0618
##  [339] 461.9743 433.0824 291.6662 454.9965 429.0149 266.4133 580.8652 417.8723 625.2045 507.4710 391.1100 654.7852 627.8170
##  [352] 398.9321 384.7853 501.1054 675.6450 476.3180 440.5276 509.3056 599.2357 592.1269 651.7668 524.3816 421.1368 452.8244
##  [365] 529.8621 644.1803 478.4175 508.7750 595.8007 558.5413 571.2349 555.1023 559.2593 489.7140 493.0326 669.2377 469.0042
##  [378] 347.3663 475.9720 421.2802 645.9101 453.0382 541.1887 411.5055 666.8346 494.7872 397.1767 497.7115 486.7867 534.5902
##  [391] 439.6220 480.8484 554.9179 368.8868 460.8274 489.0922 711.1718 501.9165 418.5724 718.6710 423.1709 435.8882 532.8551
##  [404] 649.3885 451.9812 587.7714 516.2318 511.8405 380.5151 573.8564 462.3429 510.8129 275.7200 535.5461 623.0225 456.8365
##  [417] 490.8698 594.5922 653.8893 516.6514 332.8932 612.6280 524.1005 538.2043 487.1793 524.3440 497.0323 502.0975 587.9191
##  [430] 448.9578 476.7128 602.9146 469.7850 376.6824 499.8641 650.7851 615.8094 493.3007 570.9333 608.2727 559.6828 587.6076
##  [443] 477.4335 535.3579 459.4781 448.0090 531.2777 522.1706 543.7536 606.8745 463.3416 491.5422 684.6416 437.6934 476.8128
##  [456] 499.2137 527.9584 599.6644 396.7951 477.0358 532.5132 478.9701 610.1375 570.7250 458.6793 490.3939 492.9727 548.0784
##  [469] 491.5192 534.6258 592.4548 429.9015 622.2405 514.6087 482.5179 631.1590 548.9731 476.7655 550.6699 458.7896 500.6046
##  [482] 489.9678 521.7070 376.1594 455.4748 478.8103 500.6990 450.0641 705.1408 493.3444 340.2326 450.3086 565.5474 510.5845
##  [495] 607.4647 525.2464 601.9312 393.1189 581.0030 537.7657 453.3838 318.0283 508.4975 531.2463 373.1126 548.7601 623.4519
##  [508] 440.0869 652.5000 437.5633 506.5816 415.4071 516.0706 544.6454 487.4728 544.8934 566.9092 617.6771 548.2616 631.0511
##  [521] 473.4739 571.3268 368.3856 501.6164 522.8763 629.5952 457.4299 527.2467 326.8235 513.6585 420.4447 447.2285 441.3478
##  [534] 517.2391 292.0001 494.4801 527.8838 542.8061 566.1641 578.9908 357.2008 473.6306 677.2587 535.5803 301.3727 403.7398
##  [547] 414.6190 625.7101 433.4926 513.9790 290.1241 249.8849 590.1190 487.6803 571.0442 601.2068 469.5465 475.7392 432.6426
##  [560] 496.2470 418.4045 303.4358 726.0839 609.2849 500.5518 578.1233 408.7615 380.4873 594.1007 499.7439 531.1113 368.6508
##  [573] 455.1496 609.9466 458.9388 604.4078 402.9088 415.8239 448.0483 462.1295 522.6474 487.6938 456.0863 577.8719 340.5999
##  [586] 633.7612 443.4922 454.3063 610.4940 435.0683 599.6636 397.2973 374.6455 325.8588 321.3024 482.7620 374.4408 425.1393
##  [599] 510.4970 531.1596 645.9354 448.5209 531.6261 348.1992 476.0654 562.8976 379.9974 532.0484 445.4427 634.4011 368.7167
##  [612] 672.7004 565.7535 491.0597 731.4451 604.8716 421.3364 300.1127 440.5535 527.3207 420.5020 543.1092 499.6028 422.6449
##  [625] 742.7753 436.8232 530.8857 546.1302 647.6666 448.8163 366.9691 396.1402 562.1381 741.5654 426.0017 551.1103 478.2167
##  [638] 600.2266 532.1149 436.3339 660.6611 354.6999 488.2334 632.6080 390.4946 389.2055 641.5392 502.8989 586.2955 447.9865
##  [651] 349.9972 500.9418 283.4726 583.2403 523.0787 475.2691 539.1305 525.1959 503.8490 297.1299 485.4389 480.3741 525.1787
##  [664] 659.0466 519.6565 513.0671 360.0704 637.1515 586.5342 580.8653 435.4805 624.2765 464.9148 409.2928 565.2380 556.4711
##  [677] 392.7148 588.4800 616.1251 523.3135 495.8529 359.6408 597.8614 557.3185 547.4084 554.3561 469.9123 471.6370 552.7903
##  [690] 457.7323 509.1782 484.3411 310.7837 349.0889 469.9034 736.6610 482.3783 423.4637 607.1870 525.9129 456.5308 358.0275
##  [703] 605.7850 646.5580 477.9809 377.2324 403.8891 601.9674 613.8450 408.5394 510.2801 372.3809 693.2728 609.3073 704.5412
##  [716] 441.4024 623.5082 511.3888 539.7074 465.6184 663.6630 699.4078 444.3459 485.8474 463.9139 436.9269 583.1504 435.3909
##  [729] 584.0109 687.2442 626.6060 504.6432 497.2372 306.4394 430.5330 566.2029 441.3459 484.8510 524.0242 440.1531 554.9754
##  [742] 572.8674 558.5630 621.3363 635.4167 549.3009 548.0824 469.9470 728.0815 691.3732 650.7351 311.2510 528.0012 513.0207
##  [755] 443.2585 495.4862 494.3729 577.6868 511.6519 387.7507 500.9570 528.0799 392.6372 575.0573 649.4153 424.9899 445.2550
##  [768] 589.0665 456.6779 417.0215 494.1086 466.9487 507.0484 617.9516 408.3503 486.6273 519.3648 367.0132 603.6742 357.5127
##  [781] 459.2164 414.9186 477.9580 375.7157 227.5575 447.0915 552.5945 541.2205 477.3557 511.3888 366.3676 541.8846 641.1269
##  [794] 493.1544 444.6010 571.4874 507.8334 376.4408 729.4874 607.8687 453.6202 377.1565 284.5644 514.1725 582.8606 423.0604
##  [807] 485.5145 430.1117 616.0109 367.8656 393.5513 450.6351 475.9432 513.4465 620.5404 560.5519 450.3671 520.9705 493.8261
##  [820] 507.4381 665.0495 325.3849 508.1991 343.4316 380.3415 424.6257 606.1888 579.1084 462.3792 389.8099 490.8874 591.3056
##  [833] 465.1908 624.4178 423.0522 253.6473 462.7211 452.0061 365.4780 334.9249 430.0378 310.6141 587.8560 435.5059 352.7550
##  [846] 366.2667 496.9301 464.1797 426.3634 524.6137 575.3314 462.3060 354.1794 577.5041 288.6520 467.3059 478.7292 635.0938
##  [859] 467.7270 610.1464 442.0070 583.9132 363.9433 530.5671 549.5344 468.3479 466.9145 655.7451 512.8609 504.2036 538.2761
##  [872] 475.7039 458.7146 418.8669 606.1192 448.4299 387.2663 474.5578 576.6278 502.9695 509.4259 505.9550 557.8631 606.7899
##  [885] 546.4254 517.9671 456.8737 534.7139 532.2812 506.9922 437.5018 354.5535 547.5040 546.1719 496.7769 594.6566 566.8912
##  [898] 651.1099 569.2072 399.9619 499.5997 453.0542 503.6737 479.9079 603.6589 588.4268 480.5298 719.0702 476.4992 463.0849
##  [911] 515.4054 557.1812 480.2085 517.2196 429.5344 664.7642 565.2157 489.8956 502.2124 514.0178 534.4487 468.6748 477.4474
##  [924] 428.4724 342.0031 591.6231 361.7524 579.8610 503.2338 531.1024 378.8424 436.3192 708.5300 524.2979 451.3790 368.0187
##  [937] 343.0128 649.4367 593.2486 716.6372 566.0013 563.3512 323.0505 712.7242 283.4797 593.6304 368.4733 586.7725 402.3331
##  [950] 557.0522 511.9797 398.3025 623.5914 529.3349 515.1055 495.3027 594.1564 578.8444 386.4326 402.7863 526.0448 507.9440
##  [963] 334.2873 398.9222 523.8656 365.6481 488.9171 459.0526 286.3321 337.5755 613.3931 478.8902 514.2966 745.8776 475.3705
##  [976] 517.7410 544.9654 630.6918 565.4086 335.1642 531.3661 436.6194 427.9133 425.6029 557.2813 501.2163 547.3963 370.5879
##  [989] 490.5978 447.3090 512.0111 506.0593 444.2074 446.8414 401.0092 463.4028 441.7573 460.8381 494.1673 437.6966
##  [ reached getOption(&quot;max.print&quot;) -- omitted 1500 entries ]</code></pre>
</div>
<div id="find-cohens-kappa-interrater-reliability" class="section level2" number="14.2">
<h2 number="14.2"><span class="header-section-number">14.2</span> Find Cohen’s Kappa (Interrater reliability)</h2>
<p>Useful for IRR agreement on categorical variables</p>
<p>Going to use the <code>psych</code> package for this:
<a href="https://www.rdocumentation.org/packages/psych/versions/2.1.6/topics/cohen.kappa" class="uri">https://www.rdocumentation.org/packages/psych/versions/2.1.6/topics/cohen.kappa</a></p>
<p>See <a href="https://www.statisticshowto.com/cohens-kappa-statistic/">here</a> for an overview of what Cohen’s Kappa is if you need a recap/intro.</p>
</div>
<div id="statistical-tests-and-modeling-with-easystats" class="section level2" number="14.3">
<h2 number="14.3"><span class="header-section-number">14.3</span> Statistical tests and modeling with <code>easystats</code></h2>
<p><a href="https://easystats.github.io/easystats/" class="uri">https://easystats.github.io/easystats/</a></p>
<div id="getting-parameter-estimates-from-model-objects" class="section level3" number="14.3.1">
<h3 number="14.3.1"><span class="header-section-number">14.3.1</span> Getting parameter estimates from model objects</h3>
<p>Scenario: You’ve run some statistical test (like the below regression), and want a summary of the model estimates.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(iris)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span></code></pre></div>
<p>You have a few options when it comes to getting a summary of a model and getting the coefficient estimates:
- <code>summary()</code>
- <code>broom::tidy()</code>
- <code>paramters::model_paramters()</code>, or just <code>paramters::paramters()</code> for short</p>
<p><em>There’s no reason to use <code>summary</code>, generally speaking, because it sucks. It doesn’t give you tidy output that’s easy to manipulate or extract, it’s hard to read, and it can’t be turned into a useful table. Skip it unless you need something specific from it’s output (i.e., you’re using lavaan)</em></p>
<p>Options two and three are pretty similar and both give you most of the same information, though <code>parameters()</code> prints neater to the console window. Generally I find <code>parameters</code> preferable.</p>
<p>Note though that <em>neither command</em> will round the numbers if you store it as a table in the environment. So….</p>
<ol style="list-style-type: decimal">
<li>If you want to manipulate ANY info in the table and/or extract info, just use <code>tidy</code> or <code>parameters</code>.</li>
<li>If you’re using the command to export said info in a neat table, or you want to view it in a more readable fashion and <em>do not care about extracting/modifying/manipulating anything in it</em>, then use <code>parameters</code> and pipe it to <code>format_table()</code></li>
</ol>
<p>Using <code>format_table()</code> rounds all columns to 2 decimal places, reformats p-values to APA format, and collapses CI’s into a single column. Do note though that it makes every column into a Character column! So this is for exporting-use only.</p>
<p>Here’s a comparison of broom’s output (first) vs. parameter’s (second) when you save each in the environment. As you can see, both produce tidy tibbles</p>
<p><img src="pics/tidy.png" width="230" /></p>
<p><img src="pics/parameters.png" width="354" />
And here’s what <code>parameters(model) |&gt; format_table()</code> does to the a parameters table:</p>
<p><img src="pics/format_table.png" width="244" />
Much cleaner for making a table to export to Word.</p>
</div>
<div id="getting-model-information-and-performance-metrics" class="section level3" number="14.3.2">
<h3 number="14.3.2"><span class="header-section-number">14.3.2</span> Getting model information and performance metrics</h3>
<p>Again, two options here. You can use either <code>glance</code> from the broom package, or <code>performance</code> from the package of the same name. These each produce slightly different output, though unlike above, I don’t think one is necessarily better than the other. Use whichever one you prefer.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(model)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 12
##   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC deviance df.residual  nobs
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
## 1     0.619         0.614 0.515      119. 1.67e-31     2  -112.  231.  243.     39.0         147   150</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">performance</span>(model)</span></code></pre></div>
<pre><code>## # Indices of model performance
## 
## AIC     |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma
## -----------------------------------------------------
## 231.452 | 243.494 | 0.619 |     0.614 | 0.510 | 0.515</code></pre>
</div>
<div id="effect-size-info-with-effectsize" class="section level3" number="14.3.3">
<h3 number="14.3.3"><span class="header-section-number">14.3.3</span> Effect size info with <code>effectsize</code></h3>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>logreg_model<span class="ot">=</span><span class="fu">glm</span>(smoke <span class="sc">~</span> age <span class="sc">+</span> sex, <span class="at">data=</span> legaldmlab<span class="sc">::</span>survey, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>logreg_model_coeff<span class="ot">=</span>parameters<span class="sc">::</span><span class="fu">parameters</span>(logreg_model)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>logreg_model_coeff<span class="ot">=</span>logreg_model_coeff <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">odds_ratio=</span><span class="fu">exp</span>(Coefficient))</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_oddsratio</span>(logreg_model_coeff<span class="sc">$</span>odds_ratio, <span class="at">rules =</span> <span class="st">&quot;chen2010&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;small&quot;      &quot;very small&quot; &quot;very small&quot;
## (Rules: chen2010)</code></pre>
</div>
<div id="quick-detailed-and-automated-reporting-with-report" class="section level3" number="14.3.4">
<h3 number="14.3.4"><span class="header-section-number">14.3.4</span> Quick, detailed, and automated reporting with <code>report</code></h3>
<p>Check out <a href="https://easystats.github.io/report/" class="uri">https://easystats.github.io/report/</a></p>
</div>
<div id="running-correlations-with-correlation" class="section level3" number="14.3.5">
<h3 number="14.3.5"><span class="header-section-number">14.3.5</span> Running correlations with <code>correlation</code></h3>
<p><a href="https://easystats.github.io/correlation/" class="uri">https://easystats.github.io/correlation/</a></p>
<!--chapter:end:12-stats.Rmd-->
</div>
</div>
</div>
<div id="coding-tips-and-tricks" class="section level1" number="15">
<h1 number="15"><span class="header-section-number">15</span> Coding Tips and Tricks</h1>
<div id="grammar-stuff-in-base-r" class="section level2" number="15.1">
<h2 number="15.1"><span class="header-section-number">15.1</span> Grammar stuff in base R</h2>
<div id="regex-expressions-and-symbols" class="section level3" number="15.1.1">
<h3 number="15.1.1"><span class="header-section-number">15.1.1</span> Regex expressions and symbols</h3>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_remove</span>(html<span class="sc">$</span><span class="st">`</span><span class="at">Market Price</span><span class="st">`</span>, <span class="at">pattern =</span> <span class="st">&quot;$&quot;</span>) <span class="co"># doesn&#39;t remove the $ sign</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_remove</span>(html<span class="sc">$</span><span class="st">`</span><span class="at">Market Price</span><span class="st">`</span>, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">$&quot;</span>) <span class="co"># works</span></span></code></pre></div>
</div>
<div id="the-new-pipe-base-r" class="section level3" number="15.1.2">
<h3 number="15.1.2"><span class="header-section-number">15.1.2</span> The new pipe (Base R)</h3>
<p>Good reading material/stuff to know: <a href="https://www.r-bloggers.com/2021/05/the-new-r-pipe/?__twitter_impression=true&amp;" class="uri">https://www.r-bloggers.com/2021/05/the-new-r-pipe/?__twitter_impression=true&amp;</a></p>
<p>Not really any functional differences from the tidyverse pipe, but using this instead puts one less dependency in your code. So it’s probably worth changing.</p>
<p>You can set this in the global options in RStudio.</p>
</div>
</div>
<div id="tidyverse-stuff" class="section level2" number="15.2">
<h2 number="15.2"><span class="header-section-number">15.2</span> Tidyverse stuff</h2>
<div id="sometimes-when-making-a-function-you-need-to-use-the-colon-equals-operator-rather-than-just-the-normal---or-assignment-operators" class="section level3" number="15.2.1">
<h3 number="15.2.1"><span class="header-section-number">15.2.1</span> Sometimes when making a function you need to use the colon-equals operator, rather than just the normal &lt;- or = assignment operators</h3>
<p>Specifically, when you have multiple named arguments in your function
Read my question and someone’s answer on this blogpost: <a href="https://community.rstudio.com/t/help-creating-simple-function/109011/2" class="uri">https://community.rstudio.com/t/help-creating-simple-function/109011/2</a></p>
</div>
</div>
<div id="function-related-stuff" class="section level2" number="15.3">
<h2 number="15.3"><span class="header-section-number">15.3</span> Function-related stuff</h2>
<div id="user-supplied-expressions-or-named-columns-in-functions" class="section level3" number="15.3.1">
<h3 number="15.3.1"><span class="header-section-number">15.3.1</span> User-supplied expressions or named columns in functions</h3>
</div>
<div id="when-a-command-requires-a-named-column-or-data-set-but-youve-already-supplied-it-and-its-required-a-second-time" class="section level3" number="15.3.2">
<h3 number="15.3.2"><span class="header-section-number">15.3.2</span> When a command requires a named column or data set, but you’ve already supplied it and it’s required a second time</h3>
<p>If you’re writing a function with a pipe but the command you’re using needs the data set defined in it, you specify it as .x
Here is an example:</p>
</div>
<div id="formulas-within-functions" class="section level3" number="15.3.3">
<h3 number="15.3.3"><span class="header-section-number">15.3.3</span> Formulas within functions</h3>
<p>Generally when you see <code>.fn</code> inside a function (e.g., <code>map(x, .fn)</code>), that means <em>function</em>. You put whatever formula or function you want in there. You may also see the tilde used instead, which does the same thing.</p>
</div>
</div>
<div id="creating-a-package" class="section level2" number="15.4">
<h2 number="15.4"><span class="header-section-number">15.4</span> Creating a package</h2>
<p><a href="https://rstudio4edu.github.io/rstudio4edu-book/data-pkg.html" class="uri">https://rstudio4edu.github.io/rstudio4edu-book/data-pkg.html</a></p>
<div id="documenting-pacakge-meta-data" class="section level3" number="15.4.1">
<h3 number="15.4.1"><span class="header-section-number">15.4.1</span> Documenting pacakge meta-data</h3>
<p><a href="https://r-pkgs.org/description.html" class="uri">https://r-pkgs.org/description.html</a></p>
</div>
<div id="connecting-to-other-packages" class="section level3" number="15.4.2">
<h3 number="15.4.2"><span class="header-section-number">15.4.2</span> Connecting to other packages</h3>
<p><a href="https://kbroman.org/pkg_primer/pages/depends.html" class="uri">https://kbroman.org/pkg_primer/pages/depends.html</a></p>
</div>
<div id="linking-git-and-github" class="section level3" number="15.4.3">
<h3 number="15.4.3"><span class="header-section-number">15.4.3</span> Linking Git and Github</h3>
<p><a href="https://r-pkgs.org/git.html#git-rstudio">view this detailed guide</a> by Jenny Bryan, and <a href="https://www.youtube.com/watch?v=XbSwdHBiO4E">this YouTube video</a>.</p>
<p>Quick summary of steps in YouTube video:</p>
<ol style="list-style-type: decimal">
<li><p>Open project folder in Windows Explorer and click in the URL bar, then type <code>cmd</code> to open command prompt</p></li>
<li><p>If there are any pre-existing git files or repository info there, remove it with the following:</p></li>
</ol>
<ul>
<li><code>rd .git /S/Q</code></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Tell git to create a new repo by typing:</li>
</ol>
<ul>
<li><code>git init</code></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Then tell it to include all files in the current place by typing:</li>
</ol>
<ul>
<li><code>git add .</code></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Commit these files with:</li>
</ol>
<ul>
<li><code>git commit -m "Initial commit"</code></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>At this point you’ve created a git and GitHub repo each; now link them with:</li>
</ol>
<ul>
<li><code>git remote add origin [https URL of GitHub repo]</code></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Push all these changes live with:</li>
</ol>
<ul>
<li><code>git push -u origin master</code></li>
</ul>
</div>
</div>
<div id="creating-a-bookdown" class="section level2" number="15.5">
<h2 number="15.5"><span class="header-section-number">15.5</span> Creating a bookdown</h2>
<p><a href="https://www.youtube.com/watch?app=desktop&amp;v=m5D-yoH416Y&amp;feature=youtu.be" class="uri">https://www.youtube.com/watch?app=desktop&amp;v=m5D-yoH416Y&amp;feature=youtu.be</a></p>
<div id="rendering-the-book-once-its-done" class="section level3" number="15.5.1">
<h3 number="15.5.1"><span class="header-section-number">15.5.1</span> Rendering the book once it’s done</h3>
<ol style="list-style-type: decimal">
<li><p>Render locally with bookdown::render_book(“index.Rmd”)</p></li>
<li><p>Use <code>browseURL("docs/index.html")</code> to view your book locally (or just open <code>index.html</code> in a browser).</p></li>
<li><p>If it looks good, commit and push all changed files to GitHub.</p></li>
</ol>
<!--chapter:end:13-advanced.Rmd-->
</div>
</div>
</div>
<div id="creating-a-simulated-data-set" class="section level1" number="16">
<h1 number="16"><span class="header-section-number">16</span> Creating a simulated data set</h1>
<p>From the tutorial <a href="https://debruine.github.io/tutorials/sim-data.html">on this page</a></p>
<div id="part-1-independent-samples-from-a-normal-distribution" class="section level2" number="16.1">
<h2 number="16.1"><span class="header-section-number">16.1</span> Part 1: Independent samples from a normal distribution</h2>
<p>Consider the following first before you start doing stuff: - How many subjects are in each condition? - What are the means and standard deviations of each group?</p>
<p>Set that shit below.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of subjects per group</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>A_sub_n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>B_sub_n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution parameters</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>A_mean  <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>A_sd    <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>B_mean  <span class="ot">&lt;-</span> <span class="dv">11</span></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>B_sd    <span class="ot">&lt;-</span> <span class="fl">2.5</span></span></code></pre></div>
<p>Now generate scores for each group</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>A_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(A_sub_n, A_mean, A_sd)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>B_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(B_sub_n, B_mean, B_sd)</span></code></pre></div>
<p>Technically you <em>could</em> stop here and just analyze the data in this fashion…but its better to organize it into a table. One that looks like something you would import after real data collection.</p>
<p>So do that next; make it look nice.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_condition =</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(A_sub_n, B_sub_n) ),</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(A_scores, B_scores)</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   sub_condition score
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 A             11.4 
## 2 A             12.0 
## 3 A             12.5 
## 4 A              8.84
## 5 A              6.84
## 6 A             11.0</code></pre>
<p>Always perform a quality and consistency check on your data to verify that shit’s ok.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_condition) <span class="sc">%&gt;%</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>() ,</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(score),</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(score))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   sub_condition     n  mean    sd
##   &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A                50  9.98  2.78
## 2 B                50 10.9   3.02</code></pre>
</div>
<div id="part-2-creating-data-sets-with-quantitative-and-categorical-variables" class="section level2" number="16.2">
<h2 number="16.2"><span class="header-section-number">16.2</span> Part 2: Creating data sets with quantitative and categorical variables</h2>
<p>From the web page <a href="https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/#creating-datasets-with-quantiative-and-categorical-variables">at this link</a></p>
<div id="a.-data-with-no-difference-among-groups" class="section level3" number="16.2.1">
<h3 number="16.2.1"><span class="header-section-number">16.2.1</span> 2.a. DATA WITH <strong>NO DIFFERENCE</strong> AMONG GROUPS</h3>
<p><strong>Critically important notes to know</strong>: When you use the <code>rep()</code> function, there are several different arguments you can specify inside it that control how stuff is repeated:</p>
<ul>
<li>using <code>rep(x, each= )</code> repeats things <em>element-wise</em>; each element gets replicated n times, in order</li>
</ul>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>), <span class="at">each=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot;</code></pre>
<ul>
<li>using <code>rep(x, times= )</code> repeats the <em>sequence</em>; the vector as a whole, as it appears, will be repeated with one sequence following the next</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>), <span class="at">times=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot;</code></pre>
<ul>
<li>using <code>rep(x, length.out)</code> repeats <em>only the number of elements you specify</em>, in their original order</li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>), <span class="at">length.out=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot;</code></pre>
<p>In this particular data, we want <em>every combination of <code>group</code> and <code>letter</code> to be present ONCE</em>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>letters<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">factor =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) )</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   group factor response
##   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 A     C       -0.559 
## 2 A     D        0.0378
## 3 A     E       -1.14  
## 4 B     C       -1.10  
## 5 B     D        0.509 
## 6 B     E       -0.304</code></pre>
</div>
<div id="b.-data-with-a-difference-among-groups" class="section level3" number="16.2.2">
<h3 number="16.2.2"><span class="header-section-number">16.2.2</span> 2.b. Data <strong>WITH A DIFFERENCE</strong> among groups</h3>
<p>What if we want data where the means are different between groups? Let’s make two groups of three observations where the mean of one group is 5 and the other is 10. The two groups have a shared variance (and so standard deviation) of 1.</p>
<div id="some-notes-first" class="section level4" number="16.2.2.1">
<h4 number="16.2.2.1"><span class="header-section-number">16.2.2.1</span> Some notes first</h4>
<p>Creating a difference between the two group’s average score means we have to tell R to sample itteratively from distributions with different means. We do this by specifying a vector of means within <code>rnorm</code>, like so:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>response</span></code></pre></div>
<pre><code>## [1]  4.066141  9.831952  4.307055 11.059641  4.808349 10.009015</code></pre>
<p>You can see that: 1. draw 1 is from the distribution <span class="math inline">\((\mu=5,\sigma=1)\)</span> 2. draw 2 is from the distribution <span class="math inline">\((\mu=5,\sigma=1)\)</span></p>
<p>And this process repeats a total of six times.</p>
<p>And if you happen to also specify a vector of standard deviations (purely to demonstrate what is happening, we won’t actually do this), <em>the first mean is paired with the first SD; the second mean is paired with the second SD; and so on.</em></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>## [1]  5.744356 10.043787  7.378609  9.952296  8.064520 10.119440</code></pre>
</div>
<div id="ok-back-to-creating-the-data" class="section level4" number="16.2.2.2">
<h4 number="16.2.2.2"><span class="header-section-number">16.2.2.2</span> Ok, back to creating the data</h4>
<p>If you want there to be differences between the groups, we need to change the way the vector of factors is replicated, in addition to specifying the vector of means. We want to ensure that the sequence of “A”, “B” in the <code>group</code> column matches the sequence repeated in the <code>response</code> column.</p>
<p>Here we are going to use <code>length.out</code> so that the whole sequence of A,B is repeated exactly in line with the alternating drawing from <span class="math inline">\(\mu=5\)</span>, <span class="math inline">\(\mu=10\)</span>.</p>
<p>It’s often best to do this by building each thing separately, and then combining it into a tibble when you have it figured out.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>group<span class="ot">=</span><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">6</span>)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>group</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot;</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>response<span class="ot">=</span><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>response</span></code></pre></div>
<pre><code>## [1]  4.948867 10.118024  3.109300  8.589811  4.047384 10.121841</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(group,</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>       response)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   group response
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 A         4.95
## 2 B        10.1 
## 3 A         3.11
## 4 B         8.59
## 5 A         4.05
## 6 B        10.1</code></pre>
</div>
</div>
<div id="c.-data-with-multiple-quantitative-variables-with-groups" class="section level3" number="16.2.3">
<h3 number="16.2.3"><span class="header-section-number">16.2.3</span> 2.c. Data with <strong>MULTIPLE QUANTITATIVE VARIABLES</strong> with groups</h3>
</div>
</div>
<div id="part-3-repeatedly-simulate-samples-with-replicate" class="section level2" number="16.3">
<h2 number="16.3"><span class="header-section-number">16.3</span> Part 3: Repeatedly simulate samples with replicate()</h2>
<p>Instead of drawing values one at a time from a distribution, we want to do it many times. This is a job for <code>replicate()</code>. What <code>replicate()</code> does is run a function repeatedly.</p>
<p>The <code>replicate()</code> function will perform a given operation as many times as you tell it to. Here we tell it to generate numbers from the distribution <span class="math inline">\(N~(\mu=0, \sigma=1)\)</span>, three times (as specified in the <code>n=3</code> argument in line one)</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">simplify =</span> <span class="cn">FALSE</span> )</span></code></pre></div>
<pre><code>## [[1]]
## [1]  1.3203910  0.2040899 -0.7970636 -1.2431823 -0.4844866
## 
## [[2]]
## [1] -1.2322047  0.1063858  0.7922842  0.4413982 -0.8931153
## 
## [[3]]
## [1]  1.7023983  0.1654943  0.7787761 -0.1186586 -0.2111680</code></pre>
<p>The argument <code>simplify=FALSE</code> tells it to return the output as a list. If you set this to <code>TRUE</code> it returns a matrix instead</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">simplify =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]
## [1,]  0.72115635  0.7402300  0.1134487
## [2,]  0.92810115 -1.1035296 -1.0247406
## [3,]  0.53107386  0.0286275 -0.3009290
## [4,] -0.01083094  0.5085364  1.7663764
## [5,] -0.51711197  0.3824463 -1.0787283</code></pre>
<p>Specifying <code>as.data.frame()</code> with the matrix output can turn it into a data frame.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">simplify =</span> <span class="cn">TRUE</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sample_a=</span>V1, <span class="at">sample_b=</span>V2, <span class="at">sample_c=</span>V3)</span></code></pre></div>
<pre><code>##      sample_a   sample_b   sample_c
## 1  0.56415036 -1.7060196  1.1146509
## 2 -0.24011787  1.8521680  1.4152690
## 3 -0.09948105  1.9130434  0.1568660
## 4 -1.76657069 -0.2574811 -1.0662388
## 5  0.67864934  0.5891597 -0.1166993</code></pre>
</div>
<div id="part-4-repeatedly-making-whole-data-sets" class="section level2" number="16.4">
<h2 number="16.4"><span class="header-section-number">16.4</span> Part 4: repeatedly making whole data sets</h2>
<p>This is combining parts 2 and 3 to repeatedly create and sample data sets, resulting in a list of many data sets.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>simlist <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) ),</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>simlist</span></code></pre></div>
<pre><code>## [[1]]
##   group   response
## 1     A -1.1482417
## 2     A -0.5806775
## 3     A  0.3688638
## 4     B  0.3304444
## 5     B  0.3483946
## 6     B -1.1257075
## 
## [[2]]
##   group   response
## 1     A  0.8829318
## 2     A -1.3660498
## 3     A -0.7142761
## 4     B -0.2700098
## 5     B -0.2419871
## 6     B -0.4623374
## 
## [[3]]
##   group   response
## 1     A -0.6018124
## 2     A  1.0289143
## 3     A  0.1779939
## 4     B  1.7056511
## 5     B -0.3255277
## 6     B -0.7897194</code></pre>
</div>
<div id="part-5-using-purrr" class="section level2" number="16.5">
<h2 number="16.5"><span class="header-section-number">16.5</span> Part 5: Using purrr</h2>
<p>See <a href="https://aosmith.rbind.io/2018/06/05/a-closer-look-at-replicate-and-purrr/">this blog post</a></p>
<!--chapter:end:14-creating_datasets.Rmd-->
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Kruschke, J. (2015). Goals, power, and sample size. In J. K. Kruschke (Ed.), Doing bayesian data analysis: A tutorial with r, jags, and stan (2nd ed., pp. 359-398). Academic Press.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
