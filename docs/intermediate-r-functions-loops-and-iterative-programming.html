<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Intermediate R: Functions, Loops, and Iterative Programming | Creating a simulated data set</title>
  <meta name="description" content="Chapter 10 Intermediate R: Functions, Loops, and Iterative Programming | Creating a simulated data set" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Intermediate R: Functions, Loops, and Iterative Programming | Creating a simulated data set" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Intermediate R: Functions, Loops, and Iterative Programming | Creating a simulated data set" />
  
  
  

<meta name="author" content="Ryan Schneider" />


<meta name="date" content="2022-06-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="misc.-stuff.html"/>
<link rel="next" href="intro-to-r-markdown.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Compendium</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> A Monument to my Madness</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-this-book-is-and-what-it-is-not"><i class="fa fa-check"></i><b>1.1</b> What this book is, and what it is not</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html"><i class="fa fa-check"></i><b>2</b> Introduction: R Basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#importing-data"><i class="fa fa-check"></i><b>2.1</b> Importing Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#spreadsheets"><i class="fa fa-check"></i><b>2.1.1</b> Spreadsheets</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#exporting-i.e.-saving-data-and-output"><i class="fa fa-check"></i><b>2.2</b> Exporting (i.e., saving) Data and Output</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#exporting-to-.csv"><i class="fa fa-check"></i><b>2.2.1</b> Exporting to .CSV</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#export-to-.rdata-and-load-the-data-again-later"><i class="fa fa-check"></i><b>2.2.2</b> Export to .RData (and load the data again later)</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#export-to-excel"><i class="fa fa-check"></i><b>2.2.3</b> Export to Excel</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-r-basics.html"><a href="introduction-r-basics.html#accessedit-specific-cell-number-values"><i class="fa fa-check"></i><b>2.2.4</b> Access/edit specific cell number values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangle-data.html"><a href="wrangle-data.html"><i class="fa fa-check"></i><b>3</b> Wrangle Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="wrangle-data.html"><a href="wrangle-data.html#joining-or-splitting"><i class="fa fa-check"></i><b>3.1</b> Joining or Splitting</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="wrangle-data.html"><a href="wrangle-data.html#whole-data-sets"><i class="fa fa-check"></i><b>3.1.1</b> Whole Data Sets</a></li>
<li class="chapter" data-level="3.1.2" data-path="wrangle-data.html"><a href="wrangle-data.html#individual-columnsvariables"><i class="fa fa-check"></i><b>3.1.2</b> Individual Columns/Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="wrangle-data.html"><a href="wrangle-data.html#selectingextracting-specific-variables-with-select"><i class="fa fa-check"></i><b>3.2</b> Selecting/extracting specific variables with <code>select()</code></a></li>
<li class="chapter" data-level="3.3" data-path="wrangle-data.html"><a href="wrangle-data.html#advanced-filtering-techniques"><i class="fa fa-check"></i><b>3.3</b> Advanced Filtering techniques</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="wrangle-data.html"><a href="wrangle-data.html#filter-based-on-partial-match"><i class="fa fa-check"></i><b>3.3.1</b> Filter based on partial match</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrangle-data.html"><a href="wrangle-data.html#filtering-based-on-multiple-conditions"><i class="fa fa-check"></i><b>3.3.2</b> Filtering based on multiple conditions</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrangle-data.html"><a href="wrangle-data.html#filtering-across-multiple-columns"><i class="fa fa-check"></i><b>3.3.3</b> Filtering across multiple columns</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangle-data.html"><a href="wrangle-data.html#if-then-and-case-when"><i class="fa fa-check"></i><b>3.4</b> If-then and Case-when</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="wrangle-data.html"><a href="wrangle-data.html#if-then"><i class="fa fa-check"></i><b>3.4.1</b> If-then</a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangle-data.html"><a href="wrangle-data.html#case-when"><i class="fa fa-check"></i><b>3.4.2</b> Case-when</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="wrangle-data.html"><a href="wrangle-data.html#conditional-replacement-of-values"><i class="fa fa-check"></i><b>3.5</b> Conditional replacement of values</a></li>
<li class="chapter" data-level="3.6" data-path="wrangle-data.html"><a href="wrangle-data.html#merging-variables"><i class="fa fa-check"></i><b>3.6</b> Merging variables</a></li>
<li class="chapter" data-level="3.7" data-path="wrangle-data.html"><a href="wrangle-data.html#apply-a-function-to-multiple-variables-at-once"><i class="fa fa-check"></i><b>3.7</b> Apply a function to multiple variables at once</a></li>
<li class="chapter" data-level="3.8" data-path="wrangle-data.html"><a href="wrangle-data.html#pivoting-i.e.-transposing-data"><i class="fa fa-check"></i><b>3.8</b> Pivoting (i.e., transposing) data</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="wrangle-data.html"><a href="wrangle-data.html#condense-multiple-rows-into-a-single-column-pivot-wide-to-long"><i class="fa fa-check"></i><b>3.8.1</b> Condense multiple rows into a single column (pivot wide to long)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="wrangle-data.html"><a href="wrangle-data.html#turn-row-names-into-a-columnvariable"><i class="fa fa-check"></i><b>3.9</b> Turn row names into a column/variable</a></li>
<li class="chapter" data-level="3.10" data-path="wrangle-data.html"><a href="wrangle-data.html#how-to-editchange-column-names"><i class="fa fa-check"></i><b>3.10</b> How to edit/change column names</a></li>
<li class="chapter" data-level="3.11" data-path="wrangle-data.html"><a href="wrangle-data.html#re-order-columns-in-a-data-set"><i class="fa fa-check"></i><b>3.11</b> Re-order columns in a data set</a></li>
<li class="chapter" data-level="3.12" data-path="wrangle-data.html"><a href="wrangle-data.html#date-and-time-variables"><i class="fa fa-check"></i><b>3.12</b> Date and time variables</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="wrangle-data.html"><a href="wrangle-data.html#date-time-objects"><i class="fa fa-check"></i><b>3.12.1</b> Date-time objects</a></li>
<li class="chapter" data-level="3.12.2" data-path="wrangle-data.html"><a href="wrangle-data.html#date-only-objects"><i class="fa fa-check"></i><b>3.12.2</b> Date-only objects</a></li>
<li class="chapter" data-level="3.12.3" data-path="wrangle-data.html"><a href="wrangle-data.html#find-the-difference-between-two-datestimes"><i class="fa fa-check"></i><b>3.12.3</b> Find the difference between two dates/times</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="wrangle-data.html"><a href="wrangle-data.html#reverse-code-a-variable"><i class="fa fa-check"></i><b>3.13</b> Reverse-code a variable</a></li>
<li class="chapter" data-level="3.14" data-path="wrangle-data.html"><a href="wrangle-data.html#dummy-coding-the-very-fast-and-easy-way"><i class="fa fa-check"></i><b>3.14</b> Dummy coding (the very fast and easy way)</a></li>
<li class="chapter" data-level="3.15" data-path="wrangle-data.html"><a href="wrangle-data.html#create-a-relative-ranking-among-several-variables"><i class="fa fa-check"></i><b>3.15</b> Create a relative ranking among several variables</a></li>
<li class="chapter" data-level="3.16" data-path="wrangle-data.html"><a href="wrangle-data.html#manipulating-the-working-environment-and-many-things-at-once"><i class="fa fa-check"></i><b>3.16</b> Manipulating the working environment and many things at once</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="wrangle-data.html"><a href="wrangle-data.html#stuff-the-whole-working-environment-into-a-list"><i class="fa fa-check"></i><b>3.16.1</b> Stuff the WHOLE working environment into a list</a></li>
<li class="chapter" data-level="3.16.2" data-path="wrangle-data.html"><a href="wrangle-data.html#extract-everything-from-a-list-into-the-environment"><i class="fa fa-check"></i><b>3.16.2</b> Extract everything from a list into the environment</a></li>
<li class="chapter" data-level="3.16.3" data-path="wrangle-data.html"><a href="wrangle-data.html#delete-everything-in-the-entire-environment-except-for-one-item"><i class="fa fa-check"></i><b>3.16.3</b> Delete everything in the entire environment, except for one item</a></li>
</ul></li>
<li class="chapter" data-level="3.17" data-path="wrangle-data.html"><a href="wrangle-data.html#wrangling-lists"><i class="fa fa-check"></i><b>3.17</b> Wrangling Lists</a>
<ul>
<li class="chapter" data-level="3.17.1" data-path="wrangle-data.html"><a href="wrangle-data.html#nesting"><i class="fa fa-check"></i><b>3.17.1</b> Nesting</a></li>
<li class="chapter" data-level="3.17.2" data-path="wrangle-data.html"><a href="wrangle-data.html#combiningcollapsing-list-levels-reducing"><i class="fa fa-check"></i><b>3.17.2</b> Combining/collapsing list levels (Reducing)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clean-data.html"><a href="clean-data.html"><i class="fa fa-check"></i><b>4</b> Clean Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="clean-data.html"><a href="clean-data.html#replace-a-value-with-na"><i class="fa fa-check"></i><b>4.1</b> Replace a value with NA</a></li>
<li class="chapter" data-level="4.2" data-path="clean-data.html"><a href="clean-data.html#replace-nas-with-a-value"><i class="fa fa-check"></i><b>4.2</b> Replace NA’s with a value</a></li>
<li class="chapter" data-level="4.3" data-path="clean-data.html"><a href="clean-data.html#identify-columns-or-rows-with-missing-values"><i class="fa fa-check"></i><b>4.3</b> Identify columns or rows with Missing values</a></li>
<li class="chapter" data-level="4.4" data-path="clean-data.html"><a href="clean-data.html#find-the-percentage-of-a-variable-that-is-missing"><i class="fa fa-check"></i><b>4.4</b> Find the percentage of a variable that is missing</a></li>
<li class="chapter" data-level="4.5" data-path="clean-data.html"><a href="clean-data.html#exclude-missing-values-from-analysis"><i class="fa fa-check"></i><b>4.5</b> Exclude Missing values from analysis</a></li>
<li class="chapter" data-level="4.6" data-path="clean-data.html"><a href="clean-data.html#dropping-missing-values-from-the-data-set"><i class="fa fa-check"></i><b>4.6</b> Dropping Missing values from the data set</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="working-with-factors.html"><a href="working-with-factors.html"><i class="fa fa-check"></i><b>5</b> Working with Factors</a>
<ul>
<li class="chapter" data-level="5.1" data-path="working-with-factors.html"><a href="working-with-factors.html#manually-recodechange-a-factors-levels"><i class="fa fa-check"></i><b>5.1</b> Manually recode/change a factor’s levels</a></li>
<li class="chapter" data-level="5.2" data-path="working-with-factors.html"><a href="working-with-factors.html#collapse-factor-levels"><i class="fa fa-check"></i><b>5.2</b> Collapse factor levels</a></li>
<li class="chapter" data-level="5.3" data-path="working-with-factors.html"><a href="working-with-factors.html#add-levels-to-a-factor"><i class="fa fa-check"></i><b>5.3</b> Add levels to a factor</a></li>
<li class="chapter" data-level="5.4" data-path="working-with-factors.html"><a href="working-with-factors.html#drop-unused-levels"><i class="fa fa-check"></i><b>5.4</b> Drop unused levels</a></li>
<li class="chapter" data-level="5.5" data-path="working-with-factors.html"><a href="working-with-factors.html#change-the-order-of-a-factors-levels"><i class="fa fa-check"></i><b>5.5</b> Change the order of a factor’s levels</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="working-with-strings.html"><a href="working-with-strings.html"><i class="fa fa-check"></i><b>6</b> Working with Strings</a>
<ul>
<li class="chapter" data-level="6.1" data-path="working-with-strings.html"><a href="working-with-strings.html#remove-a-pattern-from-a-string"><i class="fa fa-check"></i><b>6.1</b> Remove a pattern from a string</a></li>
<li class="chapter" data-level="6.2" data-path="working-with-strings.html"><a href="working-with-strings.html#replace-one-pattern-in-a-string-with-another"><i class="fa fa-check"></i><b>6.2</b> Replace one pattern in a string with another</a></li>
<li class="chapter" data-level="6.3" data-path="working-with-strings.html"><a href="working-with-strings.html#find-i.e.-filter-for-all-instances-of-a-string"><i class="fa fa-check"></i><b>6.3</b> Find (i.e., filter for) all instances of a string</a></li>
<li class="chapter" data-level="6.4" data-path="working-with-strings.html"><a href="working-with-strings.html#drop-all-rows-from-a-data-set-that-contain-a-certain-string"><i class="fa fa-check"></i><b>6.4</b> Drop all rows from a data set that contain a certain string</a></li>
<li class="chapter" data-level="6.5" data-path="working-with-strings.html"><a href="working-with-strings.html#force-all-letters-to-lower-case"><i class="fa fa-check"></i><b>6.5</b> Force all letters to lower case</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html"><i class="fa fa-check"></i><b>7</b> Figures and Graphs with the ggplot and see packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#commands-for-ggplot-graph-types"><i class="fa fa-check"></i><b>7.1</b> Commands for ggplot graph types</a></li>
<li class="chapter" data-level="7.2" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#specific-commands-for-specific-types-of-analysis"><i class="fa fa-check"></i><b>7.2</b> Specific Commands for Specific Types of Analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#lavaan-stuff"><i class="fa fa-check"></i><b>7.2.1</b> lavaan stuff</a></li>
<li class="chapter" data-level="7.2.2" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#bayes-stuff"><i class="fa fa-check"></i><b>7.2.2</b> Bayes stuff</a></li>
<li class="chapter" data-level="7.2.3" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#histograms-and-density-curves"><i class="fa fa-check"></i><b>7.2.3</b> Histograms and density curves</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#highlight-specific-points"><i class="fa fa-check"></i><b>7.3</b> Highlight specific points</a></li>
<li class="chapter" data-level="7.4" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#add-labels-to-data-points"><i class="fa fa-check"></i><b>7.4</b> Add labels to data points</a></li>
<li class="chapter" data-level="7.5" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#plotting-multiple-graphs-at-once"><i class="fa fa-check"></i><b>7.5</b> Plotting multiple graphs at once</a></li>
<li class="chapter" data-level="7.6" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#change-the-colors-bars-columns-dots-etc."><i class="fa fa-check"></i><b>7.6</b> Change the colors (bars; columns; dots; etc.)</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#fine-tuning-colors"><i class="fa fa-check"></i><b>7.6.1</b> Fine-tuning colors</a></li>
<li class="chapter" data-level="7.6.2" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#more-options-with-the-see-package"><i class="fa fa-check"></i><b>7.6.2</b> More options with the see package</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#other-aesthetic-mappings"><i class="fa fa-check"></i><b>7.7</b> Other aesthetic mappings</a></li>
<li class="chapter" data-level="7.8" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#adding-and-customizing-text"><i class="fa fa-check"></i><b>7.8</b> Adding and Customizing Text</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#add-a-title-axis-labels-and-captions"><i class="fa fa-check"></i><b>7.8.1</b> Add a title, axis labels, and captions</a></li>
<li class="chapter" data-level="7.8.2" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#center-graph-title"><i class="fa fa-check"></i><b>7.8.2</b> Center graph title</a></li>
<li class="chapter" data-level="7.8.3" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#use-different-fonts"><i class="fa fa-check"></i><b>7.8.3</b> Use different fonts</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#remove-gridlines"><i class="fa fa-check"></i><b>7.9</b> Remove gridlines</a></li>
<li class="chapter" data-level="7.10" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#faceting"><i class="fa fa-check"></i><b>7.10</b> Faceting</a></li>
<li class="chapter" data-level="7.11" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#log-transformations"><i class="fa fa-check"></i><b>7.11</b> Log transformations</a></li>
<li class="chapter" data-level="7.12" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#changing-the-scale-of-the-axis"><i class="fa fa-check"></i><b>7.12</b> Changing the scale of the axis</a></li>
<li class="chapter" data-level="7.13" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#add-a-regression-line"><i class="fa fa-check"></i><b>7.13</b> Add a regression line</a></li>
<li class="chapter" data-level="7.14" data-path="figures-and-graphs-with-the-ggplot-and-see-packages.html"><a href="figures-and-graphs-with-the-ggplot-and-see-packages.html#save-a-graph-or-figure"><i class="fa fa-check"></i><b>7.14</b> Save a graph or figure</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html"><i class="fa fa-check"></i><b>8</b> Making Tables with flextable</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html#apa-table-components"><i class="fa fa-check"></i><b>8.1</b> APA Table Components</a></li>
<li class="chapter" data-level="8.2" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html#indent-values"><i class="fa fa-check"></i><b>8.2</b> Indent values</a></li>
<li class="chapter" data-level="8.3" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html#add-a-horizontal-border-aka-horizontal-spanner"><i class="fa fa-check"></i><b>8.3</b> Add a Horizontal border (AKA horizontal “spanner”)</a></li>
<li class="chapter" data-level="8.4" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html#change-font-and-font-size"><i class="fa fa-check"></i><b>8.4</b> Change font and font size</a></li>
<li class="chapter" data-level="8.5" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html#grouped-table"><i class="fa fa-check"></i><b>8.5</b> Grouped table</a></li>
<li class="chapter" data-level="8.6" data-path="making-tables-with-flextable.html"><a href="making-tables-with-flextable.html#complete-example"><i class="fa fa-check"></i><b>8.6</b> Complete Example</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="misc.-stuff.html"><a href="misc.-stuff.html"><i class="fa fa-check"></i><b>9</b> Misc. Stuff</a>
<ul>
<li class="chapter" data-level="9.1" data-path="misc.-stuff.html"><a href="misc.-stuff.html#scrape-web-pages-for-data-tables"><i class="fa fa-check"></i><b>9.1</b> Scrape web pages for data tables</a></li>
<li class="chapter" data-level="9.2" data-path="misc.-stuff.html"><a href="misc.-stuff.html#read-spss-files-into-r"><i class="fa fa-check"></i><b>9.2</b> Read SPSS files into R</a></li>
<li class="chapter" data-level="9.3" data-path="misc.-stuff.html"><a href="misc.-stuff.html#turn-numbers-into-percentages"><i class="fa fa-check"></i><b>9.3</b> Turn numbers into percentages</a></li>
<li class="chapter" data-level="9.4" data-path="misc.-stuff.html"><a href="misc.-stuff.html#find-all-possible-combindations-of-items-in-a-vector"><i class="fa fa-check"></i><b>9.4</b> Find all possible combindations of items in a vector</a></li>
<li class="chapter" data-level="9.5" data-path="misc.-stuff.html"><a href="misc.-stuff.html#download-files-from-the-internet"><i class="fa fa-check"></i><b>9.5</b> Download files from the internet</a></li>
<li class="chapter" data-level="9.6" data-path="misc.-stuff.html"><a href="misc.-stuff.html#print-multiple-things-in-one-statement"><i class="fa fa-check"></i><b>9.6</b> Print multiple things in one statement</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html"><i class="fa fa-check"></i><b>10</b> Intermediate R: Functions, Loops, and Iterative Programming</a>
<ul>
<li class="chapter" data-level="10.1" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#functions"><i class="fa fa-check"></i><b>10.1</b> Functions</a></li>
<li class="chapter" data-level="10.2" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#for-loops"><i class="fa fa-check"></i><b>10.2</b> For-loops</a></li>
<li class="chapter" data-level="10.3" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#purrr-and-iterative-functions"><i class="fa fa-check"></i><b>10.3</b> purrr and Iterative Functions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#reproducible-example-scraping-web-data"><i class="fa fa-check"></i><b>10.3.1</b> Reproducible example: Scraping web data</a></li>
<li class="chapter" data-level="10.3.2" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#non-reproducible-example-juvenile-life-without-parole-study"><i class="fa fa-check"></i><b>10.3.2</b> Non-reproducible example (Juvenile Life Without Parole study)</a></li>
<li class="chapter" data-level="10.3.3" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#example-3-readimport-several-files-at-once-with-map"><i class="fa fa-check"></i><b>10.3.3</b> Example 3: Read/Import several files at once with <code>map()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#other-purrr-commands"><i class="fa fa-check"></i><b>10.4</b> Other purrr commands</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#walk-and-walk2"><i class="fa fa-check"></i><b>10.4.1</b> <code>walk</code> and <code>walk2</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#map2"><i class="fa fa-check"></i><b>10.4.2</b> <code>map2</code></a></li>
<li class="chapter" data-level="10.4.3" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#pmap-for-when-you-have-a-bunch-of-shit"><i class="fa fa-check"></i><b>10.4.3</b> <code>pmap</code> for when you have a bunch of shit</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="intermediate-r-functions-loops-and-iterative-programming.html"><a href="intermediate-r-functions-loops-and-iterative-programming.html#using-purrr-to-manage-many-models"><i class="fa fa-check"></i><b>10.5</b> Using purrr to manage many models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html"><i class="fa fa-check"></i><b>11</b> Intro to R Markdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#important-code-chunk-options"><i class="fa fa-check"></i><b>11.1</b> Important code chunk options</a></li>
<li class="chapter" data-level="11.2" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#writing-math-equations-and-symbols"><i class="fa fa-check"></i><b>11.2</b> Writing math equations and symbols</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#greek-symbols"><i class="fa fa-check"></i><b>11.2.1</b> Greek symbols</a></li>
<li class="chapter" data-level="11.2.2" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#math-notation"><i class="fa fa-check"></i><b>11.2.2</b> Math notation</a></li>
<li class="chapter" data-level="11.2.3" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#statistics-notation"><i class="fa fa-check"></i><b>11.2.3</b> Statistics notation</a></li>
<li class="chapter" data-level="11.2.4" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#writing-in-line-code"><i class="fa fa-check"></i><b>11.2.4</b> Writing in-line code</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#including-graphicsinserting-pictures"><i class="fa fa-check"></i><b>11.3</b> Including graphics/inserting pictures</a></li>
<li class="chapter" data-level="11.4" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#footnotes"><i class="fa fa-check"></i><b>11.4</b> Footnotes</a></li>
<li class="chapter" data-level="11.5" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#change-the-color-of-your-text"><i class="fa fa-check"></i><b>11.5</b> Change the color of your text</a></li>
<li class="chapter" data-level="11.6" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#re-using-code-chunk-options"><i class="fa fa-check"></i><b>11.6</b> Re-using code chunk options</a></li>
<li class="chapter" data-level="11.7" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#making-better-tables"><i class="fa fa-check"></i><b>11.7</b> Making better tables</a></li>
<li class="chapter" data-level="11.8" data-path="intro-to-r-markdown.html"><a href="intro-to-r-markdown.html#running-in-line-code"><i class="fa fa-check"></i><b>11.8</b> Running in-line code</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html"><i class="fa fa-check"></i><b>12</b> Statistics and Psych-specific Stuff</a>
<ul>
<li class="chapter" data-level="12.1" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#create-or-sample-from-a-distribution"><i class="fa fa-check"></i><b>12.1</b> Create or sample from a distribution</a></li>
<li class="chapter" data-level="12.2" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#calculating-interrater-reliability"><i class="fa fa-check"></i><b>12.2</b> Calculating Interrater reliability</a></li>
<li class="chapter" data-level="12.3" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#statistical-tests-and-modeling-with-easystats"><i class="fa fa-check"></i><b>12.3</b> Statistical tests and modeling with <code>easystats</code></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#getting-parameter-estimates-from-model-objects"><i class="fa fa-check"></i><b>12.3.1</b> Getting parameter estimates from model objects</a></li>
<li class="chapter" data-level="12.3.2" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#getting-model-information-and-performance-metrics"><i class="fa fa-check"></i><b>12.3.2</b> Getting model information and performance metrics</a></li>
<li class="chapter" data-level="12.3.3" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#effect-size-info-with-effectsize"><i class="fa fa-check"></i><b>12.3.3</b> Effect size info with <code>effectsize</code></a></li>
<li class="chapter" data-level="12.3.4" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#quick-detailed-and-automated-reporting-with-report"><i class="fa fa-check"></i><b>12.3.4</b> Quick, detailed, and automated reporting with <code>report</code></a></li>
<li class="chapter" data-level="12.3.5" data-path="statistics-and-psych-specific-stuff.html"><a href="statistics-and-psych-specific-stuff.html#running-correlations-with-correlation"><i class="fa fa-check"></i><b>12.3.5</b> Running correlations with <code>correlation</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html"><i class="fa fa-check"></i><b>13</b> Advanced Coding Tips</a>
<ul>
<li class="chapter" data-level="13.1" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#grammar-and-syntax"><i class="fa fa-check"></i><b>13.1</b> Grammar and Syntax</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#regex-expressions-and-symbols"><i class="fa fa-check"></i><b>13.1.1</b> Regex expressions and symbols</a></li>
<li class="chapter" data-level="13.1.2" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#the-colon-equals-operator"><i class="fa fa-check"></i><b>13.1.2</b> The colon-equals (<code>:=</code>) operator</a></li>
<li class="chapter" data-level="13.1.3" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#user-supplied-expressions-or-named-columns-in-functions"><i class="fa fa-check"></i><b>13.1.3</b> User-supplied expressions or named columns in functions</a></li>
<li class="chapter" data-level="13.1.4" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#when-a-command-requires-a-named-column-or-data-set-but-youve-already-supplied-it-and-its-required-a-second-time"><i class="fa fa-check"></i><b>13.1.4</b> When a command requires a named column or data set, but you’ve already supplied it and it’s required a second time</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#creating-a-package"><i class="fa fa-check"></i><b>13.2</b> Creating a package</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#documenting-package-meta-data"><i class="fa fa-check"></i><b>13.2.1</b> Documenting package meta-data</a></li>
<li class="chapter" data-level="13.2.2" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#connecting-to-other-packages"><i class="fa fa-check"></i><b>13.2.2</b> Connecting to other packages</a></li>
<li class="chapter" data-level="13.2.3" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#linking-git-and-github"><i class="fa fa-check"></i><b>13.2.3</b> Linking Git and Github</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#creating-a-bookdown"><i class="fa fa-check"></i><b>13.3</b> Creating a bookdown</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="advanced-coding-tips.html"><a href="advanced-coding-tips.html#rendering-the-book-once-its-done"><i class="fa fa-check"></i><b>13.3.1</b> Rendering the book once it’s done</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html"><i class="fa fa-check"></i><b>14</b> Creating a simulated data set</a>
<ul>
<li class="chapter" data-level="14.1" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#part-1-independent-samples-from-a-normal-distribution"><i class="fa fa-check"></i><b>14.1</b> Part 1: Independent samples from a normal distribution</a></li>
<li class="chapter" data-level="14.2" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#part-2-creating-data-sets-with-quantitative-and-categorical-variables"><i class="fa fa-check"></i><b>14.2</b> Part 2: Creating data sets with quantitative and categorical variables</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#a.-data-with-no-difference-among-groups"><i class="fa fa-check"></i><b>14.2.1</b> 2.a. DATA WITH <strong>NO DIFFERENCE</strong> AMONG GROUPS</a></li>
<li class="chapter" data-level="14.2.2" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#b.-data-with-a-difference-among-groups"><i class="fa fa-check"></i><b>14.2.2</b> 2.b. Data <strong>WITH A DIFFERENCE</strong> among groups</a></li>
<li class="chapter" data-level="14.2.3" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#c.-data-with-multiple-quantitative-variables-with-groups"><i class="fa fa-check"></i><b>14.2.3</b> 2.c. Data with <strong>MULTIPLE QUANTITATIVE VARIABLES</strong> with groups</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#part-3-repeatedly-simulate-samples-with-replicate"><i class="fa fa-check"></i><b>14.3</b> Part 3: Repeatedly simulate samples with replicate()</a></li>
<li class="chapter" data-level="14.4" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#part-4-repeatedly-making-whole-data-sets"><i class="fa fa-check"></i><b>14.4</b> Part 4: repeatedly making whole data sets</a></li>
<li class="chapter" data-level="14.5" data-path="creating-a-simulated-data-set.html"><a href="creating-a-simulated-data-set.html#part-5-using-purrr"><i class="fa fa-check"></i><b>14.5</b> Part 5: Using purrr</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating a simulated data set</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intermediate-r-functions-loops-and-iterative-programming" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Intermediate R: Functions, Loops, and Iterative Programming</h1>
<div id="functions" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Functions</h2>
<p>A function is a command that performs a specified operation and returns an output in accordance with that operation. You can literally make a function to do anything you want.</p>
<p><em>General structure of a basic function:</em></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example structure</span></span>
<span id="cb195-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb195-3" aria-hidden="true" tabindex="-1"></a>Function_name<span class="ot">=</span><span class="cf">function</span>(argument){</span>
<span id="cb195-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb195-4" aria-hidden="true" tabindex="-1"></a>  Expressions</span>
<span id="cb195-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb195-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb195-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><em>Argument</em> is your input. It is the thing you want to perform the operation on.</li>
<li><em>Expressions</em> is the actual operation (or operations) you want to perform on the supplied argument</li>
<li><em>return</em> tells R to return the result of the Expression to you when done.</li>
</ul>
<p>This example function takes an input of numbers in the form of a vector and subtracts two from each.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-1" aria-hidden="true" tabindex="-1"></a>numbers<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">80</span>)</span>
<span id="cb196-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-3" aria-hidden="true" tabindex="-1"></a>sub_2<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb196-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  result<span class="ot">=</span> x <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb196-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb196-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb196-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sub_2</span>(numbers)</span></code></pre></div>
<pre><code>## [1]  0  8 10 78</code></pre>
<p>We can also supply the function with a single number and it still works…</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sub_2</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<p><strong><em>Well this looks useful. So what’s the bigger picture?</em></strong></p>
<p>One of the primary advantages of functions are that they can reduce a long and complex process, or a process that involves many steps, into a <em>single line of code</em>; thus, creating your own functions is a fast way to make your life easier down the line either at some point in the far future or even in just a few minutes, if you know you will be writing the code for some process two or more times.</p>
<p>Take this script for instance. You can see from the circled parts that I needed to transform three different data sets in a similar way:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb200-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;repeat_process.jpg&quot;</span>))</span></code></pre></div>
<p><img src="pics/repeat_process.jpg" width="413" /></p>
<p>Yes, I could have just done a copy-paste of the original code and tweak it slightly each time…. But that is time consuming, produces a sloppier and longer script, and introduces a lot more room for error because of the repeated code and extra steps.</p>
<p>Better to write a single function that could be applied to all three….</p>
<p><strong><em>In short, use functions to reduce a multi-step process or a process that you’re implementing &gt;=2 times in a single script into one command. This saves you space and makes the script shorter; it saves you the trouble and effort of re-writing or adapting code from earlier sections; and importantly, reduces the chances of you making a coding error by proxy of the former two.</em></strong></p>
<p>As a quick example, I was able to replace each of the circled paragraphs of code above with a custom function that ran everything in one simple line. Now instead of 3 whole (and redundant) paragraphs, I now have 3 short lines, like so….</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb201-1" aria-hidden="true" tabindex="-1"></a>na_zero_helpreint<span class="ot">=</span><span class="fu">rotate_data</span>(<span class="at">data =</span> na_zero_helpreint,</span>
<span id="cb201-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb201-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">variable_prefix =</span> <span class="st">&quot;reintegrate_&quot;</span>)</span>
<span id="cb201-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb201-4" aria-hidden="true" tabindex="-1"></a>na_blank<span class="ot">=</span><span class="fu">rotate_data</span>(<span class="at">data =</span> na_zero_helpreint, <span class="at">variable_prefix =</span> <span class="st">&quot;barrier_&quot;</span>)</span>
<span id="cb201-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb201-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb201-6" aria-hidden="true" tabindex="-1"></a>na_zero<span class="ot">=</span><span class="fu">rotate_data</span>(<span class="at">data =</span> na_zero_helpreint, <span class="at">variable_prefix =</span> <span class="st">&quot;barrier_&quot;</span>)</span></code></pre></div>
<p><strong>Limitations to your average, everyday functions.</strong> While reducing a whole <em>process or sequence</em> of commands is extremely useful, it still leaves a limitation. For instance, while we avoided copying and pasting whole paragraphs or processes, I still had to copy-paste the same function three times. <em>This still leaves chances for error on the table, and it still leaves us with wasted lines that make the script longer.</em></p>
<p>In general, when you want to perform some function or process <strong>multiple times on multiple items (as above where the same command is used three times on three different data frames)</strong>, you need to use a for-loop or iterating function. These can reduce further unwanted redundancies by applying the function or process iteratively. Read on for more info.</p>
</div>
<div id="for-loops" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> For-loops</h2>
<p>A for loop is essentially a function that applies a function or given set of operations to multiple things at once, and returns an output of many items.</p>
<p>For example, this code finds the means of every vector/column in a dataset by repeatedly applying the same code over and over to element “i” in the given list:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb202-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb202-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb202-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb202-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb202-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb202-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-8" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">ncol</span>(df))  <span class="co"># 1.Output. Create the object you want the results of the loop stored in.</span></span>
<span id="cb202-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df)) {            <span class="co"># 2.Sequence of operations. &quot;For each item &#39;i&#39; along data frame…&quot;</span></span>
<span id="cb202-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-11" aria-hidden="true" tabindex="-1"></a>  output[[i]] <span class="ot">&lt;-</span> <span class="fu">median</span>(df[[i]])      <span class="co"># 3.Body:&quot;every individual item in &#39;output&#39; = the median of each col in df</span></span>
<span id="cb202-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb202-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb202-14" aria-hidden="true" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>## [1]  0.3771802 -0.5176346  0.4171879  0.5704655</code></pre>
<p>Check out <a href="https://r4ds.had.co.nz/iteration.html#mapping-over-multiple-arguments">this book chapter</a> for a great and detailed explanation of for-loops and functional coding.</p>
<p>Although for loops are nice, they are unwieldy. R programmers typically use iterating functions instead. Examples of iterating functions are the <code>lapply</code>, <code>vapply</code>, <code>sapply</code>, etc. family of base R commands. But these can also be confusing and the commands are not great.</p>
<p>The purrr package offers a better way to do iterating functions over base R; it’s the tidyverse way to make efficient and understandable for loops! <strong>If you have a need for a for-loop for something, see the next section instead on how to use purrr to make an iterative function. Important to understand conceptually what a for-loop is, but using them is impractical when you have purrr</strong></p>
</div>
<div id="purrr-and-iterative-functions" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> purrr and Iterative Functions</h2>
<p><em>All notes here come from Charlotte Wickham’s lecture tutorial below</em></p>
<ul>
<li>Part 1: <a href="https://www.youtube.com/watch?v=7UlWJWfZO9M" class="uri">https://www.youtube.com/watch?v=7UlWJWfZO9M</a></li>
<li>Part 2: <a href="https://www.youtube.com/watch?v=b0ozKTUho0A&amp;t=1210s" class="uri">https://www.youtube.com/watch?v=b0ozKTUho0A&amp;t=1210s</a></li>
</ul>
<p>purrr’s <code>map()</code> series of functions offer a way to apply any existing function (even functions you’ve made) to multiple things at once, be it lists, data frame columns, individual items in vector, etc. In short, they are for doing the same type of task repeatedly in a very quick and efficient manner. They work in much the same way as for-loops, but are far simpler to write, and can be applied in the same way to solve the same problems.</p>
<p><strong><em>How to use purrr</em></strong></p>
<p>The structure of <code>map()</code> commands is the same as the others in the tidyverse:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co">#option 1</span></span>
<span id="cb204-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(data, <span class="cf">function</span>)</span>
<span id="cb204-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># option 2</span></span>
<span id="cb204-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb204-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="cf">function</span>)</span></code></pre></div>
<p>As a quick example and to highlight why purrr is so much more efficient and easier to use than for-loops, look at the same example from before, now using <code>map()</code> instead of a <code>for</code>:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb205-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(median)</span></code></pre></div>
<pre><code>##          a          b          c          d 
##  0.3771802 -0.5176346  0.4171879  0.5704655</code></pre>
<p>A single line is all it took to get the same results! And, it follows tidyverse grammar structure.</p>
<p>Now lets get into how it works….</p>
<p><em>map() commands work like this:</em> For each element of x, do f.</p>
<p>So if you pass it object <code>x</code> and object <code>x</code> is…. - A vector, it will perform function f on every item in the vector - A data frame, it will perform function f on every <em>column</em> in the data frame - A list, it will perform function f on every <em>level in the list</em></p>
<p>Etc., etc.; the point is it applies a function repeatedly to every element in the object you supply it with.</p>
<p>So lets walk through a case example.</p>
<div id="reproducible-example-scraping-web-data" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Reproducible example: Scraping web data</h3>
<p>This is an example walk through showing how we can use <code>purrr</code> to speed things up dramatically and/or reduce the use of unwanted, extra code in our scripts. In this guide I’ll be building a table of LPGA Tour statistics from multiple webpages.</p>
<p>The workflow for purrr goes like this:</p>
<p>First, you want to figure out how to do each step of your process line-by-line, for a single item. The idea is to try and walk through each step of the process and see exactly what will need to be done each each step and what the code will like, before trying to code it all at once at a higher level.</p>
<p>Once you have each step for the first item figured out, then you make functions for each step that condense that code down to one command.</p>
<p>Lastly, apply each function from your individual steps to all items in your list by using <code>purr::map()</code>.</p>
<p><strong><em>Do for One</em></strong></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb207-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 1</span></span>
<span id="cb207-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure out a line-by-line process for one item/one single web page</span></span>
<span id="cb207-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-5" aria-hidden="true" tabindex="-1"></a>html1<span class="ot">=</span><span class="fu">read_html</span>(<span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=04&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb207-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table.shsTable.shsBorderTable&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb207-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">header=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb207-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb207-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb207-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(html1)</span></code></pre></div>
<pre><code>##   rank                 name distance
## 1    1       Emily Pedersen  281.768
## 2    2 Nanna Koerstz Madsen  276.758
## 3    3  Maude-Aimee Leblanc  275.393
## 4    4            Yuka Saso  274.671
## 5    5   Bianca Pagdanganan  274.640
## 6    6    Madelene Sagstrom  274.488</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># STEP 2</span></span>
<span id="cb209-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a custom function of the above to shorten and generalize the process</span></span>
<span id="cb209-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-3" aria-hidden="true" tabindex="-1"></a>quick_read_html<span class="ot">=</span><span class="cf">function</span>(url){</span>
<span id="cb209-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-4" aria-hidden="true" tabindex="-1"></a>  web_page<span class="ot">=</span><span class="fu">read_html</span>(url) <span class="sc">|&gt;</span> </span>
<span id="cb209-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;table.shsTable.shsBorderTable&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># fortunately this node works for all four pages so it can be baked into the function</span></span>
<span id="cb209-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb209-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb209-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-8" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb209-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(web_page)</span>
<span id="cb209-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-15" aria-hidden="true" tabindex="-1"></a><span class="co"># test to verify it works</span></span>
<span id="cb209-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-16" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span><span class="fu">quick_read_html</span>(<span class="at">url=</span> <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=08&quot;</span>) </span>
<span id="cb209-17"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-18"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb209-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(test) <span class="co"># nice </span></span></code></pre></div>
<pre><code>##   rank              name putt_average
## 1    1     Jeong Eun Lee        1.706
## 2    2          Lydia Ko        1.719
## 3    3     Danielle Kang        1.720
## 4    4        Minjee Lee        1.726
## 5    5 Patty Tavatanakit        1.727
## 6    6          Xiyu Lin        1.738</code></pre>
<p><strong><em>DO FOR ALL.</em></strong> Now create the object that contains all the elements you want to iterate over, and then pass it to your generalized function with map.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3a</span></span>
<span id="cb211-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create an object that contains ALL elements of interest</span></span>
<span id="cb211-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-3" aria-hidden="true" tabindex="-1"></a>URLs<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=04&quot;</span>,</span>
<span id="cb211-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=08&quot;</span>,</span>
<span id="cb211-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=06&quot;</span>,</span>
<span id="cb211-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-6" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;https://scores.nbcsports.com/golf/averages.asp?tour=LPGA&amp;rank=12&quot;</span>)</span>
<span id="cb211-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4</span></span>
<span id="cb211-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use the power of map and be amazed</span></span>
<span id="cb211-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-10" aria-hidden="true" tabindex="-1"></a>lpga_data<span class="ot">=</span> URLs <span class="sc">|&gt;</span> <span class="fu">map</span>(quick_read_html)</span>
<span id="cb211-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lpga_data)</span></code></pre></div>
<pre><code>## [[1]]
##     rank                     name distance
## 1      1           Emily Pedersen  281.768
## 2      2     Nanna Koerstz Madsen  276.758
## 3      3      Maude-Aimee Leblanc  275.393
## 4      4                Yuka Saso  274.671
## 5      5       Bianca Pagdanganan  274.640
## 6      6        Madelene Sagstrom  274.488
## 7      7                A Lim Kim  274.075
## 8      8            Lexi Thompson  273.463
## 9      9 Pauline Roussin-Bouchard  273.333
## 10    10              Maria Fassi  273.295
## 11    11        Patty Tavatanakit  272.773
## 12    12                Angel Yin  272.745
## 13    13          Carlota Ciganda  272.394
## 14    14          Brooke Matthews  272.208
## 15    15                   Yu Liu  271.848
## 16    16         Atthaya Thitikul  271.756
## 17    17             Charley Hull  271.519
## 18    18         Brooke Henderson  271.174
## 19    19               Minjee Lee  270.938
## 20    20             Alana Uriell  270.783
## 21    21            Janie Jackson  270.760
## 22    22            Jessica Korda  270.675
## 23    23           Rachel Rohanna  270.488
## 24    24             Hannah Green  270.406
## 25    25           Amanda Doherty  269.827
## 26    26         Perrine Delacour  269.375
## 27    27              Nelly Korda  269.200
## 28    28          Jennifer Kupcho  269.063
## 29    29              Yealimi Noh  267.986
## 30    30         Stephanie Meadow  267.883
## 31    31             Weiwei Zhang  267.850
## 32    32               Gaby Lopez  266.984
## 33    33              Hyejin Choi  266.592
## 34    34            Sei Young Kim  266.591
## 35    35        Albane Valenzuela  266.561
## 36    36            Frida Kinhult  266.190
## 37    37               Alison Lee  265.782
## 38    38           Gerina Mendoza  265.521
## 39    39               Ally Ewing  265.517
## 40    40            Ryann O&#39;Toole  265.218
## 41    41                 Xiyu Lin  264.962
## 42    42             Georgia Hall  264.855
## 43    43            Jeong Eun Lee  264.732
## 44    44     Pajaree Anannarukarn  264.451
## 45    45    Fatima Fernandez Cano  264.324
## 46    46           Sanna Nuutinen  264.281
## 47    47             Nasa Hataoka  264.193
## 48    48          Lauren Coughlin  264.167
## 49    49           Cydney Clanton  263.977
## 50    50                 Amy Yang  263.953
## 51    51                 Lilia Vu  263.806
## 52    52          Giulia Molinaro  263.266
## 53    53          Sarah Schmelzel  263.122
## 54    54          Sophia Schubert  263.045
## 55    55              Hyo Joo Kim  262.750
## 56    56               Ruixin Liu  262.375
## 57    57           Sung Hyun Park  261.280
## 58    58        Lauren Stephenson  261.117
## 59    59           Haylee Harford  261.071
## 60    60       Brittany Lincicome  260.542
## 61    61               Dewi Weber  260.240
## 62    62               Annie Park  260.177
## 63    63         Ariya Jutanugarn  260.108
## 64    64         Savannah Vilaubi  260.000
## 65    65            Agathe Laisne  259.875
## 66    66   Katherine Perry-Hamski  259.860
## 67    67               Eun-Hee Ji  259.808
## 68    68           Hinako Shibuno  259.710
## 69    69                  Min Lee  259.707
## 70    70                 Mel Reid  259.703
## 71    71       Stephanie Kyriacou  259.529
## 72    72       Jodi Ewart Shadoff  259.524
## 73    73           Katherine Kirk  259.286
## 74    74         Jaye Marie Green  259.183
## 75    75             Peiyun Chien  259.100
## 76    76                Isi Gabsa  259.000
## 77    78             Sophia Popov  258.250
## 78    79          Lauren Hartlage  258.219
## 79    80                Na Rin An  258.164
## 80    81                 Gina Kim  257.654
## 81    82             Austin Ernst  257.472
## 82    83          Matilda Castren  257.319
## 83    84           Allisen Corpuz  257.239
## 84    85              Ruoning Yin  257.188
## 85    86         Esther Henseleit  257.115
## 86    87             Kaitlyn Papp  256.952
## 87    88             Wei-Ling Hsu  256.846
## 88    89                 Lydia Ko  256.564
## 89    90                Amy Olson  256.509
## 90    91           Gemma Dryburgh  256.480
## 91    92          Casey Danielson  256.222
## 92    93               Sarah Kemp  256.179
## 93    94        Pernilla Lindberg  255.969
## 94    95            Brittany Lang  255.912
## 95    96         Linnea Johansson  255.900
## 96    97            Jennifer Song  255.879
## 97    98           Ashleigh Buhai  255.617
## 98    99              Yu-Sang Hou  255.286
## 99   100           Celine Boutier  254.978
## 100  101          Elizabeth Nagel  254.844
## 101  102         Wichanee Meechai  254.736
## 102  103              Megan Khang  254.459
## 103  104          Angela Stanford  254.444
## 104  105                Ana Belac  254.292
## 105  106               Paula Reto  254.221
## 106  107               Jenny Shin  254.032
## 107  108             Jin Young Ko  253.855
## 108  109                Kelly Tan  253.609
## 109  110            Jenny Coleman  253.545
## 110  111          Morgane Metraux  253.476
## 111  112              In Gee Chun  253.413
## 112  113            Leona Maguire  253.064
## 113  114               Su-Hyun Oh  252.946
## 114  115         Sarah Jane Smith  252.682
## 115  116             Cristie Kerr  252.433
## 116  117           Hee Young Park  252.423
## 117  118           Jennifer Chang  252.111
## 118  119               Bronte Law  252.103
## 119  120        Pornanong Phatlum  251.893
## 120  121            Danielle Kang  251.471
## 121  122              Emma Talley  251.314
## 122  123      Jasmine Suwannapura  251.306
## 123  124              So Yeon Ryu  251.229
## 124  125        Brittany Altomare  251.081
## 125  126           Anna Nordqvist  250.721
## 126  127              Marina Alex  250.663
## 127  128               Lauren Kim  250.500
## 128  129          Cheyenne Knight  250.409
## 129  130              Chella Choi  250.286
## 130  131                  Muni He  250.262
## 131  132              Ayaka Furue  249.863
## 132  133               Robynn Ree  249.577
## 133  134             Youngin Chun  249.000
## 134  135               Haeji Kang  248.955
## 135  136               Andrea Lee  248.500
## 136  137        Moriya Jutanugarn  248.027
## 137 138t            Mariajo Uribe  247.438
## 138 138t           Lindsey Weaver  247.438
## 139  140                Mirim Lee  247.111
## 140  141            Allison Emrey  246.479
## 141  142            Christina Kim  246.350
## 142  143            Maddie Szeryk  246.292
## 143  144             Mina Harigae  246.000
## 144  145          Caroline Masson  245.484
## 145  146               Jiwon Jeon  245.188
## 146  147            Dottie Ardina  245.077
## 147  148             In-Kyung Kim  244.556
## 148  149            Lizette Salas  244.291
## 149  150          Caroline Inglis  243.000
## 150  151               Inbee Park  242.552
## 151  152             Na Yeon Choi  242.304
## 152  153             Yae Eun Hong  242.022
## 153  154            Marissa Steen  241.452
## 154  155        Mariah Stackhouse  241.083
## 155  156              Stacy Lewis  240.316
## 156  157             Olivia Cowan  239.375
## 157  158         Charlotte Thomas  239.208
## 158  159               Vivian Hou  238.125
## 159  160              Aditi Ashok  235.375
## 160  161         Dana Finkelstein  233.938
## 
## [[2]]
##     rank                     name putt_average
## 1      1            Jeong Eun Lee        1.706
## 2      2                 Lydia Ko        1.719
## 3      3            Danielle Kang        1.720
## 4      4               Minjee Lee        1.726
## 5      5        Patty Tavatanakit        1.727
## 6      6                 Xiyu Lin        1.738
## 7      7           Celine Boutier        1.739
## 8      8                Yuka Saso        1.741
## 9      9               Su-Hyun Oh        1.742
## 10    10             Nasa Hataoka        1.744
## 11    11                 Amy Yang        1.755
## 12    12        Madelene Sagstrom        1.755
## 13    13            Jessica Korda        1.757
## 14    14     Nanna Koerstz Madsen        1.759
## 15    15            Leona Maguire        1.760
## 16    16          Carlota Ciganda        1.762
## 17    17           Amanda Doherty        1.764
## 18    18              Hyo Joo Kim        1.765
## 19    19           Gemma Dryburgh        1.765
## 20    20         Atthaya Thitikul        1.766
## 21    21             Jin Young Ko        1.767
## 22    22               Inbee Park        1.769
## 23    23             Cristie Kerr        1.772
## 24    24             Yae Eun Hong        1.773
## 25    25         Brooke Henderson        1.774
## 26    26              Chella Choi        1.774
## 27    27             Georgia Hall        1.775
## 28    28           Sung Hyun Park        1.780
## 29    29                Angel Yin        1.781
## 30    30               Haeji Kang        1.782
## 31    31            Lexi Thompson        1.784
## 32    32              Nelly Korda        1.785
## 33    33       Stephanie Kyriacou        1.786
## 34    34         Perrine Delacour        1.787
## 35    35             Charley Hull        1.789
## 36    36             Hannah Green        1.789
## 37    37               Alison Lee        1.790
## 38    38            Ryann O&#39;Toole        1.791
## 39    39              Ruoning Yin        1.791
## 40    40        Brittany Altomare        1.791
## 41    41              Megan Khang        1.791
## 42    42              Hyejin Choi        1.791
## 43    43        Lauren Stephenson        1.791
## 44    44               Jenny Shin        1.791
## 45    45                Isi Gabsa        1.792
## 46    46              Aditi Ashok        1.793
## 47    47           Allisen Corpuz        1.793
## 48    48           Hinako Shibuno        1.797
## 49    49          Sarah Schmelzel        1.797
## 50    50              Ayaka Furue        1.798
## 51    51     Pajaree Anannarukarn        1.798
## 52    52      Jasmine Suwannapura        1.799
## 53    53 Pauline Roussin-Bouchard        1.799
## 54    54           Lindsey Weaver        1.799
## 55    55               Annie Park        1.799
## 56    56               Gaby Lopez        1.800
## 57    57                Na Rin An        1.803
## 58    58            Lizette Salas        1.804
## 59    59             Mina Harigae        1.804
## 60    60            Janie Jackson        1.805
## 61   61t              Stacy Lewis        1.805
## 62   61t         Sarah Jane Smith        1.805
## 63    63              Emma Talley        1.807
## 64    64                 Lilia Vu        1.807
## 65    65              In Gee Chun        1.808
## 66    66               Paula Reto        1.808
## 67   67t            Frida Kinhult        1.809
## 68   67t             Sophia Popov        1.809
## 69    69                A Lim Kim        1.810
## 70    70            Sei Young Kim        1.810
## 71    71       Brittany Lincicome        1.811
## 72    72              Marina Alex        1.811
## 73    73               Eun-Hee Ji        1.812
## 74    74           Katherine Kirk        1.812
## 75    75             Kaitlyn Papp        1.814
## 76    76                  Min Lee        1.815
## 77    77                   Yu Liu        1.815
## 78    78                Kelly Tan        1.816
## 79   79t          Morgane Metraux        1.818
## 80   79t          Giulia Molinaro        1.818
## 81    81        Moriya Jutanugarn        1.818
## 82    82           Jennifer Chang        1.819
## 83    83          Jennifer Kupcho        1.819
## 84    84          Cheyenne Knight        1.821
## 85    85             Alana Uriell        1.821
## 86    86              So Yeon Ryu        1.822
## 87    87         Ariya Jutanugarn        1.822
## 88    88         Linnea Johansson        1.824
## 89    89             In-Kyung Kim        1.824
## 90    90         Stephanie Meadow        1.825
## 91    91      Maude-Aimee Leblanc        1.826
## 92    92           Ashleigh Buhai        1.828
## 93    93          Matilda Castren        1.828
## 94    94          Angela Stanford        1.830
## 95    95        Pernilla Lindberg        1.830
## 96    96         Esther Henseleit        1.830
## 97    97           Sanna Nuutinen        1.830
## 98    98       Jodi Ewart Shadoff        1.832
## 99    99               Ally Ewing        1.832
## 100  101               Andrea Lee        1.833
## 101  102               Bronte Law        1.834
## 102  103        Albane Valenzuela        1.835
## 103  104           Cydney Clanton        1.836
## 104  105                Amy Olson        1.838
## 105  106             Wei-Ling Hsu        1.840
## 106  107               Jiwon Jeon        1.841
## 107  108            Dottie Ardina        1.841
## 108  109                  Muni He        1.841
## 109  110                Ana Belac        1.847
## 110  111           Hee Young Park        1.847
## 111  112         Charlotte Thomas        1.848
## 112  113              Maria Fassi        1.848
## 113  114              Yealimi Noh        1.849
## 114  115            Brittany Lang        1.851
## 115  116           Anna Nordqvist        1.851
## 116  117       Bianca Pagdanganan        1.851
## 117  118            Jennifer Song        1.851
## 118  119          Sophia Schubert        1.851
## 119  120               Dewi Weber        1.851
## 120  121            Agathe Laisne        1.852
## 121  122          Caroline Masson        1.853
## 122  123   Katherine Perry-Hamski        1.853
## 123  124              Yu-Sang Hou        1.857
## 124  125            Allison Emrey        1.858
## 125  126        Mariah Stackhouse        1.859
## 126  127             Youngin Chun        1.860
## 127  128         Dana Finkelstein        1.862
## 128  129         Wichanee Meechai        1.865
## 129  130         Jaye Marie Green        1.865
## 130  131            Jenny Coleman        1.865
## 131  132             Austin Ernst        1.865
## 132  133    Fatima Fernandez Cano        1.866
## 133  134               Sarah Kemp        1.868
## 134  135             Weiwei Zhang        1.868
## 135  136           Emily Pedersen        1.869
## 136  137               Lauren Kim        1.870
## 137  138               Ruixin Liu        1.870
## 138  139           Gerina Mendoza        1.871
## 139  140           Rachel Rohanna        1.872
## 140  141          Elizabeth Nagel        1.874
## 141  142             Peiyun Chien        1.874
## 142  143             Na Yeon Choi        1.875
## 143  144          Lauren Coughlin        1.876
## 144  145            Christina Kim        1.878
## 145  146                 Gina Kim        1.879
## 146  147                Mirim Lee        1.880
## 147  148        Pornanong Phatlum        1.886
## 148  149                 Mel Reid        1.887
## 149  150           Haylee Harford        1.888
## 150  151          Lauren Hartlage        1.888
## 151  152             Olivia Cowan        1.895
## 152  153            Maddie Szeryk        1.905
## 153  154            Mariajo Uribe        1.909
## 154  155         Savannah Vilaubi        1.912
## 155  156            Marissa Steen        1.914
## 156  157               Robynn Ree        1.918
## 157  158          Caroline Inglis        1.928
## 158  159          Brooke Matthews        1.929
## 159  160          Casey Danielson        1.939
## 160  161               Vivian Hou        1.962
## 
## [[3]]
##     rank                     name greens_hit
## 1      1            Lexi Thompson       76.1
## 2      2           Sanna Nuutinen       75.7
## 3      3                 Xiyu Lin       75.6
## 4      4              Hyejin Choi       75.6
## 5      5       Jodi Ewart Shadoff       75.3
## 6      6          Jennifer Kupcho       75.3
## 7      7         Brooke Henderson       75.2
## 8      8               Minjee Lee       74.8
## 9      9              Megan Khang       74.0
## 10    10             Hannah Green       74.0
## 11    11             Jin Young Ko       73.8
## 12    12           Celine Boutier       73.3
## 13    13            Jeong Eun Lee       73.2
## 14    14             Nasa Hataoka       73.1
## 15    15                A Lim Kim       73.1
## 16    16              Hyo Joo Kim       73.0
## 17    17               Ally Ewing       73.0
## 18    18          Matilda Castren       72.8
## 19    19           Emily Pedersen       72.8
## 20    20              Marina Alex       72.8
## 21    21          Lauren Coughlin       72.8
## 22    22     Nanna Koerstz Madsen       72.7
## 23    23          Sarah Schmelzel       72.5
## 24    24              Yealimi Noh       72.4
## 25    25           Hinako Shibuno       72.0
## 26    26     Pajaree Anannarukarn       72.0
## 27    27         Perrine Delacour       71.9
## 28    28             Charley Hull       71.8
## 29    29              Chella Choi       71.7
## 30   30t              In Gee Chun       71.5
## 31   30t                 Amy Yang       71.5
## 32    32         Atthaya Thitikul       71.2
## 33    33          Casey Danielson       71.0
## 34    34          Caroline Inglis       70.9
## 35    35        Lauren Stephenson       70.9
## 36    36            Jessica Korda       70.8
## 37    37            Ryann O&#39;Toole       70.8
## 38    38              Nelly Korda       70.7
## 39    39         Ariya Jutanugarn       70.7
## 40    40        Brittany Altomare       70.4
## 41    41        Patty Tavatanakit       70.4
## 42   42t            Danielle Kang       70.1
## 43   42t           Anna Nordqvist       70.1
## 44    44              Ayaka Furue       70.0
## 45    45          Sophia Schubert       69.7
## 46    46        Madelene Sagstrom       69.6
## 47    47      Maude-Aimee Leblanc       69.6
## 48    48               Gaby Lopez       69.6
## 49    49                  Min Lee       69.5
## 50   50t               Ruixin Liu       69.4
## 51   50t               Inbee Park       69.4
## 52    52            Sei Young Kim       69.2
## 53    53               Jenny Shin       69.1
## 54    54              Stacy Lewis       69.0
## 55    55             Austin Ernst       68.8
## 56    56                 Lilia Vu       68.8
## 57   57t               Andrea Lee       68.8
## 58   57t              So Yeon Ryu       68.8
## 59   57t                Kelly Tan       68.8
## 60    60         Jaye Marie Green       68.7
## 61    61          Carlota Ciganda       68.7
## 62    62        Moriya Jutanugarn       68.6
## 63    63             Peiyun Chien       68.6
## 64    64          Caroline Masson       68.6
## 65   65t                 Lydia Ko       68.4
## 66   65t            Leona Maguire       68.4
## 67    67        Albane Valenzuela       68.4
## 68    68             Kaitlyn Papp       68.3
## 69    69            Janie Jackson       68.2
## 70    70              Ruoning Yin       68.1
## 71    71               Bronte Law       68.0
## 72   72t             Wei-Ling Hsu       67.9
## 73   72t               Robynn Ree       67.9
## 74    74           Cydney Clanton       67.9
## 75    75                Isi Gabsa       67.9
## 76    76                Yuka Saso       67.7
## 77    77           Allisen Corpuz       67.6
## 78    78      Jasmine Suwannapura       67.6
## 79   79t            Jenny Coleman       67.5
## 80   79t                   Yu Liu       67.5
## 81   81t               Sarah Kemp       67.5
## 82   81t              Emma Talley       67.5
## 83    84       Brittany Lincicome       67.4
## 84    85               Dewi Weber       67.3
## 85    86               Paula Reto       67.2
## 86    87                 Gina Kim       67.1
## 87    88           Haylee Harford       67.1
## 88    89            Jennifer Song       67.1
## 89    90               Annie Park       67.0
## 90    91         Charlotte Thomas       66.9
## 91    92               Eun-Hee Ji       66.9
## 92    93          Giulia Molinaro       66.8
## 93   94t         Stephanie Meadow       66.7
## 94   94t   Katherine Perry-Hamski       66.7
## 95    96               Alison Lee       66.5
## 96    97                Na Rin An       66.5
## 97    98         Wichanee Meechai       66.2
## 98    99             Alana Uriell       66.2
## 99   100             Mina Harigae       66.0
## 100 101t             Olivia Cowan       66.0
## 101 101t          Elizabeth Nagel       66.0
## 102  103            Lizette Salas       65.9
## 103  104       Bianca Pagdanganan       65.8
## 104  105          Cheyenne Knight       65.7
## 105 106t           Ashleigh Buhai       65.6
## 106 106t           Sung Hyun Park       65.6
## 107  108         Esther Henseleit       65.4
## 108  109            Frida Kinhult       65.3
## 109 110t        Pernilla Lindberg       65.3
## 110 110t               Su-Hyun Oh       65.3
## 111  112             Georgia Hall       65.2
## 112  113          Lauren Hartlage       64.9
## 113  114              Maria Fassi       64.9
## 114  115           Gerina Mendoza       64.6
## 115  116            Dottie Ardina       64.5
## 116 117t        Pornanong Phatlum       64.3
## 117 117t           Rachel Rohanna       64.3
## 118 117t            Marissa Steen       64.3
## 119  120           Lindsey Weaver       64.1
## 120  121       Stephanie Kyriacou       64.1
## 121  122          Morgane Metraux       64.0
## 122  123            Christina Kim       63.9
## 123  124             Na Yeon Choi       63.8
## 124  125         Dana Finkelstein       63.7
## 125  126               Haeji Kang       63.6
## 126 127t                Amy Olson       63.6
## 127 127t Pauline Roussin-Bouchard       63.6
## 128  129            Agathe Laisne       63.5
## 129  130             Sophia Popov       63.5
## 130  131                Ana Belac       63.4
## 131 132t    Fatima Fernandez Cano       63.4
## 132 132t            Brittany Lang       63.4
## 133 134t           Gemma Dryburgh       63.3
## 134 134t             Weiwei Zhang       63.3
## 135  136                Angel Yin       63.3
## 136  137             In-Kyung Kim       63.3
## 137  138           Amanda Doherty       63.2
## 138  139                 Mel Reid       63.2
## 139  140         Linnea Johansson       63.1
## 140  141           Hee Young Park       63.0
## 141  142           Jennifer Chang       63.0
## 142  143                  Muni He       61.6
## 143 144t               Jiwon Jeon       61.1
## 144 144t            Mariajo Uribe       61.1
## 145  146           Katherine Kirk       60.8
## 146  147             Yae Eun Hong       60.6
## 147  148              Aditi Ashok       60.2
## 148  149               Vivian Hou       60.2
## 149  150             Cristie Kerr       60.0
## 150  151         Sarah Jane Smith       59.6
## 151  152        Mariah Stackhouse       59.3
## 152  153                Mirim Lee       59.0
## 153  154         Savannah Vilaubi       58.9
## 154  155          Brooke Matthews       58.8
## 155  156               Lauren Kim       58.7
## 156  157              Yu-Sang Hou       58.3
## 157  158             Youngin Chun       57.4
## 158  159            Allison Emrey       55.3
## 159  160          Angela Stanford       54.3
## 160  161            Maddie Szeryk       53.7
## 
## [[4]]
##     rank                     name rounds score_average_actual
## 1      1               Minjee Lee     32               68.750
## 2      2             Jin Young Ko     31               69.548
## 3      3            Lexi Thompson     27               69.630
## 4      4              Hyo Joo Kim     22               69.682
## 5      5         Brooke Henderson     35               69.686
## 6      6                 Xiyu Lin     39               69.744
## 7      7              Hyejin Choi     38               69.816
## 8      8     Nanna Koerstz Madsen     33               69.848
## 9      9           Celine Boutier     46               69.870
## 10    10         Atthaya Thitikul     43               69.884
## 11    11                 Lydia Ko     39               69.897
## 12    12             Nasa Hataoka     44               70.114
## 13    13             Hannah Green     32               70.125
## 14    14              Nelly Korda     15               70.133
## 15    15            Danielle Kang     34               70.206
## 16    16                 Amy Yang     32               70.250
## 17    17        Patty Tavatanakit     33               70.303
## 18    18        Madelene Sagstrom     41               70.317
## 19    19               Inbee Park     34               70.441
## 20    20              Chella Choi     35               70.514
## 21    21            Jeong Eun Lee     28               70.536
## 22    22              Megan Khang     37               70.541
## 23    23              In Gee Chun     40               70.575
## 24    24              Marina Alex     40               70.625
## 25    25                Yuka Saso     38               70.684
## 26    26          Sarah Schmelzel     37               70.730
## 27    27     Pajaree Anannarukarn     41               70.756
## 28   28t            Leona Maguire     39               70.795
## 29   28t            Ryann O&#39;Toole     39               70.795
## 30    30          Jennifer Kupcho     40               70.825
## 31    31             Charley Hull     26               70.923
## 32    32           Sanna Nuutinen     16               70.938
## 33    33           Hinako Shibuno     31               70.968
## 34    34                A Lim Kim     40               71.050
## 35    35        Brittany Altomare     37               71.054
## 36    36               Andrea Lee     16               71.063
## 37    37               Alison Lee     39               71.077
## 38    38       Jodi Ewart Shadoff     32               71.156
## 39    39      Jasmine Suwannapura     36               71.167
## 40    40              Stacy Lewis     38               71.184
## 41   41t         Perrine Delacour     32               71.188
## 42   41t               Jenny Shin     32               71.188
## 43    43            Jessica Korda     20               71.200
## 44    44              Ayaka Furue     40               71.225
## 45    45           Gemma Dryburgh     25               71.240
## 46    46           Allisen Corpuz     23               71.261
## 47    47        Albane Valenzuela     33               71.273
## 48    48             Georgia Hall     31               71.290
## 49    49                Kelly Tan     32               71.313
## 50    50               Su-Hyun Oh     28               71.321
## 51    51          Cheyenne Knight     33               71.333
## 52    52               Gaby Lopez     32               71.344
## 53    53             Mina Harigae     34               71.353
## 54    54            Sei Young Kim     22               71.364
## 55    55          Carlota Ciganda     33               71.394
## 56    56              Emma Talley     35               71.400
## 57    57              So Yeon Ryu     24               71.458
## 58    58            Lizette Salas     28               71.464
## 59    59        Lauren Stephenson     30               71.467
## 60    60               Paula Reto     34               71.471
## 61    61                  Min Lee     29               71.483
## 62    62                 Lilia Vu     31               71.484
## 63    63               Eun-Hee Ji     26               71.577
## 64    65           Lindsey Weaver     32               71.625
## 65    66           Anna Nordqvist     34               71.647
## 66    67        Moriya Jutanugarn     37               71.649
## 67    68               Bronte Law     29               71.655
## 68    69             Kaitlyn Papp     21               71.667
## 69    70              Aditi Ashok     32               71.688
## 70    71            Frida Kinhult     29               71.724
## 71    72         Ariya Jutanugarn     37               71.730
## 72    73             Wei-Ling Hsu     26               71.731
## 73    74             Alana Uriell     23               71.739
## 74    75               Ruixin Liu     24               71.750
## 75    76         Stephanie Meadow     30               71.767
## 76    77               Annie Park     31               71.774
## 77    78               Ally Ewing     30               71.800
## 78    79                Isi Gabsa     28               71.821
## 79   80t           Jennifer Chang     18               71.833
## 80   80t       Brittany Lincicome     24               71.833
## 81    82                   Yu Liu     33               71.848
## 82    83                Na Rin An     31               71.871
## 83    84          Matilda Castren     36               71.889
## 84    85              Yealimi Noh     37               71.892
## 85    86         Charlotte Thomas     24               71.958
## 86    87              Ruoning Yin     16               72.000
## 87    88           Emily Pedersen     28               72.036
## 88    89          Caroline Masson     32               72.063
## 89    90               Robynn Ree     13               72.077
## 90    91           Ashleigh Buhai     30               72.100
## 91   92t      Maude-Aimee Leblanc     28               72.107
## 92   92t                Angel Yin     28               72.107
## 93    94             Yae Eun Hong     23               72.130
## 94    95          Lauren Coughlin     21               72.143
## 95    96            Dottie Ardina     13               72.154
## 96    97          Giulia Molinaro     32               72.156
## 97    98 Pauline Roussin-Bouchard     27               72.222
## 98    99          Sophia Schubert     22               72.227
## 99   100            Jennifer Song     29               72.345
## 100  101           Amanda Doherty     26               72.385
## 101  102         Wichanee Meechai     36               72.389
## 102  103               Sarah Kemp     28               72.393
## 103  104        Pernilla Lindberg     32               72.406
## 104  105                Ana Belac     24               72.417
## 105  106               Dewi Weber     25               72.440
## 106 107t             Austin Ernst     18               72.444
## 107 107t             In-Kyung Kim     18               72.444
## 108  109         Dana Finkelstein     24               72.458
## 109  110       Stephanie Kyriacou     17               72.471
## 110 111t          Caroline Inglis     13               72.538
## 111 111t                 Gina Kim     13               72.538
## 112  113           Sung Hyun Park     25               72.560
## 113  114            Brittany Lang     17               72.588
## 114 115t           Cydney Clanton     22               72.591
## 115 115t              Maria Fassi     22               72.591
## 116 115t               Haeji Kang     22               72.591
## 117  118         Jaye Marie Green     30               72.600
## 118  119             Peiyun Chien     20               72.650
## 119 120t            Janie Jackson     25               72.680
## 120 120t   Katherine Perry-Hamski     25               72.680
## 121  122         Esther Henseleit     26               72.692
## 122  123             Sophia Popov     28               72.714
## 123  124         Sarah Jane Smith     11               72.727
## 124  125                Amy Olson     27               72.778
## 125  126        Pornanong Phatlum     28               72.786
## 126  127                  Muni He     21               72.810
## 127  128           Katherine Kirk     18               72.833
## 128  129       Bianca Pagdanganan     25               72.840
## 129  130            Jenny Coleman     33               72.848
## 130  131             Cristie Kerr     15               72.933
## 131  132           Rachel Rohanna     21               73.048
## 132  133            Agathe Laisne     16               73.063
## 133  134           Gerina Mendoza     24               73.125
## 134  135          Morgane Metraux     21               73.143
## 135  136            Christina Kim     20               73.150
## 136  137                 Mel Reid     32               73.188
## 137  138         Linnea Johansson     25               73.200
## 138  139          Casey Danielson     18               73.278
## 139  140        Mariah Stackhouse      6               73.333
## 140  141           Hee Young Park     26               73.346
## 141  142           Haylee Harford     14               73.357
## 142  143            Marissa Steen     21               73.429
## 143  144               Jiwon Jeon     16               73.563
## 144  145          Brooke Matthews     12               73.667
## 145  146          Angela Stanford     18               73.833
## 146  147          Elizabeth Nagel     16               73.938
## 147  148    Fatima Fernandez Cano     17               73.941
## 148  149             Olivia Cowan      8               74.125
## 149  150              Yu-Sang Hou     14               74.214
## 150 151t          Lauren Hartlage     16               74.250
## 151 151t               Lauren Kim     16               74.250
## 152 151t            Mariajo Uribe      8               74.250
## 153  154             Na Yeon Choi     23               74.261
## 154  155         Savannah Vilaubi     15               74.400
## 155  156             Weiwei Zhang     10               74.500
## 156  157             Youngin Chun      9               74.556
## 157  158            Allison Emrey     24               74.583
## 158  159            Maddie Szeryk     12               74.917
## 159  160                Mirim Lee     18               75.278
## 160  161               Vivian Hou     12               76.000</code></pre>
<p>All done!! And just like that, we’ve downloaded four different web pages, extracted the tabled info, and formatted them without copying and pasting any code. The same process for all four was only used one time to write the initial function. Just apply some final formatting to clean it up a bit and combine the separate data frames into a single, unified one.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-1" aria-hidden="true" tabindex="-1"></a>lpga_data<span class="ot">=</span> lpga_data <span class="sc">%&gt;%</span> </span>
<span id="cb213-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(left_join, <span class="at">by=</span><span class="st">&quot;name&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># Combine all list levels into a single tibble, matching by the &quot;Name&quot; column</span></span>
<span id="cb213-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;rank.&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb213-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;score_average&quot;</span><span class="ot">=</span><span class="st">&quot;score_average_actual&quot;</span>)</span>
<span id="cb213-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="co"># VOILA! </span></span>
<span id="cb213-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lpga_data)</span></code></pre></div>
<pre><code>##                   name distance putt_average greens_hit rounds score_average
## 1       Emily Pedersen  281.768        1.869       72.8     28        72.036
## 2 Nanna Koerstz Madsen  276.758        1.759       72.7     33        69.848
## 3  Maude-Aimee Leblanc  275.393        1.826       69.6     28        72.107
## 4            Yuka Saso  274.671        1.741       67.7     38        70.684
## 5   Bianca Pagdanganan  274.640        1.851       65.8     25        72.840
## 6    Madelene Sagstrom  274.488        1.755       69.6     41        70.317</code></pre>
</div>
<div id="non-reproducible-example-juvenile-life-without-parole-study" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Non-reproducible example (Juvenile Life Without Parole study)</h3>
<p>In the Juvenile Lifers study, there were a series of questions that participants rated on a scale of 0-100 in terms of difficulty. Part of our analysis involved taking the ratings on those variables and giving them relative rankings, so that each of the 6 variables in the series was rated from the least to most difficult, by participant.</p>
<p>Now if we only needed to compute these rankings once this wouldn’t have been any big deal; however, we needed to do it <strong>three times</strong>.</p>
<p>Much of the same code and the same process would need to be copied and pasted, resulting in a very long, messy, harder to read script. With purrr however, we can reduce the redundancies to a minimum, saving time and reducing the chances of mistakes.</p>
<p><strong><em>Step 1.</em></strong> Just like before, the first step is to find a line-by-line solution for a single item, and then to generalize this into a shortcut function that can be applied to the any item “i” in a series of items.</p>
<p>For the sake of brevity, I’m going to skip most of that and just include the functions below.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;C:/Github Repos/Studies/JLWOP/Data and Models/jlwop_reentry_survey.RData&quot;</span>)</span>
<span id="cb215-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### CREATE THE DATA SETS WE NEED####</span></span>
<span id="cb215-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-4" aria-hidden="true" tabindex="-1"></a>na_blank<span class="ot">=</span>jlwop_reentry_survey <span class="co"># analysis 1 keeps the data as-is</span></span>
<span id="cb215-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-6" aria-hidden="true" tabindex="-1"></a>na_zero<span class="ot">=</span>jlwop_reentry_survey <span class="sc">%&gt;%</span> <span class="co"># supplementary analysis replaces the NA&#39;s with 0</span></span>
<span id="cb215-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(barrier_housing<span class="sc">:</span>barrier_identification), replace_na,<span class="dv">0</span>))</span>
<span id="cb215-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(jlwop_reentry_survey) <span class="co"># remove old data set to avoid confusion</span></span>
<span id="cb215-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="do">#### Functions ####</span></span>
<span id="cb215-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-14" aria-hidden="true" tabindex="-1"></a><span class="co"># transformation function to wrangle the data into proper formatting</span></span>
<span id="cb215-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-15" aria-hidden="true" tabindex="-1"></a>rotate_data<span class="ot">=</span><span class="cf">function</span>(data, variable_prefix){</span>
<span id="cb215-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb215-17"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-17" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb215-18"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb215-19"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols=</span> <span class="fu">starts_with</span>(variable_prefix), <span class="co"># collect all the desired variables (i.e., columns)....</span></span>
<span id="cb215-20"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="co">#...and put them into a new categorical variable called &quot;variable&quot;</span></span>
<span id="cb215-21"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;participant_score&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># ...and store their values in a new variable called &quot;participant_score&quot;</span></span>
<span id="cb215-22"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(unique,participant_score) <span class="sc">%&gt;%</span> </span>
<span id="cb215-23"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb215-24"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(unique, participant_score, variable)) <span class="sc">%&gt;%</span> <span class="co"># keep only these 3 variables</span></span>
<span id="cb215-25"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(variable, <span class="at">.before =</span> participant_score) <span class="co"># put the newly created variable up front</span></span>
<span id="cb215-26"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-27"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-27" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(data)</span>
<span id="cb215-28"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb215-29"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-30"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-31"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-31" aria-hidden="true" tabindex="-1"></a><span class="co"># creating the rankings for each variable; then transform data back to original structure</span></span>
<span id="cb215-32"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-32" aria-hidden="true" tabindex="-1"></a>rank_and_unpivot<span class="ot">=</span><span class="cf">function</span>(data){</span>
<span id="cb215-33"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-33" aria-hidden="true" tabindex="-1"></a>  data<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb215-34"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(unique) <span class="sc">%&gt;%</span> <span class="co"># group the scores so they can be ranked by participant</span></span>
<span id="cb215-35"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank1=</span><span class="fu">dense_rank</span>(participant_score), <span class="co"># create ranking variable</span></span>
<span id="cb215-36"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">rank=</span><span class="fu">max</span>(rank1,<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> rank1) <span class="sc">%&gt;%</span> <span class="co"># fix ranks by flipping to ascending order</span></span>
<span id="cb215-37"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank=</span><span class="fu">factor</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># convert rank to factor structure</span></span>
<span id="cb215-38"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>rank1)</span>
<span id="cb215-39"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-40"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-41"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot back to wide</span></span>
<span id="cb215-42"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-42" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb215-43"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> rank<span class="sc">:</span>participant_score) <span class="sc">%&gt;%</span> </span>
<span id="cb215-44"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="co"># un-group the data and delete the generated names</span></span>
<span id="cb215-45"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-46"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-46" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(data)</span>
<span id="cb215-47"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb215-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong><em>Step 2.</em></strong> Again, like before, we want to combine all elements of interest into some object. Once we have that, we then pass said object to <code>map()</code> and supply the map call with our custom function.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-1" aria-hidden="true" tabindex="-1"></a>dfs<span class="ot">=</span><span class="fu">list</span>(<span class="at">na_blank=</span>na_blank, <span class="at">na_zero=</span>na_zero) <span class="sc">%&gt;%</span> <span class="co"># create lists</span></span>
<span id="cb216-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="at">.f=</span>rotate_data, <span class="at">variable_prefix =</span> <span class="st">&quot;barrier&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># apply custom function along whole list</span></span>
<span id="cb216-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(rank_and_unpivot) <span class="co"># again!!  DO IT AGAIN! With another function this time.</span></span>
<span id="cb216-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract list elements to make them data frames again</span></span>
<span id="cb216-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="fu">list2env</span>(dfs, <span class="fu">globalenv</span>())</span>
<span id="cb216-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dfs) <span class="co">#discard list. It has fulfilled its purpose.</span></span></code></pre></div>
<p>And just like that, we’re done!</p>
</div>
<div id="example-3-readimport-several-files-at-once-with-map" class="section level3" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> Example 3: Read/Import several files at once with <code>map()</code></h3>
<p>Multiple ways you can do this….</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="do">################### Option 1: read all into the global environment, keeping them as SEPERATE df&#39;s ###############</span></span>
<span id="cb217-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-2" aria-hidden="true" tabindex="-1"></a>legaldmlab<span class="sc">::</span><span class="fu">read_all</span>(<span class="at">path=</span><span class="st">&quot;Data Repository/Stats Data Repository/JASP files&quot;</span>, <span class="at">extension =</span> <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb217-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1.A: Squish ALL OBJECTS in the working environment into a list</span></span>
<span id="cb217-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Again, note the &quot;ALL OBJECTS&quot; part; make sure there are no functions or other things in the environment when you run this.</span></span>
<span id="cb217-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-6" aria-hidden="true" tabindex="-1"></a>files<span class="ot">=</span><span class="fu">mget</span>(<span class="fu">ls</span>())</span>
<span id="cb217-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="do">############# Option 2: Read in all files as a LIST of df&#39;s, then stitch in the names #####################################</span></span>
<span id="cb217-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-11" aria-hidden="true" tabindex="-1"></a>files<span class="ot">=</span><span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data Repository&quot;</span>, <span class="st">&quot;Stats Data Repository&quot;</span>, <span class="st">&quot;JASP files&quot;</span>, <span class="st">&quot;/&quot;</span>), </span>
<span id="cb217-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">list.files</span>(<span class="at">path=</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data Repository&quot;</span>, <span class="st">&quot;Stats Data Repository&quot;</span>, <span class="st">&quot;JASP files&quot;</span>), <span class="at">pattern =</span> <span class="st">&quot;.csv&quot;</span>))</span>
<span id="cb217-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-14" aria-hidden="true" tabindex="-1"></a>files_list<span class="ot">=</span>files <span class="sc">|&gt;</span> </span>
<span id="cb217-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(readr<span class="sc">::</span>read_csv)</span>
<span id="cb217-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-17"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(files_list)<span class="ot">=</span><span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Data Repository&quot;</span>, <span class="st">&quot;Stats Data Repository&quot;</span>, <span class="st">&quot;JASP files&quot;</span>)) <span class="sc">|&gt;</span> <span class="co">#specify file path as a string</span></span>
<span id="cb217-18"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;.csv&quot;</span>) <span class="sc">|&gt;</span> <span class="co"># pass the path string to list files; search in this location for files with this extension</span></span>
<span id="cb217-19"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="at">pattern=</span><span class="st">&quot;.csv&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>) <span class="co"># remove this pattern to save only the name</span></span>
<span id="cb217-20"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-21"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-22"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2.A: Extract each data frame and put everything into the global environment</span></span>
<span id="cb217-23"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb217-23" aria-hidden="true" tabindex="-1"></a><span class="fu">list2env</span>(cog_data, <span class="fu">globalenv</span>())</span></code></pre></div>
</div>
</div>
<div id="other-purrr-commands" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Other purrr commands</h2>
<p>Note that <code>map()</code> always returns a list, and depending on the output that you want, you may need to use a variation of <code>map()</code>. These variations are as follows:</p>
<table>
<thead>
<tr class="header">
<th>Command</th>
<th>Return</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map_lgl()</code></td>
<td>logical vector</td>
</tr>
<tr class="even">
<td><code>map_int()</code></td>
<td>integer vector</td>
</tr>
<tr class="odd">
<td><code>map_dbl()</code></td>
<td>double vector</td>
</tr>
<tr class="even">
<td><code>map_chr()</code></td>
<td>character vector</td>
</tr>
<tr class="odd">
<td><code>walk()</code></td>
<td>only returns the side effects of a function</td>
</tr>
</tbody>
</table>
<div id="walk-and-walk2" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> <code>walk</code> and <code>walk2</code></h3>
<p>Walk() is useful for when you just want to plot something or write a save file to your disk, etc. It does not give you any return to store something in the environment. You use it to write/read files, open graphics windows, and so on.</p>
<p><strong><em>Example: Writing multiple files at once</em></strong></p>
<p>Utilize <code>purrr::walk2()</code> to apply a function iteratively on TWO objects simultaneously. To save multiple .csv files with <code>walk2</code>, we need two distinct lists: 1. A list of data frames that we wish to export, 2. and the file paths, complete with the file names and extensions, for each file to be written.</p>
<p>First create and define both list items. Then apply <code>walk2()</code> to pluck an element from list 1 and its corresponding element from list 2, and apply the <code>write_csv</code> function in for-loop fashion.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEMO 1: Writing multiple plots at once</span></span>
<span id="cb218-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list one, the list of objects</span></span>
<span id="cb218-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-4" aria-hidden="true" tabindex="-1"></a>figs <span class="ot">=</span> <span class="fu">list</span>(<span class="at">scatter_plot=</span>scatter_plot, </span>
<span id="cb218-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">multi_plot=</span>multi_plot)</span>
<span id="cb218-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create list 2, the list of file names</span></span>
<span id="cb218-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-8" aria-hidden="true" tabindex="-1"></a>fig_names <span class="ot">=</span> figs <span class="sc">|&gt;</span></span>
<span id="cb218-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb218-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(paste0, <span class="st">&quot;.png&quot;</span>)</span>
<span id="cb218-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co"># pass both to purrr to use ggsave iteratively over both lists once and save all graphs with one command</span></span>
<span id="cb218-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="fu">walk2</span>(figs, fig_names, <span class="sc">~</span><span class="fu">ggsave</span>(<span class="at">plot =</span> figs,</span>
<span id="cb218-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">filename =</span> fig_names </span>
<span id="cb218-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">path=</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;Figures and Tables&quot;</span>),</span>
<span id="cb218-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb218-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">device =</span> <span class="st">&quot;png&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>))</span></code></pre></div>
<p>A second demo, this time using <code>write.csv</code> to save/export multiple CSV files at once</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEMO 2: Wrinting multiple .csv files at once</span></span>
<span id="cb219-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Custom function ####</span></span>
<span id="cb219-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create needed function that grabs file names and stitches them together with the correct path and extension</span></span>
<span id="cb219-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Included in legaldmlab package</span></span>
<span id="cb219-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-6" aria-hidden="true" tabindex="-1"></a>bundle_paths<span class="ot">=</span><span class="cf">function</span>(df_list, output_location, file_type){</span>
<span id="cb219-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-7" aria-hidden="true" tabindex="-1"></a>  names<span class="ot">=</span><span class="fu">names</span>(df_list)</span>
<span id="cb219-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-8" aria-hidden="true" tabindex="-1"></a>  paths<span class="ot">=</span><span class="fu">rep</span>(here<span class="sc">::</span><span class="fu">here</span>(output_location), <span class="fu">length</span>(names))</span>
<span id="cb219-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-9" aria-hidden="true" tabindex="-1"></a>  extension<span class="ot">=</span><span class="fu">rep</span>(<span class="fu">c</span>(file_type), <span class="fu">length</span>(names))</span>
<span id="cb219-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-11" aria-hidden="true" tabindex="-1"></a>  fixed_names<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;/&quot;</span>,names)</span>
<span id="cb219-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-13" aria-hidden="true" tabindex="-1"></a>  path_bundle<span class="ot">=</span><span class="fu">list</span>(paths,fixed_names, extension) <span class="sc">%&gt;%</span> </span>
<span id="cb219-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pmap</span>(., paste0)</span>
<span id="cb219-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb219-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(path_bundle)</span>
<span id="cb219-17"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb219-18"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-19"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-19" aria-hidden="true" tabindex="-1"></a><span class="do">#### Exporting the .csv files for SPSS/JASP/etc. ####</span></span>
<span id="cb219-20"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define list 1</span></span>
<span id="cb219-21"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-21" aria-hidden="true" tabindex="-1"></a>dfs<span class="ot">=</span><span class="fu">list</span>(<span class="at">na_blank=</span>na_blank,</span>
<span id="cb219-22"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">na_zero=</span>na_zero,</span>
<span id="cb219-23"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">na_zero_helpreint=</span>na_zero_helpreint)</span>
<span id="cb219-24"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-25"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-25" aria-hidden="true" tabindex="-1"></a><span class="co"># list 2</span></span>
<span id="cb219-26"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-26" aria-hidden="true" tabindex="-1"></a>paths_csv<span class="ot">=</span><span class="fu">bundle_paths</span>(<span class="at">df_list =</span> dfs, <span class="at">folder_location =</span> <span class="st">&quot;JLWOP/Data and Models&quot;</span>, <span class="at">file_type =</span> <span class="st">&quot;.sav&quot;</span>)</span>
<span id="cb219-27"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-28"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-29"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over all elements in list 1 and corresponding element in list 2;</span></span>
<span id="cb219-30"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-30" aria-hidden="true" tabindex="-1"></a><span class="co"># and apply the the write_csv function to each</span></span>
<span id="cb219-31"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-31" aria-hidden="true" tabindex="-1"></a><span class="fu">walk2</span>(<span class="at">.x=</span>dfs, <span class="at">.y=</span> paths, <span class="at">.f=</span>haven<span class="sc">::</span>write_sav)</span>
<span id="cb219-32"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-33"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-34"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-34" aria-hidden="true" tabindex="-1"></a><span class="do">#### .RData file for R users ####</span></span>
<span id="cb219-35"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine multiple data frames into a single .RData file and export</span></span>
<span id="cb219-36"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-36" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;na_blank&quot;</span>, <span class="st">&quot;na_zero&quot;</span>, <span class="st">&quot;na_zero_helpreint&quot;</span>), </span>
<span id="cb219-37"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb219-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;JLWOP&quot;</span>, <span class="st">&quot;Data and Models&quot;</span>,<span class="st">&quot;ranking_data.RData&quot;</span>))</span></code></pre></div>
</div>
<div id="map2" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> <code>map2</code></h3>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb220-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;map2_a.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/map2_a.png" width="594" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb221-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;map2_b.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/map2_b.png" width="816" /></p>
</div>
<div id="pmap-for-when-you-have-a-bunch-of-shit" class="section level3" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> <code>pmap</code> for when you have a bunch of shit</h3>
<p>This function is for iterating over <em>three or more</em> elements. As soon as you have &gt;2 items you have to iterate over, you need <code>pmap()</code>, which acts on <strong>a list object called <code>.i</code></strong> instead of a list object.</p>
<p>The list <code>.i</code> is a list of all the objects you want to iterate over. If you give it a list of 18 items, it iterates over all 18. If the list only has two things, it only acts on those two.</p>
<p>She says its easiest to imagine the list as a data frame, and the columns of the data frame like the elements of that list.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb222-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;pmap.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/pmap.png" width="466" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb223-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;pics&quot;</span>, <span class="st">&quot;pmap_2.png&quot;</span>))</span></code></pre></div>
<p><img src="pics/pmap_2.png" width="600" /></p>
</div>
</div>
<div id="using-purrr-to-manage-many-models" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Using purrr to manage many models</h2>
<p>Below is the full script I copied from Hadley Wickham’s lecture, which you can watch <a href="https://www.youtube.com/watch?v=rz3_FDVt9eg">here</a></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr,purrr,tidyverse,gapminder)</span>
<span id="cb224-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### Workflow for managing many models in R ####</span></span>
<span id="cb224-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Nest data with {tidyr}</span></span>
<span id="cb224-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use {purrr} to map a modeling function</span></span>
<span id="cb224-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Use {broom} to inspect your tidy data</span></span>
<span id="cb224-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-9" aria-hidden="true" tabindex="-1"></a>gapminder<span class="ot">=</span>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb224-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year1950=</span> year<span class="dv">-1950</span>) <span class="co">#the number of years it&#39;s been since 1950</span></span>
<span id="cb224-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------------------</span></span>
<span id="cb224-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 1. Nest the data. ####</span></span>
<span id="cb224-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A nested data frame has one column per country. You&#39;re essentially </span></span>
<span id="cb224-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-16" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a Russian doll; a data frame inside of a larger data frame.</span></span>
<span id="cb224-17"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-18"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-18" aria-hidden="true" tabindex="-1"></a>by_country<span class="ot">=</span>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb224-19"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent,country) <span class="sc">%&gt;%</span> <span class="co"># variables to keep at the top level</span></span>
<span id="cb224-20"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="co"># smush everything else into a df, and store this mini-df in its own column</span></span>
<span id="cb224-21"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-22"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-22" aria-hidden="true" tabindex="-1"></a><span class="co"># with this, you can have an entire table per row; a whole data frame for each country</span></span>
<span id="cb224-23"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Essentially condensing a list into a table</span></span>
<span id="cb224-24"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-24" aria-hidden="true" tabindex="-1"></a>by_country<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb224-25"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-26"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-27"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-27" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------------------</span></span>
<span id="cb224-28"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-29"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-29" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 2. Use purrr to map stuff. ####</span></span>
<span id="cb224-30"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-31"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 12:50</span></span>
<span id="cb224-32"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-32" aria-hidden="true" tabindex="-1"></a>country_model<span class="ot">=</span><span class="cf">function</span>(df){</span>
<span id="cb224-33"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year1950, <span class="at">data =</span> df)</span>
<span id="cb224-34"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-35"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-36"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-36" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span> by_country <span class="sc">%&gt;%</span> </span>
<span id="cb224-37"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-38"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod=</span><span class="fu">map</span>(data,country_model)</span>
<span id="cb224-39"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb224-40"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-41"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-42"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-42" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb224-43"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent,country) <span class="sc">%&gt;%</span> </span>
<span id="cb224-44"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb224-45"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-46"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod=</span> data <span class="sc">%&gt;%</span> <span class="fu">map</span>(country_model)</span>
<span id="cb224-47"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb224-48"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-49"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 27:11</span></span>
<span id="cb224-50"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-51"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-51" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------------------</span></span>
<span id="cb224-52"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-52" aria-hidden="true" tabindex="-1"></a><span class="do">##### Step 3. ####</span></span>
<span id="cb224-53"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-54"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-54" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates another nested df inside of your main data frame that has the summary stats of each model</span></span>
<span id="cb224-55"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-55" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span>models <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb224-56"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy=</span><span class="fu">map</span>(mod, broom<span class="sc">::</span>tidy), <span class="co"># tidy() gives model estimates</span></span>
<span id="cb224-57"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">glance=</span><span class="fu">map</span>(mod,broom<span class="sc">::</span>glance), <span class="co"># glance() gives model summaries</span></span>
<span id="cb224-58"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">augment=</span><span class="fu">map</span>(mod,broom<span class="sc">::</span>augment) <span class="co"># model coefficients</span></span>
<span id="cb224-59"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-59" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-60"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-61"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-61" aria-hidden="true" tabindex="-1"></a><span class="co"># What can you do with this nest of data frames? </span></span>
<span id="cb224-62"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-62" aria-hidden="true" tabindex="-1"></a><span class="co"># The reverse of step 1; un-nest it to unpack everything!</span></span>
<span id="cb224-63"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 34:40</span></span>
<span id="cb224-64"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Keeps a massive list of related information neatly organized!</span></span>
<span id="cb224-65"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-66"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-66" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,data) <span class="co"># back to where we started</span></span>
<span id="cb224-67"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-67" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,glance, <span class="at">.drop =</span> <span class="cn">TRUE</span>) </span>
<span id="cb224-68"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb224-68" aria-hidden="true" tabindex="-1"></a><span class="fu">unnest</span>(models,tidy) </span></code></pre></div>
<p>…and here is a version I made of the above to manage many Latent Growth Curve models.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONDENSED MASTER TABLE VERSION -----------------------------------------------------------------------------</span></span>
<span id="cb225-2"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Models table that has all models condensed</span></span>
<span id="cb225-3"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-4" aria-hidden="true" tabindex="-1"></a>models_noCovs<span class="ot">=</span><span class="fu">tibble</span>(</span>
<span id="cb225-5"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-6"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Define model names ####</span></span>
<span id="cb225-7"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_name=</span><span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Latent_Basis&quot;</span>),</span>
<span id="cb225-8"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-9"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">##### List model specifications for lavaan ####</span></span>
<span id="cb225-10"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_spec=</span><span class="fu">list</span>(</span>
<span id="cb225-11"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-12"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">linear_model=</span> <span class="st">&#39;</span></span>
<span id="cb225-13"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-13" aria-hidden="true" tabindex="-1"></a><span class="st">  # intercept and slope with fixed coefficients</span></span>
<span id="cb225-14"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-14" aria-hidden="true" tabindex="-1"></a><span class="st">  i =~ 1*panss_total_400 + 1*panss_total_1000 + 1*panss_total_1600 + 1*panss_total_2200 + 1*panss_total_2800 +  1*panss_total_3400 + 1*panss_total_5200</span></span>
<span id="cb225-15"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="st">  s =~ 0*panss_total_400 + 3*panss_total_1000 + 6*panss_total_1600 + 9*panss_total_2200 + 12*panss_total_2800 + 15*panss_total_3400 + 24*panss_total_5200</span></span>
<span id="cb225-16"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-16" aria-hidden="true" tabindex="-1"></a><span class="st">  &#39;</span>,</span>
<span id="cb225-17"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-18"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">quadratic_model=</span> <span class="st">&#39;</span></span>
<span id="cb225-19"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-19" aria-hidden="true" tabindex="-1"></a><span class="st">  # intercept and slope with fixed coefficients</span></span>
<span id="cb225-20"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-20" aria-hidden="true" tabindex="-1"></a><span class="st">  i =~ 1*panss_total_400 + 1*panss_total_1000 + 1*panss_total_1600 + 1*panss_total_2200 + 1*panss_total_2800 +  1*panss_total_3400</span></span>
<span id="cb225-21"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-21" aria-hidden="true" tabindex="-1"></a><span class="st">  s =~ 0*panss_total_400 + 3*panss_total_1000 + 6*panss_total_1600 + 9*panss_total_2200 + 12*panss_total_2800 + 15*panss_total_3400 + 24*panss_total_5200</span></span>
<span id="cb225-22"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-22" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb225-23"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-23" aria-hidden="true" tabindex="-1"></a><span class="st">  qs =~ 0*panss_total_400 + 9*panss_total_1000 + 36*panss_total_1600 + 81*panss_total_2200 + 144*panss_total_2800 + 225*panss_total_3400 + 576*panss_total_5200</span></span>
<span id="cb225-24"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-24" aria-hidden="true" tabindex="-1"></a><span class="st">  &#39;</span>,</span>
<span id="cb225-25"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-26"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">latentBasis_model=</span> <span class="st">&#39;</span></span>
<span id="cb225-27"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-27" aria-hidden="true" tabindex="-1"></a><span class="st">  # intercept and slope with fixed coefficients</span></span>
<span id="cb225-28"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-28" aria-hidden="true" tabindex="-1"></a><span class="st">  i =~ 1*panss_total_400 + 1*panss_total_1000 + 1*panss_total_1600 + 1*panss_total_2200 + 1*panss_total_2800 +  1*panss_total_3400 + 1*panss_total_5200</span></span>
<span id="cb225-29"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-29" aria-hidden="true" tabindex="-1"></a><span class="st">  s =~ 0*panss_total_400 + NA*panss_total_1000 + NA*panss_total_1600 + NA*panss_total_2200 + NA*panss_total_2800 + NA*panss_total_3400 + 1*panss_total_5200</span></span>
<span id="cb225-30"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-30" aria-hidden="true" tabindex="-1"></a><span class="st">  &#39;</span></span>
<span id="cb225-31"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-31" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb225-32"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-33"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-33" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Fit all models at once with purrr ####</span></span>
<span id="cb225-34"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">fitted_model=</span>model_spec <span class="sc">|&gt;</span> <span class="fu">map</span>(lavaan<span class="sc">::</span>growth, <span class="at">data=</span>panss_sem_data, <span class="at">missing=</span><span class="st">&quot;FIML&quot;</span>),</span>
<span id="cb225-35"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-36"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb225-37"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-38"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-39"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-40"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-40" aria-hidden="true" tabindex="-1"></a><span class="do">#### Add parameter estimates and fit stats ####</span></span>
<span id="cb225-41"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-41" aria-hidden="true" tabindex="-1"></a>models_noCovs<span class="ot">=</span>models_noCovs <span class="sc">|&gt;</span> </span>
<span id="cb225-42"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tidy_parameters=</span><span class="fu">map</span>(fitted_model, tidy, <span class="at">conf.int=</span>.<span class="dv">95</span>), <span class="co">#parameter estimates</span></span>
<span id="cb225-43"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">global_fit=</span><span class="fu">map</span>(fitted_model, performance<span class="sc">::</span>model_performance)) <span class="co">#global fit of models</span></span>
<span id="cb225-44"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-45"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-45" aria-hidden="true" tabindex="-1"></a><span class="do">#### Clean up stuff ####</span></span>
<span id="cb225-46"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-46" aria-hidden="true" tabindex="-1"></a>models_noCovs<span class="sc">$</span>tidy_parameters<span class="ot">=</span>models_noCovs<span class="sc">$</span>tidy_parameters <span class="sc">|&gt;</span> </span>
<span id="cb225-47"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(select,<span class="sc">-</span><span class="fu">c</span>(std.lv<span class="sc">:</span>std.nox, op)) <span class="sc">|&gt;</span> <span class="co"># remove extra columns</span></span>
<span id="cb225-48"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(mutate, <span class="at">estimate=</span><span class="fu">round</span>(estimate, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> <span class="co"># round numbers</span></span>
<span id="cb225-49"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(mutate, (<span class="fu">across</span>(<span class="fu">c</span>(std.error<span class="sc">:</span>p.value, conf.low, conf.high), round, <span class="dv">3</span>)))</span>
<span id="cb225-50"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-51"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-51" aria-hidden="true" tabindex="-1"></a>models_noCovs<span class="sc">$</span>global_fit<span class="ot">=</span>models_noCovs<span class="sc">$</span>global_fit <span class="sc">|&gt;</span> </span>
<span id="cb225-52"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb225-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(select, <span class="fu">c</span>(Chi2<span class="sc">:</span>p_Chi2, RMSEA<span class="sc">:</span>SRMR, CFI, AIC))</span></code></pre></div>
<p>Note how the functions inside <code>map</code> take on a slightly different form, but work the same.</p>
<p>Using this framework, you can easily drill down into any column and be sure that you’re accessing the right thing. Everything is always kept together, and always acted upon in the same way. This minimizes mistakes.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="intermediate-r-functions-loops-and-iterative-programming.html#cb226-1" aria-hidden="true" tabindex="-1"></a>models_noCovs<span class="sc">$</span>tidy_parameters<span class="sc">$</span>latent_Basis_model</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="misc.-stuff.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro-to-r-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ryan-a-schneider/coding_compendium/edit/master/10-functions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ryan-a-schneider/coding_compendium/blob/master/10-functions.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
